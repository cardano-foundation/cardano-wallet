<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Cardano.Wallet.Primitive.Model</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="src/Cardano.Wallet.Primitive.Model.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">cardano-wallet-core-2019.7.24: The Wallet Backend for a Cardano node.</p></div><div id="content"><div id="module-header"><table class="info"><tr><th valign="top">Copyright</th><td>&#169; 2018-2019 IOHK</td></tr><tr><th>License</th><td>Apache-2.0</td></tr><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Cardano.Wallet.Primitive.Model</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">Type</a></li><li><a href="#g:2">Construction &amp; Modification</a></li><li><a href="#g:3">Accessors</a></li></ul></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Here we find the &quot;business logic&quot; to manage a Cardano wallet. This is a
 direct implementation of the model from the <a href="https://github.com/input-output-hk/cardano-wallet/blob/master/specifications/wallet/formal-specification-for-a-cardano-wallet.pdf">Formal Specification for a Cardano Wallet</a>
 Note that, this module is purposedly agnostic to how blocks are retrieved or
 how various types are serialized.</p><p>This is really about how the wallet keep track of its internal state, and its
 UTxO (where the relationship is defined via the <code><a href="Cardano-Wallet-Primitive-AddressDiscovery.html#t:IsOurs" title="Cardano.Wallet.Primitive.AddressDiscovery">IsOurs</a></code> abstraction to allow
 this core code to be used with any sort of derivation scheme).</p><p>All those functions are pure and there's no reason to shove in any sort of
 side-effects in here :)</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><span class="keyword">data</span> <a href="#t:Wallet">Wallet</a> s t</li><li class="src short"><a href="#v:initWallet">initWallet</a> :: <span class="keyword">forall</span> s t. (<a href="Cardano-Wallet-Primitive-AddressDiscovery.html#t:IsOurs" title="Cardano.Wallet.Primitive.AddressDiscovery">IsOurs</a> s, <a href="../deepseq-1.4.4.0/Control-DeepSeq.html#t:NFData" title="Control.DeepSeq">NFData</a> s, <a href="../base-4.12.0.0/Text-Show.html#t:Show" title="Text.Show">Show</a> s, <a href="Cardano-Wallet-Primitive-Types.html#t:DefineTx" title="Cardano.Wallet.Primitive.Types">DefineTx</a> t) =&gt; <a href="Cardano-Wallet-Primitive-Types.html#t:Block" title="Cardano.Wallet.Primitive.Types">Block</a> (<a href="Cardano-Wallet-Primitive-Types.html#t:Tx" title="Cardano.Wallet.Primitive.Types">Tx</a> t) -&gt; s -&gt; <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s t</li><li class="src short"><a href="#v:updateState">updateState</a> :: (<a href="Cardano-Wallet-Primitive-AddressDiscovery.html#t:IsOurs" title="Cardano.Wallet.Primitive.AddressDiscovery">IsOurs</a> s, <a href="../deepseq-1.4.4.0/Control-DeepSeq.html#t:NFData" title="Control.DeepSeq">NFData</a> s, <a href="../base-4.12.0.0/Text-Show.html#t:Show" title="Text.Show">Show</a> s) =&gt; s -&gt; <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s t -&gt; <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s t</li><li class="src short"><a href="#v:applyBlock">applyBlock</a> :: <span class="keyword">forall</span> s t. <a href="Cardano-Wallet-Primitive-Types.html#t:DefineTx" title="Cardano.Wallet.Primitive.Types">DefineTx</a> t =&gt; <a href="Cardano-Wallet-Primitive-Types.html#t:Block" title="Cardano.Wallet.Primitive.Types">Block</a> (<a href="Cardano-Wallet-Primitive-Types.html#t:Tx" title="Cardano.Wallet.Primitive.Types">Tx</a> t) -&gt; <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s t -&gt; (<a href="../containers-0.6.0.1/Data-Map-Strict.html#t:Map" title="Data.Map.Strict">Map</a> (<a href="Cardano-Wallet-Primitive-Types.html#t:Hash" title="Cardano.Wallet.Primitive.Types">Hash</a> &quot;Tx&quot;) (<a href="Cardano-Wallet-Primitive-Types.html#t:Tx" title="Cardano.Wallet.Primitive.Types">Tx</a> t, <a href="Cardano-Wallet-Primitive-Types.html#t:TxMeta" title="Cardano.Wallet.Primitive.Types">TxMeta</a>), <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s t)</li><li class="src short"><a href="#v:applyBlocks">applyBlocks</a> :: <span class="keyword">forall</span> s t. <a href="Cardano-Wallet-Primitive-Types.html#t:DefineTx" title="Cardano.Wallet.Primitive.Types">DefineTx</a> t =&gt; <a href="../base-4.12.0.0/Data-List-NonEmpty.html#t:NonEmpty" title="Data.List.NonEmpty">NonEmpty</a> (<a href="Cardano-Wallet-Primitive-Types.html#t:Block" title="Cardano.Wallet.Primitive.Types">Block</a> (<a href="Cardano-Wallet-Primitive-Types.html#t:Tx" title="Cardano.Wallet.Primitive.Types">Tx</a> t)) -&gt; <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s t -&gt; <a href="../base-4.12.0.0/Data-List-NonEmpty.html#t:NonEmpty" title="Data.List.NonEmpty">NonEmpty</a> (<a href="../containers-0.6.0.1/Data-Map-Strict.html#t:Map" title="Data.Map.Strict">Map</a> (<a href="Cardano-Wallet-Primitive-Types.html#t:Hash" title="Cardano.Wallet.Primitive.Types">Hash</a> &quot;Tx&quot;) (<a href="Cardano-Wallet-Primitive-Types.html#t:Tx" title="Cardano.Wallet.Primitive.Types">Tx</a> t, <a href="Cardano-Wallet-Primitive-Types.html#t:TxMeta" title="Cardano.Wallet.Primitive.Types">TxMeta</a>), <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s t)</li><li class="src short"><a href="#v:newPending">newPending</a> :: (<a href="Cardano-Wallet-Primitive-Types.html#t:Tx" title="Cardano.Wallet.Primitive.Types">Tx</a> t, <a href="Cardano-Wallet-Primitive-Types.html#t:TxMeta" title="Cardano.Wallet.Primitive.Types">TxMeta</a>) -&gt; <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s t -&gt; <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s t</li><li class="src short"><a href="#v:unsafeInitWallet">unsafeInitWallet</a> :: (<a href="Cardano-Wallet-Primitive-AddressDiscovery.html#t:IsOurs" title="Cardano.Wallet.Primitive.AddressDiscovery">IsOurs</a> s, <a href="../deepseq-1.4.4.0/Control-DeepSeq.html#t:NFData" title="Control.DeepSeq">NFData</a> s, <a href="../base-4.12.0.0/Text-Show.html#t:Show" title="Text.Show">Show</a> s, <a href="Cardano-Wallet-Primitive-Types.html#t:DefineTx" title="Cardano.Wallet.Primitive.Types">DefineTx</a> t) =&gt; <a href="Cardano-Wallet-Primitive-Types.html#t:UTxO" title="Cardano.Wallet.Primitive.Types">UTxO</a> -&gt; <a href="../containers-0.6.0.1/Data-Set.html#t:Set" title="Data.Set">Set</a> (<a href="Cardano-Wallet-Primitive-Types.html#t:Tx" title="Cardano.Wallet.Primitive.Types">Tx</a> t, <a href="Cardano-Wallet-Primitive-Types.html#t:TxMeta" title="Cardano.Wallet.Primitive.Types">TxMeta</a>) -&gt; <a href="Cardano-Wallet-Primitive-Types.html#t:BlockHeader" title="Cardano.Wallet.Primitive.Types">BlockHeader</a> -&gt; s -&gt; <a href="Data-Quantity.html#t:Quantity" title="Data.Quantity">Quantity</a> &quot;block&quot; <a href="../base-4.12.0.0/GHC-Natural.html#t:Natural" title="GHC.Natural">Natural</a> -&gt; <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s t</li><li class="src short"><a href="#v:currentTip">currentTip</a> :: <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s t -&gt; <a href="Cardano-Wallet-Primitive-Types.html#t:BlockHeader" title="Cardano.Wallet.Primitive.Types">BlockHeader</a></li><li class="src short"><a href="#v:getState">getState</a> :: <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s t -&gt; s</li><li class="src short"><a href="#v:availableBalance">availableBalance</a> :: <a href="Cardano-Wallet-Primitive-Types.html#t:DefineTx" title="Cardano.Wallet.Primitive.Types">DefineTx</a> t =&gt; <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s t -&gt; <a href="../base-4.12.0.0/GHC-Natural.html#t:Natural" title="GHC.Natural">Natural</a></li><li class="src short"><a href="#v:totalBalance">totalBalance</a> :: <a href="Cardano-Wallet-Primitive-Types.html#t:DefineTx" title="Cardano.Wallet.Primitive.Types">DefineTx</a> t =&gt; <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s t -&gt; <a href="../base-4.12.0.0/GHC-Natural.html#t:Natural" title="GHC.Natural">Natural</a></li><li class="src short"><a href="#v:totalUTxO">totalUTxO</a> :: <span class="keyword">forall</span> s t. <a href="Cardano-Wallet-Primitive-Types.html#t:DefineTx" title="Cardano.Wallet.Primitive.Types">DefineTx</a> t =&gt; <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s t -&gt; <a href="Cardano-Wallet-Primitive-Types.html#t:UTxO" title="Cardano.Wallet.Primitive.Types">UTxO</a></li><li class="src short"><a href="#v:availableUTxO">availableUTxO</a> :: <span class="keyword">forall</span> s t. <a href="Cardano-Wallet-Primitive-Types.html#t:DefineTx" title="Cardano.Wallet.Primitive.Types">DefineTx</a> t =&gt; <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s t -&gt; <a href="Cardano-Wallet-Primitive-Types.html#t:UTxO" title="Cardano.Wallet.Primitive.Types">UTxO</a></li><li class="src short"><a href="#v:utxo">utxo</a> :: <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s t -&gt; <a href="Cardano-Wallet-Primitive-Types.html#t:UTxO" title="Cardano.Wallet.Primitive.Types">UTxO</a></li><li class="src short"><a href="#v:getPending">getPending</a> :: <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s t -&gt; <a href="../containers-0.6.0.1/Data-Set.html#t:Set" title="Data.Set">Set</a> (<a href="Cardano-Wallet-Primitive-Types.html#t:Tx" title="Cardano.Wallet.Primitive.Types">Tx</a> t, <a href="Cardano-Wallet-Primitive-Types.html#t:TxMeta" title="Cardano.Wallet.Primitive.Types">TxMeta</a>)</li><li class="src short"><a href="#v:blockHeight">blockHeight</a> :: <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s t -&gt; <a href="Data-Quantity.html#t:Quantity" title="Data.Quantity">Quantity</a> &quot;block&quot; <a href="../base-4.12.0.0/GHC-Natural.html#t:Natural" title="GHC.Natural">Natural</a></li></ul></details></div><div id="interface"><a href="#g:1" id="g:1"><h1>Type</h1></a><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:Wallet" class="def">Wallet</a> s t <a href="src/Cardano.Wallet.Primitive.Model.html#Wallet" class="link">Source</a> <a href="#t:Wallet" class="selflink">#</a></p><div class="doc"><p>An opaque wallet type, see <code><a href="Cardano-Wallet-Primitive-Model.html#v:initWallet" title="Cardano.Wallet.Primitive.Model">initWallet</a></code> and <code><a href="Cardano-Wallet-Primitive-Model.html#v:applyBlocks" title="Cardano.Wallet.Primitive.Model">applyBlocks</a></code> to construct and
 update wallets.</p><p>Internally, this keeps track or a few things including:</p><ul><li>UTxOs</li><li>Pending transaction</li><li>Transaction history</li><li>TODO: Known &amp; used addresses</li></ul><p>The <code><a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a></code> is paremeterized over two types:</p><ul><li><code>s</code>: A _state_ used to keep track of known addresses. The business logic
   doesn't know how to answer the question 'Is this address ours?', so we
   expect this state to be able to answer that for us.</li><li><code>t</code>: A target backend. This makes the wallet fairly agnostic to the type
   of binary representation used by the underlying target network and it
   allows us to re-use the same logic to provide a wallet backend for multiple
   backends (for instance, Byron or Shelley) which may have divergence in
   their binary formats. For the sake of this module, we only care about one
   particular super-power, and its the ability to compute transaction id
   (which is intrinsically linked to the transaction's binary format).</li></ul><p>A few examples to make it concrete:</p><pre>Wallet RndState Byron
Wallet SeqState Shelley
Wallet SeqState Bitcoin
</pre></div><div class="subs instances"><details id="i:Wallet" open="open"><summary>Instances</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Wallet:Eq:1"></span> <a href="../base-4.12.0.0/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> s =&gt; <a href="../base-4.12.0.0/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> (<a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s t)</span> <a href="src/Cardano.Wallet.Primitive.Model.html#line-149" class="link">Source</a> <a href="#t:Wallet" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Wallet:Eq:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Cardano-Wallet-Primitive-Model.html">Cardano.Wallet.Primitive.Model</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s t -&gt; <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s t -&gt; <a href="../base-4.12.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-61--61-" class="selflink">#</a></p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s t -&gt; <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s t -&gt; <a href="../base-4.12.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-47--61-" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Wallet:Show:2"></span> <a href="../base-4.12.0.0/Text-Show.html#t:Show" title="Text.Show">Show</a> (<a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s t)</span> <a href="src/Cardano.Wallet.Primitive.Model.html#line-148" class="link">Source</a> <a href="#t:Wallet" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Wallet:Show:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Cardano-Wallet-Primitive-Model.html">Cardano.Wallet.Primitive.Model</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../base-4.12.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s t -&gt; <a href="../base-4.12.0.0/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s t -&gt; <a href="../base-4.12.0.0/Data-String.html#t:String" title="Data.String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s t] -&gt; <a href="../base-4.12.0.0/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Wallet:NFData:3"></span> <a href="../deepseq-1.4.4.0/Control-DeepSeq.html#t:NFData" title="Control.DeepSeq">NFData</a> (<a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s t)</span> <a href="src/Cardano.Wallet.Primitive.Model.html#line-150" class="link">Source</a> <a href="#t:Wallet" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Wallet:NFData:3"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Cardano-Wallet-Primitive-Model.html">Cardano.Wallet.Primitive.Model</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:rnf">rnf</a> :: <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s t -&gt; () <a href="#v:rnf" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><a href="#g:2" id="g:2"><h1>Construction &amp; Modification</h1></a><div class="top"><p class="src"><a id="v:initWallet" class="def">initWallet</a> <a href="src/Cardano.Wallet.Primitive.Model.html#initWallet" class="link">Source</a> <a href="#v:initWallet" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: (<a href="Cardano-Wallet-Primitive-AddressDiscovery.html#t:IsOurs" title="Cardano.Wallet.Primitive.AddressDiscovery">IsOurs</a> s, <a href="../deepseq-1.4.4.0/Control-DeepSeq.html#t:NFData" title="Control.DeepSeq">NFData</a> s, <a href="../base-4.12.0.0/Text-Show.html#t:Show" title="Text.Show">Show</a> s, <a href="Cardano-Wallet-Primitive-Types.html#t:DefineTx" title="Cardano.Wallet.Primitive.Types">DefineTx</a> t)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; <a href="Cardano-Wallet-Primitive-Types.html#t:Block" title="Cardano.Wallet.Primitive.Types">Block</a> (<a href="Cardano-Wallet-Primitive-Types.html#t:Tx" title="Cardano.Wallet.Primitive.Types">Tx</a> t)</td><td class="doc"><p>The genesis block</p></td></tr><tr><td class="src">-&gt; s</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s t</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Create a an empty wallet and apply the given genesis block</p><p>The wallet tip will be set to the header of the applied genesis block.</p></div></div><div class="top"><p class="src"><a id="v:updateState" class="def">updateState</a> :: (<a href="Cardano-Wallet-Primitive-AddressDiscovery.html#t:IsOurs" title="Cardano.Wallet.Primitive.AddressDiscovery">IsOurs</a> s, <a href="../deepseq-1.4.4.0/Control-DeepSeq.html#t:NFData" title="Control.DeepSeq">NFData</a> s, <a href="../base-4.12.0.0/Text-Show.html#t:Show" title="Text.Show">Show</a> s) =&gt; s -&gt; <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s t -&gt; <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s t <a href="src/Cardano.Wallet.Primitive.Model.html#updateState" class="link">Source</a> <a href="#v:updateState" class="selflink">#</a></p><div class="doc"><p>Update the state of an existing Wallet model</p></div></div><div class="top"><p class="src"><a id="v:applyBlock" class="def">applyBlock</a> :: <span class="keyword">forall</span> s t. <a href="Cardano-Wallet-Primitive-Types.html#t:DefineTx" title="Cardano.Wallet.Primitive.Types">DefineTx</a> t =&gt; <a href="Cardano-Wallet-Primitive-Types.html#t:Block" title="Cardano.Wallet.Primitive.Types">Block</a> (<a href="Cardano-Wallet-Primitive-Types.html#t:Tx" title="Cardano.Wallet.Primitive.Types">Tx</a> t) -&gt; <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s t -&gt; (<a href="../containers-0.6.0.1/Data-Map-Strict.html#t:Map" title="Data.Map.Strict">Map</a> (<a href="Cardano-Wallet-Primitive-Types.html#t:Hash" title="Cardano.Wallet.Primitive.Types">Hash</a> &quot;Tx&quot;) (<a href="Cardano-Wallet-Primitive-Types.html#t:Tx" title="Cardano.Wallet.Primitive.Types">Tx</a> t, <a href="Cardano-Wallet-Primitive-Types.html#t:TxMeta" title="Cardano.Wallet.Primitive.Types">TxMeta</a>), <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s t) <a href="src/Cardano.Wallet.Primitive.Model.html#applyBlock" class="link">Source</a> <a href="#v:applyBlock" class="selflink">#</a></p><div class="doc"><p>Apply Block is the only way to make the wallet evolve. It returns a new
 updated wallet state, as well as the set of all our transaction discovered
 while applying the block.</p></div></div><div class="top"><p class="src"><a id="v:applyBlocks" class="def">applyBlocks</a> :: <span class="keyword">forall</span> s t. <a href="Cardano-Wallet-Primitive-Types.html#t:DefineTx" title="Cardano.Wallet.Primitive.Types">DefineTx</a> t =&gt; <a href="../base-4.12.0.0/Data-List-NonEmpty.html#t:NonEmpty" title="Data.List.NonEmpty">NonEmpty</a> (<a href="Cardano-Wallet-Primitive-Types.html#t:Block" title="Cardano.Wallet.Primitive.Types">Block</a> (<a href="Cardano-Wallet-Primitive-Types.html#t:Tx" title="Cardano.Wallet.Primitive.Types">Tx</a> t)) -&gt; <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s t -&gt; <a href="../base-4.12.0.0/Data-List-NonEmpty.html#t:NonEmpty" title="Data.List.NonEmpty">NonEmpty</a> (<a href="../containers-0.6.0.1/Data-Map-Strict.html#t:Map" title="Data.Map.Strict">Map</a> (<a href="Cardano-Wallet-Primitive-Types.html#t:Hash" title="Cardano.Wallet.Primitive.Types">Hash</a> &quot;Tx&quot;) (<a href="Cardano-Wallet-Primitive-Types.html#t:Tx" title="Cardano.Wallet.Primitive.Types">Tx</a> t, <a href="Cardano-Wallet-Primitive-Types.html#t:TxMeta" title="Cardano.Wallet.Primitive.Types">TxMeta</a>), <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s t) <a href="src/Cardano.Wallet.Primitive.Model.html#applyBlocks" class="link">Source</a> <a href="#v:applyBlocks" class="selflink">#</a></p><div class="doc"><p>Apply multiple blocks in sequence to an existing wallet, returning a list
   of intermediate wallet states.</p><p>Each intermediate wallet state is paired with the set of transactions that
 belong to that state but not the previous state.</p><p>For an original wallet state <strong><code>w</code></strong> and a list of blocks <strong><code>b</code></strong> such that:</p><pre>b = [b1, b2, ..., bn]</pre><p>Returns the following list of updates:</p><pre>[ (t b1, w + b1)
, (t b2, w + b1 + b2)
, ...
, (t bn, w + b1 + b2 + ... + bn) ]</pre><p>Where:</p><ul><li><strong><code>(t bi)</code></strong>   is the set of transactions contained within block <strong><code>bi</code></strong>.</li><li><strong><code>(w + bi)</code></strong> is the wallet state after applying block <strong><code>bi</code></strong> to wallet
   <strong><code>w</code></strong>.</li></ul></div></div><div class="top"><p class="src"><a id="v:newPending" class="def">newPending</a> :: (<a href="Cardano-Wallet-Primitive-Types.html#t:Tx" title="Cardano.Wallet.Primitive.Types">Tx</a> t, <a href="Cardano-Wallet-Primitive-Types.html#t:TxMeta" title="Cardano.Wallet.Primitive.Types">TxMeta</a>) -&gt; <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s t -&gt; <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s t <a href="src/Cardano.Wallet.Primitive.Model.html#newPending" class="link">Source</a> <a href="#v:newPending" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:unsafeInitWallet" class="def">unsafeInitWallet</a> <a href="src/Cardano.Wallet.Primitive.Model.html#unsafeInitWallet" class="link">Source</a> <a href="#v:unsafeInitWallet" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: (<a href="Cardano-Wallet-Primitive-AddressDiscovery.html#t:IsOurs" title="Cardano.Wallet.Primitive.AddressDiscovery">IsOurs</a> s, <a href="../deepseq-1.4.4.0/Control-DeepSeq.html#t:NFData" title="Control.DeepSeq">NFData</a> s, <a href="../base-4.12.0.0/Text-Show.html#t:Show" title="Text.Show">Show</a> s, <a href="Cardano-Wallet-Primitive-Types.html#t:DefineTx" title="Cardano.Wallet.Primitive.Types">DefineTx</a> t)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; <a href="Cardano-Wallet-Primitive-Types.html#t:UTxO" title="Cardano.Wallet.Primitive.Types">UTxO</a></td><td class="doc"><p>Unspent tx outputs belonging to this wallet</p></td></tr><tr><td class="src">-&gt; <a href="../containers-0.6.0.1/Data-Set.html#t:Set" title="Data.Set">Set</a> (<a href="Cardano-Wallet-Primitive-Types.html#t:Tx" title="Cardano.Wallet.Primitive.Types">Tx</a> t, <a href="Cardano-Wallet-Primitive-Types.html#t:TxMeta" title="Cardano.Wallet.Primitive.Types">TxMeta</a>)</td><td class="doc"><p>Pending outgoing transactions</p></td></tr><tr><td class="src">-&gt; <a href="Cardano-Wallet-Primitive-Types.html#t:BlockHeader" title="Cardano.Wallet.Primitive.Types">BlockHeader</a></td><td class="doc"><p>Header of the latest applied block (current tip)</p></td></tr><tr><td class="src">-&gt; s</td><td class="doc"><p>Address discovery state</p></td></tr><tr><td class="src">-&gt; <a href="Data-Quantity.html#t:Quantity" title="Data.Quantity">Quantity</a> &quot;block&quot; <a href="../base-4.12.0.0/GHC-Natural.html#t:Natural" title="GHC.Natural">Natural</a></td><td class="doc"><p>Block height</p></td></tr><tr><td class="src">-&gt; <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s t</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Constructs a wallet from the exact given state. Using this function instead
 of <code><a href="Cardano-Wallet-Primitive-Model.html#v:initWallet" title="Cardano.Wallet.Primitive.Model">initWallet</a></code> and <code><a href="Cardano-Wallet-Primitive-Model.html#v:applyBlock" title="Cardano.Wallet.Primitive.Model">applyBlock</a></code> allows the wallet invariants to be
 broken. Therefore it should only be used in the special case of loading
 wallet checkpoints from the database (where it is assumed a valid wallet was
 stored into the database).</p></div></div><a href="#g:3" id="g:3"><h1>Accessors</h1></a><div class="top"><p class="src"><a id="v:currentTip" class="def">currentTip</a> :: <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s t -&gt; <a href="Cardano-Wallet-Primitive-Types.html#t:BlockHeader" title="Cardano.Wallet.Primitive.Types">BlockHeader</a> <a href="src/Cardano.Wallet.Primitive.Model.html#currentTip" class="link">Source</a> <a href="#v:currentTip" class="selflink">#</a></p><div class="doc"><p>Get the wallet current tip</p></div></div><div class="top"><p class="src"><a id="v:getState" class="def">getState</a> :: <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s t -&gt; s <a href="src/Cardano.Wallet.Primitive.Model.html#getState" class="link">Source</a> <a href="#v:getState" class="selflink">#</a></p><div class="doc"><p>Get the wallet current state</p></div></div><div class="top"><p class="src"><a id="v:availableBalance" class="def">availableBalance</a> :: <a href="Cardano-Wallet-Primitive-Types.html#t:DefineTx" title="Cardano.Wallet.Primitive.Types">DefineTx</a> t =&gt; <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s t -&gt; <a href="../base-4.12.0.0/GHC-Natural.html#t:Natural" title="GHC.Natural">Natural</a> <a href="src/Cardano.Wallet.Primitive.Model.html#availableBalance" class="link">Source</a> <a href="#v:availableBalance" class="selflink">#</a></p><div class="doc"><p>Available balance = <code><a href="Cardano-Wallet-Primitive-Types.html#v:balance" title="Cardano.Wallet.Primitive.Types">balance</a></code> . <code><a href="Cardano-Wallet-Primitive-Model.html#v:availableUTxO" title="Cardano.Wallet.Primitive.Model">availableUTxO</a></code></p></div></div><div class="top"><p class="src"><a id="v:totalBalance" class="def">totalBalance</a> :: <a href="Cardano-Wallet-Primitive-Types.html#t:DefineTx" title="Cardano.Wallet.Primitive.Types">DefineTx</a> t =&gt; <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s t -&gt; <a href="../base-4.12.0.0/GHC-Natural.html#t:Natural" title="GHC.Natural">Natural</a> <a href="src/Cardano.Wallet.Primitive.Model.html#totalBalance" class="link">Source</a> <a href="#v:totalBalance" class="selflink">#</a></p><div class="doc"><p>Total balance = <code><a href="Cardano-Wallet-Primitive-Types.html#v:balance" title="Cardano.Wallet.Primitive.Types">balance</a></code> . <code><a href="Cardano-Wallet-Primitive-Model.html#v:totalUTxO" title="Cardano.Wallet.Primitive.Model">totalUTxO</a></code></p></div></div><div class="top"><p class="src"><a id="v:totalUTxO" class="def">totalUTxO</a> :: <span class="keyword">forall</span> s t. <a href="Cardano-Wallet-Primitive-Types.html#t:DefineTx" title="Cardano.Wallet.Primitive.Types">DefineTx</a> t =&gt; <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s t -&gt; <a href="Cardano-Wallet-Primitive-Types.html#t:UTxO" title="Cardano.Wallet.Primitive.Types">UTxO</a> <a href="src/Cardano.Wallet.Primitive.Model.html#totalUTxO" class="link">Source</a> <a href="#v:totalUTxO" class="selflink">#</a></p><div class="doc"><p>Total UTxO = <code><a href="Cardano-Wallet-Primitive-Model.html#v:availableUTxO" title="Cardano.Wallet.Primitive.Model">availableUTxO</a></code> <code>&lt;&gt;</code> <code>changeUTxO</code></p></div></div><div class="top"><p class="src"><a id="v:availableUTxO" class="def">availableUTxO</a> :: <span class="keyword">forall</span> s t. <a href="Cardano-Wallet-Primitive-Types.html#t:DefineTx" title="Cardano.Wallet.Primitive.Types">DefineTx</a> t =&gt; <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s t -&gt; <a href="Cardano-Wallet-Primitive-Types.html#t:UTxO" title="Cardano.Wallet.Primitive.Types">UTxO</a> <a href="src/Cardano.Wallet.Primitive.Model.html#availableUTxO" class="link">Source</a> <a href="#v:availableUTxO" class="selflink">#</a></p><div class="doc"><p>Available UTxO = <code>pending &#8938; utxo</code></p></div></div><div class="top"><p class="src"><a id="v:utxo" class="def">utxo</a> :: <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s t -&gt; <a href="Cardano-Wallet-Primitive-Types.html#t:UTxO" title="Cardano.Wallet.Primitive.Types">UTxO</a> <a href="src/Cardano.Wallet.Primitive.Model.html#utxo" class="link">Source</a> <a href="#v:utxo" class="selflink">#</a></p><div class="doc"><p>Actual utxo</p></div></div><div class="top"><p class="src"><a id="v:getPending" class="def">getPending</a> :: <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s t -&gt; <a href="../containers-0.6.0.1/Data-Set.html#t:Set" title="Data.Set">Set</a> (<a href="Cardano-Wallet-Primitive-Types.html#t:Tx" title="Cardano.Wallet.Primitive.Types">Tx</a> t, <a href="Cardano-Wallet-Primitive-Types.html#t:TxMeta" title="Cardano.Wallet.Primitive.Types">TxMeta</a>) <a href="src/Cardano.Wallet.Primitive.Model.html#getPending" class="link">Source</a> <a href="#v:getPending" class="selflink">#</a></p><div class="doc"><p>Get the set of pending transactions</p></div></div><div class="top"><p class="src"><a id="v:blockHeight" class="def">blockHeight</a> :: <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s t -&gt; <a href="Data-Quantity.html#t:Quantity" title="Data.Quantity">Quantity</a> &quot;block&quot; <a href="../base-4.12.0.0/GHC-Natural.html#t:Natural" title="GHC.Natural">Natural</a> <a href="src/Cardano.Wallet.Primitive.Model.html#blockHeight" class="link">Source</a> <a href="#v:blockHeight" class="selflink">#</a></p><div class="doc"><p>Get the block height of the chain.</p><p>A new wallet from <code><a href="Cardano-Wallet-Primitive-Model.html#v:initWallet" title="Cardano.Wallet.Primitive.Model">initWallet</a></code> (which already has the genesis block applied)
 has a block height of 0.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.22.0</p></div></body></html>