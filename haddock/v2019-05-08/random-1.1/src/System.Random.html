<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 701
</span><span class="hs-pragma">{-# LANGUAGE Trustworthy #-}</span><span>
</span><a name="line-3"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-5"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-6"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-7"></a><span class="hs-comment">-- Module      :  System.Random</span><span>
</span><a name="line-8"></a><span class="hs-comment">-- Copyright   :  (c) The University of Glasgow 2001</span><span>
</span><a name="line-9"></a><span class="hs-comment">-- License     :  BSD-style (see the file LICENSE in the 'random' repository)</span><span>
</span><a name="line-10"></a><span class="hs-comment">-- </span><span>
</span><a name="line-11"></a><span class="hs-comment">-- Maintainer  :  libraries@haskell.org</span><span>
</span><a name="line-12"></a><span class="hs-comment">-- Stability   :  stable</span><span>
</span><a name="line-13"></a><span class="hs-comment">-- Portability :  portable</span><span>
</span><a name="line-14"></a><span class="hs-comment">--</span><span>
</span><a name="line-15"></a><span class="hs-comment">-- This library deals with the common task of pseudo-random number</span><span>
</span><a name="line-16"></a><span class="hs-comment">-- generation. The library makes it possible to generate repeatable</span><span>
</span><a name="line-17"></a><span class="hs-comment">-- results, by starting with a specified initial random number generator,</span><span>
</span><a name="line-18"></a><span class="hs-comment">-- or to get different results on each run by using the system-initialised</span><span>
</span><a name="line-19"></a><span class="hs-comment">-- generator or by supplying a seed from some other source.</span><span>
</span><a name="line-20"></a><span class="hs-comment">--</span><span>
</span><a name="line-21"></a><span class="hs-comment">-- The library is split into two layers: </span><span>
</span><a name="line-22"></a><span class="hs-comment">--</span><span>
</span><a name="line-23"></a><span class="hs-comment">-- * A core /random number generator/ provides a supply of bits.</span><span>
</span><a name="line-24"></a><span class="hs-comment">--   The class 'RandomGen' provides a common interface to such generators.</span><span>
</span><a name="line-25"></a><span class="hs-comment">--   The library provides one instance of 'RandomGen', the abstract</span><span>
</span><a name="line-26"></a><span class="hs-comment">--   data type 'StdGen'.  Programmers may, of course, supply their own</span><span>
</span><a name="line-27"></a><span class="hs-comment">--   instances of 'RandomGen'.</span><span>
</span><a name="line-28"></a><span class="hs-comment">--</span><span>
</span><a name="line-29"></a><span class="hs-comment">-- * The class 'Random' provides a way to extract values of a particular</span><span>
</span><a name="line-30"></a><span class="hs-comment">--   type from a random number generator.  For example, the 'Float'</span><span>
</span><a name="line-31"></a><span class="hs-comment">--   instance of 'Random' allows one to generate random values of type</span><span>
</span><a name="line-32"></a><span class="hs-comment">--   'Float'.</span><span>
</span><a name="line-33"></a><span class="hs-comment">--</span><span>
</span><a name="line-34"></a><span class="hs-comment">-- This implementation uses the Portable Combined Generator of L'Ecuyer</span><span>
</span><a name="line-35"></a><span class="hs-comment">-- [&quot;System.Random\#LEcuyer&quot;] for 32-bit computers, transliterated by</span><span>
</span><a name="line-36"></a><span class="hs-comment">-- Lennart Augustsson.  It has a period of roughly 2.30584e18.</span><span>
</span><a name="line-37"></a><span class="hs-comment">--</span><span>
</span><a name="line-38"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-39"></a><span>
</span><a name="line-40"></a><span class="hs-cpp">#include &quot;MachDeps.h&quot;
</span><span>
</span><a name="line-42"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">System.Random</span><span>
</span><a name="line-43"></a><span>        </span><span class="hs-special">(</span><span>
</span><a name="line-44"></a><span>
</span><a name="line-45"></a><span>        </span><span class="hs-comment">-- $intro</span><span>
</span><a name="line-46"></a><span>
</span><a name="line-47"></a><span>        </span><span class="hs-comment">-- * Random number generators</span><span>
</span><a name="line-48"></a><span>
</span><a name="line-49"></a><span class="hs-cpp">#ifdef ENABLE_SPLITTABLEGEN
</span><span>          </span><span class="hs-identifier">RandomGen</span><span class="hs-special">(</span><span class="hs-identifier">next</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">genRange</span><span class="hs-special">)</span><span>
</span><a name="line-51"></a><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">SplittableGen</span><span class="hs-special">(</span><span class="hs-identifier">split</span><span class="hs-special">)</span><span>
</span><a name="line-52"></a><span class="hs-cpp">#else
</span><span>          </span><a href="System.Random.html#RandomGen"><span class="hs-identifier hs-type">RandomGen</span></a><span class="hs-special">(</span><a href="System.Random.html#next"><span class="hs-identifier hs-var">next</span></a><span class="hs-special">,</span><span> </span><a href="System.Random.html#genRange"><span class="hs-identifier hs-var">genRange</span></a><span class="hs-special">,</span><span> </span><a href="System.Random.html#split"><span class="hs-identifier hs-var">split</span></a><span class="hs-special">)</span><span>
</span><a name="line-54"></a><span class="hs-cpp">#endif
</span><span>        </span><span class="hs-comment">-- ** Standard random number generators</span><span>
</span><a name="line-56"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="System.Random.html#StdGen"><span class="hs-identifier hs-type">StdGen</span></a><span>
</span><a name="line-57"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="System.Random.html#mkStdGen"><span class="hs-identifier hs-var">mkStdGen</span></a><span>
</span><a name="line-58"></a><span>
</span><a name="line-59"></a><span>        </span><span class="hs-comment">-- ** The global random number generator</span><span>
</span><a name="line-60"></a><span>
</span><a name="line-61"></a><span>        </span><span class="hs-comment">-- $globalrng</span><span>
</span><a name="line-62"></a><span>
</span><a name="line-63"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="System.Random.html#getStdRandom"><span class="hs-identifier hs-var">getStdRandom</span></a><span>
</span><a name="line-64"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="System.Random.html#getStdGen"><span class="hs-identifier hs-var">getStdGen</span></a><span>
</span><a name="line-65"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="System.Random.html#setStdGen"><span class="hs-identifier hs-var">setStdGen</span></a><span>
</span><a name="line-66"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="System.Random.html#newStdGen"><span class="hs-identifier hs-var">newStdGen</span></a><span>
</span><a name="line-67"></a><span>
</span><a name="line-68"></a><span>        </span><span class="hs-comment">-- * Random values of various types</span><span>
</span><a name="line-69"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="System.Random.html#Random"><span class="hs-identifier hs-type">Random</span></a><span> </span><span class="hs-special">(</span><span> </span><a href="System.Random.html#random"><span class="hs-identifier hs-var">random</span></a><span class="hs-special">,</span><span>   </span><a href="System.Random.html#randomR"><span class="hs-identifier hs-var">randomR</span></a><span class="hs-special">,</span><span>
</span><a name="line-70"></a><span>                   </span><a href="System.Random.html#randoms"><span class="hs-identifier hs-var">randoms</span></a><span class="hs-special">,</span><span>  </span><a href="System.Random.html#randomRs"><span class="hs-identifier hs-var">randomRs</span></a><span class="hs-special">,</span><span>
</span><a name="line-71"></a><span>                   </span><a href="System.Random.html#randomIO"><span class="hs-identifier hs-var">randomIO</span></a><span class="hs-special">,</span><span> </span><a href="System.Random.html#randomRIO"><span class="hs-identifier hs-var">randomRIO</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-72"></a><span>
</span><a name="line-73"></a><span>        </span><span class="hs-comment">-- * References</span><span>
</span><a name="line-74"></a><span>        </span><span class="hs-comment">-- $references</span><span>
</span><a name="line-75"></a><span>
</span><a name="line-76"></a><span>        </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-77"></a><span>
</span><a name="line-78"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Prelude</span><span>
</span><a name="line-79"></a><span>
</span><a name="line-80"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Bits</span><span>
</span><a name="line-81"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Int</span><span>
</span><a name="line-82"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Word</span><span>
</span><a name="line-83"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Foreign.C.Types</span><span>
</span><a name="line-84"></a><span>
</span><a name="line-85"></a><span class="hs-cpp">#ifdef __NHC__
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">CPUTime</span><span>          </span><span class="hs-special">(</span><span> </span><span class="hs-identifier">getCPUTime</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-87"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Foreign.Ptr</span><span>      </span><span class="hs-special">(</span><span> </span><span class="hs-identifier">Ptr</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">nullPtr</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-88"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Foreign.C</span><span>        </span><span class="hs-special">(</span><span> </span><span class="hs-identifier">CTime</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">CUInt</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-89"></a><span class="hs-cpp">#else
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">System.CPUTime</span><span>   </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">getCPUTime</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-91"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Time</span><span>        </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">getCurrentTime</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">UTCTime</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-92"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Ratio</span><span>       </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">numerator</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">denominator</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-93"></a><span class="hs-cpp">#endif
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Char</span><span>        </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">isSpace</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">chr</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">ord</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-95"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">System.IO.Unsafe</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">unsafePerformIO</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-96"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.IORef</span><span>       </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">IORef</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">newIORef</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">readIORef</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">writeIORef</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-97"></a><span class="hs-cpp">#if MIN_VERSION_base (4,6,0)
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.IORef</span><span>       </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">atomicModifyIORef'</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-99"></a><span class="hs-cpp">#else
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.IORef</span><span>       </span><span class="hs-special">(</span><span> </span><span class="hs-identifier">atomicModifyIORef</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-101"></a><span class="hs-cpp">#endif
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Numeric</span><span>          </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">readDec</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-103"></a><span>
</span><a name="line-104"></a><span class="hs-cpp">#ifdef __GLASGOW_HASKELL__
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GHC.Exts</span><span>         </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">build</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-106"></a><span class="hs-cpp">#else
</span><span class="hs-comment">-- | A dummy variant of build without fusion.</span><span>
</span><a name="line-108"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">build</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-109"></a><span class="hs-identifier">build</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span>
</span><a name="line-110"></a><span class="hs-identifier">build</span><span> </span><span class="hs-identifier">g</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">g</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-111"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-113"></a><span class="hs-cpp">#if !MIN_VERSION_base (4,6,0)
</span><span class="hs-identifier">atomicModifyIORef'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">IORef</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span class="hs-special">,</span><span class="hs-identifier">b</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-115"></a><span class="hs-identifier">atomicModifyIORef'</span><span> </span><span class="hs-identifier">ref</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-116"></a><span>    </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">atomicModifyIORef</span><span> </span><span class="hs-identifier">ref</span><span>
</span><a name="line-117"></a><span>            </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">x</span><span>
</span><a name="line-118"></a><span>                    </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">seq</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-119"></a><span>    </span><span class="hs-identifier">b</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">seq</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-120"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-122"></a><span class="hs-comment">-- The standard nhc98 implementation of Time.ClockTime does not match</span><span>
</span><a name="line-123"></a><span class="hs-comment">-- the extended one expected in this module, so we lash-up a quick</span><span>
</span><a name="line-124"></a><span class="hs-comment">-- replacement here.</span><span>
</span><a name="line-125"></a><span class="hs-cpp">#ifdef __NHC__
</span><span class="hs-identifier">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">ccall</span><span> </span><span class="hs-string">&quot;time.h time&quot;</span><span> </span><span class="hs-identifier">readtime</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Ptr</span><span> </span><span class="hs-identifier">CTime</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">CTime</span><span>
</span><a name="line-127"></a><span class="hs-identifier">getTime</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Integer</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Integer</span><span class="hs-special">)</span><span>
</span><a name="line-128"></a><span class="hs-identifier">getTime</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-identifier">CTime</span><span> </span><span class="hs-identifier">t</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">readtime</span><span> </span><span class="hs-identifier">nullPtr</span><span class="hs-special">;</span><span>  </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">toInteger</span><span> </span><span class="hs-identifier">t</span><span class="hs-special">,</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span>
</span><a name="line-129"></a><span class="hs-cpp">#else
</span><span class="hs-identifier">getTime</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Integer</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Integer</span><span class="hs-special">)</span><span>
</span><a name="line-131"></a><a name="getTime"><a href="System.Random.html#getTime"><span class="hs-identifier">getTime</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-132"></a><span>  </span><a name="local-6989586621679038263"><a href="#local-6989586621679038263"><span class="hs-identifier">utc</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getCurrentTime</span><span>
</span><a name="line-133"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679038264"><a href="#local-6989586621679038264"><span class="hs-identifier">daytime</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">toRational</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">utctDayTime</span><span> </span><a href="#local-6989586621679038263"><span class="hs-identifier hs-var">utc</span></a><span>
</span><a name="line-134"></a><span>  </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">quotRem</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">numerator</span><span> </span><a href="#local-6989586621679038264"><span class="hs-identifier hs-var">daytime</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">denominator</span><span> </span><a href="#local-6989586621679038264"><span class="hs-identifier hs-var">daytime</span></a><span class="hs-special">)</span><span>
</span><a name="line-135"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-137"></a><span class="hs-comment">-- | The class 'RandomGen' provides a common interface to random number</span><span>
</span><a name="line-138"></a><span class="hs-comment">-- generators.</span><span>
</span><a name="line-139"></a><span class="hs-comment">--</span><span>
</span><a name="line-140"></a><span class="hs-cpp">#ifdef ENABLE_SPLITTABLEGEN
</span><span class="hs-comment">-- Minimal complete definition: 'next'.</span><span>
</span><a name="line-142"></a><span class="hs-cpp">#else
</span><span class="hs-comment">-- Minimal complete definition: 'next' and 'split'.</span><span>
</span><a name="line-144"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-146"></a><span class="hs-keyword">class</span><span> </span><a name="RandomGen"><a href="System.Random.html#RandomGen"><span class="hs-identifier">RandomGen</span></a></a><span> </span><a name="local-6989586621679031614"><a href="#local-6989586621679031614"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-147"></a><span>
</span><a name="line-148"></a><span>   </span><span class="hs-comment">-- |The 'next' operation returns an 'Int' that is uniformly distributed</span><span>
</span><a name="line-149"></a><span>   </span><span class="hs-comment">-- in the range returned by 'genRange' (including both end points),</span><span>
</span><a name="line-150"></a><span>   </span><span class="hs-comment">-- and a new generator.</span><span>
</span><a name="line-151"></a><span>   </span><a name="next"><a href="System.Random.html#next"><span class="hs-identifier">next</span></a></a><span>     </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679031614"><span class="hs-identifier hs-type">g</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679031614"><span class="hs-identifier hs-type">g</span></a><span class="hs-special">)</span><span>
</span><a name="line-152"></a><span>
</span><a name="line-153"></a><span>   </span><span class="hs-comment">-- |The 'genRange' operation yields the range of values returned by</span><span>
</span><a name="line-154"></a><span>   </span><span class="hs-comment">-- the generator.</span><span>
</span><a name="line-155"></a><span>   </span><span class="hs-comment">--</span><span>
</span><a name="line-156"></a><span>   </span><span class="hs-comment">-- It is required that:</span><span>
</span><a name="line-157"></a><span>   </span><span class="hs-comment">--</span><span>
</span><a name="line-158"></a><span>   </span><span class="hs-comment">-- * If @(a,b) = 'genRange' g@, then @a &lt; b@.</span><span>
</span><a name="line-159"></a><span>   </span><span class="hs-comment">--</span><span>
</span><a name="line-160"></a><span>   </span><span class="hs-comment">-- * 'genRange' always returns a pair of defined 'Int's.</span><span>
</span><a name="line-161"></a><span>   </span><span class="hs-comment">--</span><span>
</span><a name="line-162"></a><span>   </span><span class="hs-comment">-- The second condition ensures that 'genRange' cannot examine its</span><span>
</span><a name="line-163"></a><span>   </span><span class="hs-comment">-- argument, and hence the value it returns can be determined only by the</span><span>
</span><a name="line-164"></a><span>   </span><span class="hs-comment">-- instance of 'RandomGen'.  That in turn allows an implementation to make</span><span>
</span><a name="line-165"></a><span>   </span><span class="hs-comment">-- a single call to 'genRange' to establish a generator's range, without</span><span>
</span><a name="line-166"></a><span>   </span><span class="hs-comment">-- being concerned that the generator returned by (say) 'next' might have</span><span>
</span><a name="line-167"></a><span>   </span><span class="hs-comment">-- a different range to the generator passed to 'next'.</span><span>
</span><a name="line-168"></a><span>   </span><span class="hs-comment">--</span><span>
</span><a name="line-169"></a><span>   </span><span class="hs-comment">-- The default definition spans the full range of 'Int'.</span><span>
</span><a name="line-170"></a><span>   </span><a name="genRange"><a href="System.Random.html#genRange"><span class="hs-identifier">genRange</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679031614"><span class="hs-identifier hs-type">g</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span>
</span><a name="line-171"></a><span>
</span><a name="line-172"></a><span>   </span><span class="hs-comment">-- default method</span><span>
</span><a name="line-173"></a><span>   </span><a name="local-8214565720323804054"><a href="System.Random.html#genRange"><span class="hs-identifier">genRange</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">minBound</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">maxBound</span><span class="hs-special">)</span><span>
</span><a name="line-174"></a><span>
</span><a name="line-175"></a><span class="hs-cpp">#ifdef ENABLE_SPLITTABLEGEN
</span><span class="hs-comment">-- | The class 'SplittableGen' proivides a way to specify a random number</span><span>
</span><a name="line-177"></a><span class="hs-comment">--   generator that can be split into two new generators.</span><span>
</span><a name="line-178"></a><span class="hs-keyword">class</span><span> </span><span class="hs-identifier">SplittableGen</span><span> </span><span class="hs-identifier">g</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-179"></a><span class="hs-cpp">#endif
</span><span>   </span><span class="hs-comment">-- |The 'split' operation allows one to obtain two distinct random number</span><span>
</span><a name="line-181"></a><span>   </span><span class="hs-comment">-- generators. This is very useful in functional programs (for example, when</span><span>
</span><a name="line-182"></a><span>   </span><span class="hs-comment">-- passing a random number generator down to recursive calls), but very</span><span>
</span><a name="line-183"></a><span>   </span><span class="hs-comment">-- little work has been done on statistically robust implementations of</span><span>
</span><a name="line-184"></a><span>   </span><span class="hs-comment">-- 'split' ([&quot;System.Random\#Burton&quot;, &quot;System.Random\#Hellekalek&quot;]</span><span>
</span><a name="line-185"></a><span>   </span><span class="hs-comment">-- are the only examples we know of).</span><span>
</span><a name="line-186"></a><span>   </span><a name="split"><a href="System.Random.html#split"><span class="hs-identifier">split</span></a></a><span>    </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679031614"><span class="hs-identifier hs-type">g</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679031614"><span class="hs-identifier hs-type">g</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679031614"><span class="hs-identifier hs-type">g</span></a><span class="hs-special">)</span><span>
</span><a name="line-187"></a><span>
</span><a name="line-188"></a><span class="hs-comment">{- |
The 'StdGen' instance of 'RandomGen' has a 'genRange' of at least 30 bits.

The result of repeatedly using 'next' should be at least as statistically
robust as the /Minimal Standard Random Number Generator/ described by
[&quot;System.Random\#Park&quot;, &quot;System.Random\#Carta&quot;].
Until more is known about implementations of 'split', all we require is
that 'split' deliver generators that are (a) not identical and
(b) independently robust in the sense just given.

The 'Show' and 'Read' instances of 'StdGen' provide a primitive way to save the
state of a random number generator.
It is required that @'read' ('show' g) == g@.

In addition, 'reads' may be used to map an arbitrary string (not necessarily one
produced by 'show') onto a value of type 'StdGen'. In general, the 'Read'
instance of 'StdGen' has the following properties: 

* It guarantees to succeed on any string. 

* It guarantees to consume only a finite portion of the string. 

* Different argument strings are likely to result in different results.

-}</span><span>
</span><a name="line-213"></a><span>
</span><a name="line-214"></a><span class="hs-keyword">data</span><span> </span><a name="StdGen"><a href="System.Random.html#StdGen"><span class="hs-identifier">StdGen</span></a></a><span>
</span><a name="line-215"></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="StdGen"><a href="System.Random.html#StdGen"><span class="hs-identifier">StdGen</span></a></a><span> </span><span class="hs-glyph">!</span><span class="hs-identifier hs-type">Int32</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier hs-type">Int32</span><span>
</span><a name="line-216"></a><span>
</span><a name="line-217"></a><span class="hs-keyword">instance</span><span> </span><a href="System.Random.html#RandomGen"><span class="hs-identifier hs-type">RandomGen</span></a><span> </span><a href="System.Random.html#StdGen"><span class="hs-identifier hs-type">StdGen</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-218"></a><span>  </span><a name="local-8214565720323804053"><a href="System.Random.html#next"><span class="hs-identifier">next</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#stdNext"><span class="hs-identifier hs-var">stdNext</span></a><span>
</span><a name="line-219"></a><span>  </span><a name="local-8214565720323804054"><a href="System.Random.html#genRange"><span class="hs-identifier">genRange</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#stdRange"><span class="hs-identifier hs-var">stdRange</span></a><span>
</span><a name="line-220"></a><span>
</span><a name="line-221"></a><span class="hs-cpp">#ifdef ENABLE_SPLITTABLEGEN
</span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">SplittableGen</span><span> </span><span class="hs-identifier">StdGen</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-223"></a><span class="hs-cpp">#endif
</span><span>  </span><a name="local-8214565720323804055"><a href="System.Random.html#split"><span class="hs-identifier">split</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#stdSplit"><span class="hs-identifier hs-var">stdSplit</span></a><span>
</span><a name="line-225"></a><span>
</span><a name="line-226"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="System.Random.html#StdGen"><span class="hs-identifier hs-type">StdGen</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-227"></a><span>  </span><a name="local-8214565720323790324"><span class="hs-identifier">showsPrec</span></a><span> </span><a name="local-6989586621679034307"><a href="#local-6989586621679034307"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">(</span><a href="System.Random.html#StdGen"><span class="hs-identifier hs-var">StdGen</span></a><span> </span><a name="local-6989586621679034308"><a href="#local-6989586621679034308"><span class="hs-identifier">s1</span></a></a><span> </span><a name="local-6989586621679034309"><a href="#local-6989586621679034309"><span class="hs-identifier">s2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-228"></a><span>     </span><span class="hs-identifier hs-var">showsPrec</span><span> </span><a href="#local-6989586621679034307"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679034308"><span class="hs-identifier hs-var">s1</span></a><span> </span><span class="hs-operator hs-var">.</span><span>
</span><a name="line-229"></a><span>     </span><span class="hs-identifier hs-var">showChar</span><span> </span><span class="hs-char">' '</span><span> </span><span class="hs-operator hs-var">.</span><span>
</span><a name="line-230"></a><span>     </span><span class="hs-identifier hs-var">showsPrec</span><span> </span><a href="#local-6989586621679034307"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679034309"><span class="hs-identifier hs-var">s2</span></a><span>
</span><a name="line-231"></a><span>
</span><a name="line-232"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Read</span><span> </span><a href="System.Random.html#StdGen"><span class="hs-identifier hs-type">StdGen</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-233"></a><span>  </span><a name="local-8214565720323790028"><span class="hs-identifier">readsPrec</span></a><span> </span><a name="local-6989586621679033799"><a href="#local-6989586621679033799"><span class="hs-identifier">_p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679034305"><a href="#local-6989586621679034305"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-234"></a><span>     </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679033800"><span class="hs-identifier hs-var">try_read</span></a><span> </span><a href="#local-6989586621679034305"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-235"></a><span>       </span><a name="local-6989586621679034306"><a href="#local-6989586621679034306"><span class="hs-identifier">r'</span></a></a><span class="hs-glyph">@</span><span class="hs-special">[</span><span class="hs-identifier">_</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679034306"><span class="hs-identifier hs-var">r'</span></a><span>
</span><a name="line-236"></a><span>       </span><span class="hs-identifier">_</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="System.Random.html#stdFromString"><span class="hs-identifier hs-var">stdFromString</span></a><span> </span><a href="#local-6989586621679034305"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span> </span><span class="hs-comment">-- because it shouldn't ever fail.</span><span>
</span><a name="line-237"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-238"></a><span>      </span><a name="local-6989586621679033800"><a href="#local-6989586621679033800"><span class="hs-identifier">try_read</span></a></a><span> </span><a name="local-6989586621679033801"><a href="#local-6989586621679033801"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-239"></a><span>         </span><span class="hs-special">(</span><a name="local-6989586621679034301"><a href="#local-6989586621679034301"><span class="hs-identifier">s1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679034302"><a href="#local-6989586621679034302"><span class="hs-identifier">r1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readDec</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dropWhile</span><span> </span><span class="hs-identifier hs-var">isSpace</span><span> </span><a href="#local-6989586621679033801"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-240"></a><span>         </span><span class="hs-special">(</span><a name="local-6989586621679034303"><a href="#local-6989586621679034303"><span class="hs-identifier">s2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679034304"><a href="#local-6989586621679034304"><span class="hs-identifier">r2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readDec</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dropWhile</span><span> </span><span class="hs-identifier hs-var">isSpace</span><span> </span><a href="#local-6989586621679034302"><span class="hs-identifier hs-var">r1</span></a><span class="hs-special">)</span><span>
</span><a name="line-241"></a><span>         </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="System.Random.html#StdGen"><span class="hs-identifier hs-var">StdGen</span></a><span> </span><a href="#local-6989586621679034301"><span class="hs-identifier hs-var">s1</span></a><span> </span><a href="#local-6989586621679034303"><span class="hs-identifier hs-var">s2</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679034304"><span class="hs-identifier hs-var">r2</span></a><span class="hs-special">)</span><span>
</span><a name="line-242"></a><span>
</span><a name="line-243"></a><span class="hs-comment">{-
 If we cannot unravel the StdGen from a string, create
 one based on the string given.
-}</span><span>
</span><a name="line-247"></a><span class="hs-identifier">stdFromString</span><span>         </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="System.Random.html#StdGen"><span class="hs-identifier hs-type">StdGen</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">String</span><span class="hs-special">)</span><span>
</span><a name="line-248"></a><a name="stdFromString"><a href="System.Random.html#stdFromString"><span class="hs-identifier">stdFromString</span></a></a><span> </span><a name="local-6989586621679038386"><a href="#local-6989586621679038386"><span class="hs-identifier">s</span></a></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="System.Random.html#mkStdGen"><span class="hs-identifier hs-var">mkStdGen</span></a><span> </span><a href="#local-6989586621679038389"><span class="hs-identifier hs-var">num</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679038388"><span class="hs-identifier hs-var">rest</span></a><span class="hs-special">)</span><span>
</span><a name="line-249"></a><span>        </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679038387"><a href="#local-6989586621679038387"><span class="hs-identifier">cs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679038388"><a href="#local-6989586621679038388"><span class="hs-identifier">rest</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">splitAt</span><span> </span><span class="hs-number">6</span><span> </span><a href="#local-6989586621679038386"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-250"></a><span>              </span><a name="local-6989586621679038389"><a href="#local-6989586621679038389"><span class="hs-identifier">num</span></a></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldl</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679039520"><a href="#local-6989586621679039520"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679039521"><a href="#local-6989586621679039521"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679039521"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679039520"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">ord</span><span> </span><a href="#local-6989586621679038387"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span>
</span><a name="line-251"></a><span>
</span><a name="line-252"></a><span>
</span><a name="line-253"></a><span class="hs-comment">{- |
The function 'mkStdGen' provides an alternative way of producing an initial
generator, by mapping an 'Int' into a generator. Again, distinct arguments
should be likely to produce distinct generators.
-}</span><span>
</span><a name="line-258"></a><span class="hs-identifier">mkStdGen</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Random.html#StdGen"><span class="hs-identifier hs-type">StdGen</span></a><span> </span><span class="hs-comment">-- why not Integer ?</span><span>
</span><a name="line-259"></a><a name="mkStdGen"><a href="System.Random.html#mkStdGen"><span class="hs-identifier">mkStdGen</span></a></a><span> </span><a name="local-6989586621679039522"><a href="#local-6989586621679039522"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#mkStdGen32"><span class="hs-identifier hs-var">mkStdGen32</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621679039522"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-260"></a><span>
</span><a name="line-261"></a><span class="hs-comment">{-
From [&quot;System.Random\#LEcuyer&quot;]: &quot;The integer variables s1 and s2 ... must be
initialized to values in the range [1, 2147483562] and [1, 2147483398]
respectively.&quot;
-}</span><span>
</span><a name="line-266"></a><span class="hs-identifier">mkStdGen32</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int32</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Random.html#StdGen"><span class="hs-identifier hs-type">StdGen</span></a><span>
</span><a name="line-267"></a><a name="mkStdGen32"><a href="System.Random.html#mkStdGen32"><span class="hs-identifier">mkStdGen32</span></a></a><span> </span><a name="local-6989586621679039523"><a href="#local-6989586621679039523"><span class="hs-identifier">sMaybeNegative</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#StdGen"><span class="hs-identifier hs-var">StdGen</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679039526"><span class="hs-identifier hs-var">s1</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679039527"><span class="hs-identifier hs-var">s2</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-268"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-269"></a><span>        </span><span class="hs-comment">-- We want a non-negative number, but we can't just take the abs</span><span>
</span><a name="line-270"></a><span>        </span><span class="hs-comment">-- of sMaybeNegative as -minBound == minBound.</span><span>
</span><a name="line-271"></a><span>        </span><a name="local-6989586621679039524"><a href="#local-6989586621679039524"><span class="hs-identifier">s</span></a></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679039523"><span class="hs-identifier hs-var">sMaybeNegative</span></a><span> </span><span class="hs-operator hs-var">.&amp;.</span><span> </span><span class="hs-identifier hs-var">maxBound</span><span>
</span><a name="line-272"></a><span>        </span><span class="hs-special">(</span><a name="local-6989586621679039525"><a href="#local-6989586621679039525"><span class="hs-identifier">q</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679039526"><a href="#local-6989586621679039526"><span class="hs-identifier">s1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679039524"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">divMod</span><span class="hs-special">`</span><span> </span><span class="hs-number">2147483562</span><span>
</span><a name="line-273"></a><span>        </span><a name="local-6989586621679039527"><a href="#local-6989586621679039527"><span class="hs-identifier">s2</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679039525"><span class="hs-identifier hs-var">q</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">mod</span><span class="hs-special">`</span><span> </span><span class="hs-number">2147483398</span><span>
</span><a name="line-274"></a><span>
</span><a name="line-275"></a><span class="hs-identifier">createStdGen</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Random.html#StdGen"><span class="hs-identifier hs-type">StdGen</span></a><span>
</span><a name="line-276"></a><a name="createStdGen"><a href="System.Random.html#createStdGen"><span class="hs-identifier">createStdGen</span></a></a><span> </span><a name="local-6989586621679039528"><a href="#local-6989586621679039528"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#mkStdGen32"><span class="hs-identifier hs-var">mkStdGen32</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621679039528"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-277"></a><span>
</span><a name="line-278"></a><span class="hs-comment">{- |
With a source of random number supply in hand, the 'Random' class allows the
programmer to extract random values of a variety of types.

Minimal complete definition: 'randomR' and 'random'.

-}</span><span>
</span><a name="line-285"></a><span>
</span><a name="line-286"></a><span class="hs-keyword">class</span><span> </span><a name="Random"><a href="System.Random.html#Random"><span class="hs-identifier">Random</span></a></a><span> </span><a name="local-6989586621679030985"><a href="#local-6989586621679030985"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-287"></a><span>  </span><span class="hs-comment">-- | Takes a range /(lo,hi)/ and a random number generator</span><span>
</span><a name="line-288"></a><span>  </span><span class="hs-comment">-- /g/, and returns a random value uniformly distributed in the closed</span><span>
</span><a name="line-289"></a><span>  </span><span class="hs-comment">-- interval /[lo,hi]/, together with a new generator. It is unspecified</span><span>
</span><a name="line-290"></a><span>  </span><span class="hs-comment">-- what happens if /lo&gt;hi/. For continuous types there is no requirement</span><span>
</span><a name="line-291"></a><span>  </span><span class="hs-comment">-- that the values /lo/ and /hi/ are ever produced, but they may be,</span><span>
</span><a name="line-292"></a><span>  </span><span class="hs-comment">-- depending on the implementation and the interval.</span><span>
</span><a name="line-293"></a><span>  </span><a name="randomR"><a href="System.Random.html#randomR"><span class="hs-identifier">randomR</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.Random.html#RandomGen"><span class="hs-identifier hs-type">RandomGen</span></a><span> </span><a href="#local-6989586621679030986"><span class="hs-identifier hs-type">g</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679030985"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><a href="#local-6989586621679030985"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679030986"><span class="hs-identifier hs-type">g</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679030985"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><a href="#local-6989586621679030986"><span class="hs-identifier hs-type">g</span></a><span class="hs-special">)</span><span>
</span><a name="line-294"></a><span>
</span><a name="line-295"></a><span>  </span><span class="hs-comment">-- | The same as 'randomR', but using a default range determined by the type:</span><span>
</span><a name="line-296"></a><span>  </span><span class="hs-comment">--</span><span>
</span><a name="line-297"></a><span>  </span><span class="hs-comment">-- * For bounded types (instances of 'Bounded', such as 'Char'),</span><span>
</span><a name="line-298"></a><span>  </span><span class="hs-comment">--   the range is normally the whole type.</span><span>
</span><a name="line-299"></a><span>  </span><span class="hs-comment">--</span><span>
</span><a name="line-300"></a><span>  </span><span class="hs-comment">-- * For fractional types, the range is normally the semi-closed interval</span><span>
</span><a name="line-301"></a><span>  </span><span class="hs-comment">-- @[0,1)@.</span><span>
</span><a name="line-302"></a><span>  </span><span class="hs-comment">--</span><span>
</span><a name="line-303"></a><span>  </span><span class="hs-comment">-- * For 'Integer', the range is (arbitrarily) the range of 'Int'.</span><span>
</span><a name="line-304"></a><span>  </span><a name="random"><a href="System.Random.html#random"><span class="hs-identifier">random</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="System.Random.html#RandomGen"><span class="hs-identifier hs-type">RandomGen</span></a><span> </span><a href="#local-6989586621679030987"><span class="hs-identifier hs-type">g</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679030987"><span class="hs-identifier hs-type">g</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679030985"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679030987"><span class="hs-identifier hs-type">g</span></a><span class="hs-special">)</span><span>
</span><a name="line-305"></a><span>
</span><a name="line-306"></a><span>  </span><span class="hs-comment">-- | Plural variant of 'randomR', producing an infinite list of</span><span>
</span><a name="line-307"></a><span>  </span><span class="hs-comment">-- random values instead of returning a new generator.</span><span>
</span><a name="line-308"></a><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">randomRs</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-309"></a><span>  </span><a name="randomRs"><a href="System.Random.html#randomRs"><span class="hs-identifier">randomRs</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.Random.html#RandomGen"><span class="hs-identifier hs-type">RandomGen</span></a><span> </span><a href="#local-6989586621679030988"><span class="hs-identifier hs-type">g</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679030985"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><a href="#local-6989586621679030985"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679030988"><span class="hs-identifier hs-type">g</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679030985"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-310"></a><span>  </span><a name="local-8214565720323804046"><a href="System.Random.html#randomRs"><span class="hs-identifier">randomRs</span></a></a><span> </span><a name="local-6989586621679030990"><a href="#local-6989586621679030990"><span class="hs-identifier">ival</span></a></a><span> </span><a name="local-6989586621679030991"><a href="#local-6989586621679030991"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">build</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679030992"><a href="#local-6989586621679030992"><span class="hs-identifier">cons</span></a></a><span> </span><a name="local-6989586621679030993"><a href="#local-6989586621679030993"><span class="hs-identifier">_nil</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Random.html#buildRandoms"><span class="hs-identifier hs-var">buildRandoms</span></a><span> </span><a href="#local-6989586621679030992"><span class="hs-identifier hs-var">cons</span></a><span> </span><span class="hs-special">(</span><a href="System.Random.html#randomR"><span class="hs-identifier hs-var">randomR</span></a><span> </span><a href="#local-6989586621679030990"><span class="hs-identifier hs-var">ival</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679030991"><span class="hs-identifier hs-var">g</span></a><span class="hs-special">)</span><span>
</span><a name="line-311"></a><span>
</span><a name="line-312"></a><span>  </span><span class="hs-comment">-- | Plural variant of 'random', producing an infinite list of</span><span>
</span><a name="line-313"></a><span>  </span><span class="hs-comment">-- random values instead of returning a new generator.</span><span>
</span><a name="line-314"></a><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">randoms</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-315"></a><span>  </span><a name="randoms"><a href="System.Random.html#randoms"><span class="hs-identifier">randoms</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="System.Random.html#RandomGen"><span class="hs-identifier hs-type">RandomGen</span></a><span> </span><a href="#local-6989586621679030989"><span class="hs-identifier hs-type">g</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679030989"><span class="hs-identifier hs-type">g</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679030985"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-316"></a><span>  </span><a name="local-8214565720323804047"><a href="System.Random.html#randoms"><span class="hs-identifier">randoms</span></a></a><span>  </span><a name="local-6989586621679030994"><a href="#local-6989586621679030994"><span class="hs-identifier">g</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">build</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679030995"><a href="#local-6989586621679030995"><span class="hs-identifier">cons</span></a></a><span> </span><a name="local-6989586621679030996"><a href="#local-6989586621679030996"><span class="hs-identifier">_nil</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Random.html#buildRandoms"><span class="hs-identifier hs-var">buildRandoms</span></a><span> </span><a href="#local-6989586621679030995"><span class="hs-identifier hs-var">cons</span></a><span> </span><a href="System.Random.html#random"><span class="hs-identifier hs-var">random</span></a><span> </span><a href="#local-6989586621679030994"><span class="hs-identifier hs-var">g</span></a><span class="hs-special">)</span><span>
</span><a name="line-317"></a><span>
</span><a name="line-318"></a><span>  </span><span class="hs-comment">-- | A variant of 'randomR' that uses the global random number generator</span><span>
</span><a name="line-319"></a><span>  </span><span class="hs-comment">-- (see &quot;System.Random#globalrng&quot;).</span><span>
</span><a name="line-320"></a><span>  </span><a name="randomRIO"><a href="System.Random.html#randomRIO"><span class="hs-identifier">randomRIO</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679030985"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><a href="#local-6989586621679030985"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="#local-6989586621679030985"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-321"></a><span>  </span><a name="local-8214565720323804048"><a href="System.Random.html#randomRIO"><span class="hs-identifier">randomRIO</span></a></a><span> </span><a name="local-6989586621679030997"><a href="#local-6989586621679030997"><span class="hs-identifier">range</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#getStdRandom"><span class="hs-identifier hs-var">getStdRandom</span></a><span> </span><span class="hs-special">(</span><a href="System.Random.html#randomR"><span class="hs-identifier hs-var">randomR</span></a><span> </span><a href="#local-6989586621679030997"><span class="hs-identifier hs-var">range</span></a><span class="hs-special">)</span><span>
</span><a name="line-322"></a><span>
</span><a name="line-323"></a><span>  </span><span class="hs-comment">-- | A variant of 'random' that uses the global random number generator</span><span>
</span><a name="line-324"></a><span>  </span><span class="hs-comment">-- (see &quot;System.Random#globalrng&quot;).</span><span>
</span><a name="line-325"></a><span>  </span><a name="randomIO"><a href="System.Random.html#randomIO"><span class="hs-identifier">randomIO</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="#local-6989586621679030985"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-326"></a><span>  </span><a name="local-8214565720323804049"><a href="System.Random.html#randomIO"><span class="hs-identifier">randomIO</span></a></a><span>         </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#getStdRandom"><span class="hs-identifier hs-var">getStdRandom</span></a><span> </span><a href="System.Random.html#random"><span class="hs-identifier hs-var">random</span></a><span>
</span><a name="line-327"></a><span>
</span><a name="line-328"></a><span class="hs-comment">-- | Produce an infinite list-equivalent of random values.</span><span>
</span><a name="line-329"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">buildRandoms</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-330"></a><span class="hs-identifier">buildRandoms</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.Random.html#RandomGen"><span class="hs-identifier hs-type">RandomGen</span></a><span> </span><a href="#local-6989586621679038224"><span class="hs-identifier hs-type">g</span></a><span>
</span><a name="line-331"></a><span>             </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679038225"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">as</span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- ^ E.g. '(:)' but subject to fusion</span><span>
</span><a name="line-332"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679038224"><span class="hs-identifier hs-type">g</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679038225"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><a href="#local-6989586621679038224"><span class="hs-identifier hs-type">g</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>     </span><span class="hs-comment">-- ^ E.g. 'random'</span><span>
</span><a name="line-333"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679038224"><span class="hs-identifier hs-type">g</span></a><span>                </span><span class="hs-comment">-- ^ A 'RandomGen' instance</span><span>
</span><a name="line-334"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">as</span><span>
</span><a name="line-335"></a><a name="buildRandoms"><a href="System.Random.html#buildRandoms"><span class="hs-identifier">buildRandoms</span></a></a><span> </span><a name="local-6989586621679039529"><a href="#local-6989586621679039529"><span class="hs-identifier">cons</span></a></a><span> </span><a name="local-6989586621679039530"><a href="#local-6989586621679039530"><span class="hs-identifier">rand</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679039531"><span class="hs-identifier hs-var">go</span></a><span>
</span><a name="line-336"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-337"></a><span>    </span><span class="hs-comment">-- The seq fixes part of #4218 and also makes fused Core simpler.</span><span>
</span><a name="line-338"></a><span>    </span><a name="local-6989586621679039531"><a href="#local-6989586621679039531"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-6989586621679039532"><a href="#local-6989586621679039532"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679039533"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">seq</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679039533"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621679039529"><span class="hs-identifier hs-var">cons</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679039531"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679039534"><span class="hs-identifier hs-var">g'</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679039533"><a href="#local-6989586621679039533"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><a name="local-6989586621679039534"><a href="#local-6989586621679039534"><span class="hs-identifier">g'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679039530"><span class="hs-identifier hs-var">rand</span></a><span> </span><a href="#local-6989586621679039532"><span class="hs-identifier hs-var">g</span></a><span>
</span><a name="line-339"></a><span>
</span><a name="line-340"></a><span>
</span><a name="line-341"></a><span class="hs-keyword">instance</span><span> </span><a href="System.Random.html#Random"><span class="hs-identifier hs-type">Random</span></a><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-342"></a><span>  </span><a name="local-8214565720323804044"><a href="System.Random.html#randomR"><span class="hs-identifier">randomR</span></a></a><span> </span><a name="local-6989586621679033796"><a href="#local-6989586621679033796"><span class="hs-identifier">ival</span></a></a><span> </span><a name="local-6989586621679033797"><a href="#local-6989586621679033797"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomIvalInteger"><span class="hs-identifier hs-var">randomIvalInteger</span></a><span> </span><a href="#local-6989586621679033796"><span class="hs-identifier hs-var">ival</span></a><span> </span><a href="#local-6989586621679033797"><span class="hs-identifier hs-var">g</span></a><span>
</span><a name="line-343"></a><span>  </span><a name="local-8214565720323804045"><a href="System.Random.html#random"><span class="hs-identifier">random</span></a></a><span> </span><a name="local-6989586621679033798"><a href="#local-6989586621679033798"><span class="hs-identifier">g</span></a></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomR"><span class="hs-identifier hs-var">randomR</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">toInteger</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">minBound</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">toInteger</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">maxBound</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679033798"><span class="hs-identifier hs-var">g</span></a><span>
</span><a name="line-344"></a><span>
</span><a name="line-345"></a><span class="hs-keyword">instance</span><span> </span><a href="System.Random.html#Random"><span class="hs-identifier hs-type">Random</span></a><span> </span><span class="hs-identifier hs-type">Int</span><span>        </span><span class="hs-keyword">where</span><span> </span><a name="local-8214565720323804044"><a href="System.Random.html#randomR"><span class="hs-identifier">randomR</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomIvalIntegral"><span class="hs-identifier hs-var">randomIvalIntegral</span></a><span class="hs-special">;</span><span> </span><a name="local-8214565720323804045"><a href="System.Random.html#random"><span class="hs-identifier">random</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomBounded"><span class="hs-identifier hs-var">randomBounded</span></a><span>
</span><a name="line-346"></a><span class="hs-keyword">instance</span><span> </span><a href="System.Random.html#Random"><span class="hs-identifier hs-type">Random</span></a><span> </span><span class="hs-identifier hs-type">Int8</span><span>       </span><span class="hs-keyword">where</span><span> </span><a name="local-8214565720323804044"><a href="System.Random.html#randomR"><span class="hs-identifier">randomR</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomIvalIntegral"><span class="hs-identifier hs-var">randomIvalIntegral</span></a><span class="hs-special">;</span><span> </span><a name="local-8214565720323804045"><a href="System.Random.html#random"><span class="hs-identifier">random</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomBounded"><span class="hs-identifier hs-var">randomBounded</span></a><span>
</span><a name="line-347"></a><span class="hs-keyword">instance</span><span> </span><a href="System.Random.html#Random"><span class="hs-identifier hs-type">Random</span></a><span> </span><span class="hs-identifier hs-type">Int16</span><span>      </span><span class="hs-keyword">where</span><span> </span><a name="local-8214565720323804044"><a href="System.Random.html#randomR"><span class="hs-identifier">randomR</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomIvalIntegral"><span class="hs-identifier hs-var">randomIvalIntegral</span></a><span class="hs-special">;</span><span> </span><a name="local-8214565720323804045"><a href="System.Random.html#random"><span class="hs-identifier">random</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomBounded"><span class="hs-identifier hs-var">randomBounded</span></a><span>
</span><a name="line-348"></a><span class="hs-keyword">instance</span><span> </span><a href="System.Random.html#Random"><span class="hs-identifier hs-type">Random</span></a><span> </span><span class="hs-identifier hs-type">Int32</span><span>      </span><span class="hs-keyword">where</span><span> </span><a name="local-8214565720323804044"><a href="System.Random.html#randomR"><span class="hs-identifier">randomR</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomIvalIntegral"><span class="hs-identifier hs-var">randomIvalIntegral</span></a><span class="hs-special">;</span><span> </span><a name="local-8214565720323804045"><a href="System.Random.html#random"><span class="hs-identifier">random</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomBounded"><span class="hs-identifier hs-var">randomBounded</span></a><span>
</span><a name="line-349"></a><span class="hs-keyword">instance</span><span> </span><a href="System.Random.html#Random"><span class="hs-identifier hs-type">Random</span></a><span> </span><span class="hs-identifier hs-type">Int64</span><span>      </span><span class="hs-keyword">where</span><span> </span><a name="local-8214565720323804044"><a href="System.Random.html#randomR"><span class="hs-identifier">randomR</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomIvalIntegral"><span class="hs-identifier hs-var">randomIvalIntegral</span></a><span class="hs-special">;</span><span> </span><a name="local-8214565720323804045"><a href="System.Random.html#random"><span class="hs-identifier">random</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomBounded"><span class="hs-identifier hs-var">randomBounded</span></a><span>
</span><a name="line-350"></a><span>
</span><a name="line-351"></a><span class="hs-cpp">#ifndef __NHC__
</span><span class="hs-comment">-- Word is a type synonym in nhc98.</span><span>
</span><a name="line-353"></a><span class="hs-keyword">instance</span><span> </span><a href="System.Random.html#Random"><span class="hs-identifier hs-type">Random</span></a><span> </span><span class="hs-identifier hs-type">Word</span><span>       </span><span class="hs-keyword">where</span><span> </span><a name="local-8214565720323804044"><a href="System.Random.html#randomR"><span class="hs-identifier">randomR</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomIvalIntegral"><span class="hs-identifier hs-var">randomIvalIntegral</span></a><span class="hs-special">;</span><span> </span><a name="local-8214565720323804045"><a href="System.Random.html#random"><span class="hs-identifier">random</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomBounded"><span class="hs-identifier hs-var">randomBounded</span></a><span>
</span><a name="line-354"></a><span class="hs-cpp">#endif
</span><span class="hs-keyword">instance</span><span> </span><a href="System.Random.html#Random"><span class="hs-identifier hs-type">Random</span></a><span> </span><span class="hs-identifier hs-type">Word8</span><span>      </span><span class="hs-keyword">where</span><span> </span><a name="local-8214565720323804044"><a href="System.Random.html#randomR"><span class="hs-identifier">randomR</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomIvalIntegral"><span class="hs-identifier hs-var">randomIvalIntegral</span></a><span class="hs-special">;</span><span> </span><a name="local-8214565720323804045"><a href="System.Random.html#random"><span class="hs-identifier">random</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomBounded"><span class="hs-identifier hs-var">randomBounded</span></a><span>
</span><a name="line-356"></a><span class="hs-keyword">instance</span><span> </span><a href="System.Random.html#Random"><span class="hs-identifier hs-type">Random</span></a><span> </span><span class="hs-identifier hs-type">Word16</span><span>     </span><span class="hs-keyword">where</span><span> </span><a name="local-8214565720323804044"><a href="System.Random.html#randomR"><span class="hs-identifier">randomR</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomIvalIntegral"><span class="hs-identifier hs-var">randomIvalIntegral</span></a><span class="hs-special">;</span><span> </span><a name="local-8214565720323804045"><a href="System.Random.html#random"><span class="hs-identifier">random</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomBounded"><span class="hs-identifier hs-var">randomBounded</span></a><span>
</span><a name="line-357"></a><span class="hs-keyword">instance</span><span> </span><a href="System.Random.html#Random"><span class="hs-identifier hs-type">Random</span></a><span> </span><span class="hs-identifier hs-type">Word32</span><span>     </span><span class="hs-keyword">where</span><span> </span><a name="local-8214565720323804044"><a href="System.Random.html#randomR"><span class="hs-identifier">randomR</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomIvalIntegral"><span class="hs-identifier hs-var">randomIvalIntegral</span></a><span class="hs-special">;</span><span> </span><a name="local-8214565720323804045"><a href="System.Random.html#random"><span class="hs-identifier">random</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomBounded"><span class="hs-identifier hs-var">randomBounded</span></a><span>
</span><a name="line-358"></a><span class="hs-keyword">instance</span><span> </span><a href="System.Random.html#Random"><span class="hs-identifier hs-type">Random</span></a><span> </span><span class="hs-identifier hs-type">Word64</span><span>     </span><span class="hs-keyword">where</span><span> </span><a name="local-8214565720323804044"><a href="System.Random.html#randomR"><span class="hs-identifier">randomR</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomIvalIntegral"><span class="hs-identifier hs-var">randomIvalIntegral</span></a><span class="hs-special">;</span><span> </span><a name="local-8214565720323804045"><a href="System.Random.html#random"><span class="hs-identifier">random</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomBounded"><span class="hs-identifier hs-var">randomBounded</span></a><span>
</span><a name="line-359"></a><span>
</span><a name="line-360"></a><span class="hs-keyword">instance</span><span> </span><a href="System.Random.html#Random"><span class="hs-identifier hs-type">Random</span></a><span> </span><span class="hs-identifier hs-type">CChar</span><span>      </span><span class="hs-keyword">where</span><span> </span><a name="local-8214565720323804044"><a href="System.Random.html#randomR"><span class="hs-identifier">randomR</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomIvalIntegral"><span class="hs-identifier hs-var">randomIvalIntegral</span></a><span class="hs-special">;</span><span> </span><a name="local-8214565720323804045"><a href="System.Random.html#random"><span class="hs-identifier">random</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomBounded"><span class="hs-identifier hs-var">randomBounded</span></a><span>
</span><a name="line-361"></a><span class="hs-keyword">instance</span><span> </span><a href="System.Random.html#Random"><span class="hs-identifier hs-type">Random</span></a><span> </span><span class="hs-identifier hs-type">CSChar</span><span>     </span><span class="hs-keyword">where</span><span> </span><a name="local-8214565720323804044"><a href="System.Random.html#randomR"><span class="hs-identifier">randomR</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomIvalIntegral"><span class="hs-identifier hs-var">randomIvalIntegral</span></a><span class="hs-special">;</span><span> </span><a name="local-8214565720323804045"><a href="System.Random.html#random"><span class="hs-identifier">random</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomBounded"><span class="hs-identifier hs-var">randomBounded</span></a><span>
</span><a name="line-362"></a><span class="hs-keyword">instance</span><span> </span><a href="System.Random.html#Random"><span class="hs-identifier hs-type">Random</span></a><span> </span><span class="hs-identifier hs-type">CUChar</span><span>     </span><span class="hs-keyword">where</span><span> </span><a name="local-8214565720323804044"><a href="System.Random.html#randomR"><span class="hs-identifier">randomR</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomIvalIntegral"><span class="hs-identifier hs-var">randomIvalIntegral</span></a><span class="hs-special">;</span><span> </span><a name="local-8214565720323804045"><a href="System.Random.html#random"><span class="hs-identifier">random</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomBounded"><span class="hs-identifier hs-var">randomBounded</span></a><span>
</span><a name="line-363"></a><span class="hs-keyword">instance</span><span> </span><a href="System.Random.html#Random"><span class="hs-identifier hs-type">Random</span></a><span> </span><span class="hs-identifier hs-type">CShort</span><span>     </span><span class="hs-keyword">where</span><span> </span><a name="local-8214565720323804044"><a href="System.Random.html#randomR"><span class="hs-identifier">randomR</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomIvalIntegral"><span class="hs-identifier hs-var">randomIvalIntegral</span></a><span class="hs-special">;</span><span> </span><a name="local-8214565720323804045"><a href="System.Random.html#random"><span class="hs-identifier">random</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomBounded"><span class="hs-identifier hs-var">randomBounded</span></a><span>
</span><a name="line-364"></a><span class="hs-keyword">instance</span><span> </span><a href="System.Random.html#Random"><span class="hs-identifier hs-type">Random</span></a><span> </span><span class="hs-identifier hs-type">CUShort</span><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-8214565720323804044"><a href="System.Random.html#randomR"><span class="hs-identifier">randomR</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomIvalIntegral"><span class="hs-identifier hs-var">randomIvalIntegral</span></a><span class="hs-special">;</span><span> </span><a name="local-8214565720323804045"><a href="System.Random.html#random"><span class="hs-identifier">random</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomBounded"><span class="hs-identifier hs-var">randomBounded</span></a><span>
</span><a name="line-365"></a><span class="hs-keyword">instance</span><span> </span><a href="System.Random.html#Random"><span class="hs-identifier hs-type">Random</span></a><span> </span><span class="hs-identifier hs-type">CInt</span><span>       </span><span class="hs-keyword">where</span><span> </span><a name="local-8214565720323804044"><a href="System.Random.html#randomR"><span class="hs-identifier">randomR</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomIvalIntegral"><span class="hs-identifier hs-var">randomIvalIntegral</span></a><span class="hs-special">;</span><span> </span><a name="local-8214565720323804045"><a href="System.Random.html#random"><span class="hs-identifier">random</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomBounded"><span class="hs-identifier hs-var">randomBounded</span></a><span>
</span><a name="line-366"></a><span class="hs-keyword">instance</span><span> </span><a href="System.Random.html#Random"><span class="hs-identifier hs-type">Random</span></a><span> </span><span class="hs-identifier hs-type">CUInt</span><span>      </span><span class="hs-keyword">where</span><span> </span><a name="local-8214565720323804044"><a href="System.Random.html#randomR"><span class="hs-identifier">randomR</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomIvalIntegral"><span class="hs-identifier hs-var">randomIvalIntegral</span></a><span class="hs-special">;</span><span> </span><a name="local-8214565720323804045"><a href="System.Random.html#random"><span class="hs-identifier">random</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomBounded"><span class="hs-identifier hs-var">randomBounded</span></a><span>
</span><a name="line-367"></a><span class="hs-keyword">instance</span><span> </span><a href="System.Random.html#Random"><span class="hs-identifier hs-type">Random</span></a><span> </span><span class="hs-identifier hs-type">CLong</span><span>      </span><span class="hs-keyword">where</span><span> </span><a name="local-8214565720323804044"><a href="System.Random.html#randomR"><span class="hs-identifier">randomR</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomIvalIntegral"><span class="hs-identifier hs-var">randomIvalIntegral</span></a><span class="hs-special">;</span><span> </span><a name="local-8214565720323804045"><a href="System.Random.html#random"><span class="hs-identifier">random</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomBounded"><span class="hs-identifier hs-var">randomBounded</span></a><span>
</span><a name="line-368"></a><span class="hs-keyword">instance</span><span> </span><a href="System.Random.html#Random"><span class="hs-identifier hs-type">Random</span></a><span> </span><span class="hs-identifier hs-type">CULong</span><span>     </span><span class="hs-keyword">where</span><span> </span><a name="local-8214565720323804044"><a href="System.Random.html#randomR"><span class="hs-identifier">randomR</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomIvalIntegral"><span class="hs-identifier hs-var">randomIvalIntegral</span></a><span class="hs-special">;</span><span> </span><a name="local-8214565720323804045"><a href="System.Random.html#random"><span class="hs-identifier">random</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomBounded"><span class="hs-identifier hs-var">randomBounded</span></a><span>
</span><a name="line-369"></a><span class="hs-keyword">instance</span><span> </span><a href="System.Random.html#Random"><span class="hs-identifier hs-type">Random</span></a><span> </span><span class="hs-identifier hs-type">CPtrdiff</span><span>   </span><span class="hs-keyword">where</span><span> </span><a name="local-8214565720323804044"><a href="System.Random.html#randomR"><span class="hs-identifier">randomR</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomIvalIntegral"><span class="hs-identifier hs-var">randomIvalIntegral</span></a><span class="hs-special">;</span><span> </span><a name="local-8214565720323804045"><a href="System.Random.html#random"><span class="hs-identifier">random</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomBounded"><span class="hs-identifier hs-var">randomBounded</span></a><span>
</span><a name="line-370"></a><span class="hs-keyword">instance</span><span> </span><a href="System.Random.html#Random"><span class="hs-identifier hs-type">Random</span></a><span> </span><span class="hs-identifier hs-type">CSize</span><span>      </span><span class="hs-keyword">where</span><span> </span><a name="local-8214565720323804044"><a href="System.Random.html#randomR"><span class="hs-identifier">randomR</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomIvalIntegral"><span class="hs-identifier hs-var">randomIvalIntegral</span></a><span class="hs-special">;</span><span> </span><a name="local-8214565720323804045"><a href="System.Random.html#random"><span class="hs-identifier">random</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomBounded"><span class="hs-identifier hs-var">randomBounded</span></a><span>
</span><a name="line-371"></a><span class="hs-keyword">instance</span><span> </span><a href="System.Random.html#Random"><span class="hs-identifier hs-type">Random</span></a><span> </span><span class="hs-identifier hs-type">CWchar</span><span>     </span><span class="hs-keyword">where</span><span> </span><a name="local-8214565720323804044"><a href="System.Random.html#randomR"><span class="hs-identifier">randomR</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomIvalIntegral"><span class="hs-identifier hs-var">randomIvalIntegral</span></a><span class="hs-special">;</span><span> </span><a name="local-8214565720323804045"><a href="System.Random.html#random"><span class="hs-identifier">random</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomBounded"><span class="hs-identifier hs-var">randomBounded</span></a><span>
</span><a name="line-372"></a><span class="hs-keyword">instance</span><span> </span><a href="System.Random.html#Random"><span class="hs-identifier hs-type">Random</span></a><span> </span><span class="hs-identifier hs-type">CSigAtomic</span><span> </span><span class="hs-keyword">where</span><span> </span><a name="local-8214565720323804044"><a href="System.Random.html#randomR"><span class="hs-identifier">randomR</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomIvalIntegral"><span class="hs-identifier hs-var">randomIvalIntegral</span></a><span class="hs-special">;</span><span> </span><a name="local-8214565720323804045"><a href="System.Random.html#random"><span class="hs-identifier">random</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomBounded"><span class="hs-identifier hs-var">randomBounded</span></a><span>
</span><a name="line-373"></a><span class="hs-keyword">instance</span><span> </span><a href="System.Random.html#Random"><span class="hs-identifier hs-type">Random</span></a><span> </span><span class="hs-identifier hs-type">CLLong</span><span>     </span><span class="hs-keyword">where</span><span> </span><a name="local-8214565720323804044"><a href="System.Random.html#randomR"><span class="hs-identifier">randomR</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomIvalIntegral"><span class="hs-identifier hs-var">randomIvalIntegral</span></a><span class="hs-special">;</span><span> </span><a name="local-8214565720323804045"><a href="System.Random.html#random"><span class="hs-identifier">random</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomBounded"><span class="hs-identifier hs-var">randomBounded</span></a><span>
</span><a name="line-374"></a><span class="hs-keyword">instance</span><span> </span><a href="System.Random.html#Random"><span class="hs-identifier hs-type">Random</span></a><span> </span><span class="hs-identifier hs-type">CULLong</span><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-8214565720323804044"><a href="System.Random.html#randomR"><span class="hs-identifier">randomR</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomIvalIntegral"><span class="hs-identifier hs-var">randomIvalIntegral</span></a><span class="hs-special">;</span><span> </span><a name="local-8214565720323804045"><a href="System.Random.html#random"><span class="hs-identifier">random</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomBounded"><span class="hs-identifier hs-var">randomBounded</span></a><span>
</span><a name="line-375"></a><span class="hs-keyword">instance</span><span> </span><a href="System.Random.html#Random"><span class="hs-identifier hs-type">Random</span></a><span> </span><span class="hs-identifier hs-type">CIntPtr</span><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-8214565720323804044"><a href="System.Random.html#randomR"><span class="hs-identifier">randomR</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomIvalIntegral"><span class="hs-identifier hs-var">randomIvalIntegral</span></a><span class="hs-special">;</span><span> </span><a name="local-8214565720323804045"><a href="System.Random.html#random"><span class="hs-identifier">random</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomBounded"><span class="hs-identifier hs-var">randomBounded</span></a><span>
</span><a name="line-376"></a><span class="hs-keyword">instance</span><span> </span><a href="System.Random.html#Random"><span class="hs-identifier hs-type">Random</span></a><span> </span><span class="hs-identifier hs-type">CUIntPtr</span><span>   </span><span class="hs-keyword">where</span><span> </span><a name="local-8214565720323804044"><a href="System.Random.html#randomR"><span class="hs-identifier">randomR</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomIvalIntegral"><span class="hs-identifier hs-var">randomIvalIntegral</span></a><span class="hs-special">;</span><span> </span><a name="local-8214565720323804045"><a href="System.Random.html#random"><span class="hs-identifier">random</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomBounded"><span class="hs-identifier hs-var">randomBounded</span></a><span>
</span><a name="line-377"></a><span class="hs-keyword">instance</span><span> </span><a href="System.Random.html#Random"><span class="hs-identifier hs-type">Random</span></a><span> </span><span class="hs-identifier hs-type">CIntMax</span><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-8214565720323804044"><a href="System.Random.html#randomR"><span class="hs-identifier">randomR</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomIvalIntegral"><span class="hs-identifier hs-var">randomIvalIntegral</span></a><span class="hs-special">;</span><span> </span><a name="local-8214565720323804045"><a href="System.Random.html#random"><span class="hs-identifier">random</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomBounded"><span class="hs-identifier hs-var">randomBounded</span></a><span>
</span><a name="line-378"></a><span class="hs-keyword">instance</span><span> </span><a href="System.Random.html#Random"><span class="hs-identifier hs-type">Random</span></a><span> </span><span class="hs-identifier hs-type">CUIntMax</span><span>   </span><span class="hs-keyword">where</span><span> </span><a name="local-8214565720323804044"><a href="System.Random.html#randomR"><span class="hs-identifier">randomR</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomIvalIntegral"><span class="hs-identifier hs-var">randomIvalIntegral</span></a><span class="hs-special">;</span><span> </span><a name="local-8214565720323804045"><a href="System.Random.html#random"><span class="hs-identifier">random</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomBounded"><span class="hs-identifier hs-var">randomBounded</span></a><span>
</span><a name="line-379"></a><span>
</span><a name="line-380"></a><span class="hs-keyword">instance</span><span> </span><a href="System.Random.html#Random"><span class="hs-identifier hs-type">Random</span></a><span> </span><span class="hs-identifier hs-type">Char</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-381"></a><span>  </span><a name="local-8214565720323804044"><a href="System.Random.html#randomR"><span class="hs-identifier">randomR</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679033232"><a href="#local-6989586621679033232"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><a name="local-6989586621679033233"><a href="#local-6989586621679033233"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679033234"><a href="#local-6989586621679033234"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-382"></a><span>       </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="System.Random.html#randomIvalInteger"><span class="hs-identifier hs-var">randomIvalInteger</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">toInteger</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ord</span><span> </span><a href="#local-6989586621679033232"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">toInteger</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ord</span><span> </span><a href="#local-6989586621679033233"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679033234"><span class="hs-identifier hs-var">g</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-383"></a><span>         </span><span class="hs-special">(</span><a name="local-6989586621679033235"><a href="#local-6989586621679033235"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><a name="local-6989586621679033236"><a href="#local-6989586621679033236"><span class="hs-identifier">g'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">chr</span><span> </span><a href="#local-6989586621679033235"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679033236"><span class="hs-identifier hs-var">g'</span></a><span class="hs-special">)</span><span>
</span><a name="line-384"></a><span>  </span><a name="local-8214565720323804045"><a href="System.Random.html#random"><span class="hs-identifier">random</span></a></a><span> </span><a name="local-6989586621679033252"><a href="#local-6989586621679033252"><span class="hs-identifier">g</span></a></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomR"><span class="hs-identifier hs-var">randomR</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">minBound</span><span class="hs-special">,</span><span class="hs-identifier hs-var">maxBound</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679033252"><span class="hs-identifier hs-var">g</span></a><span>
</span><a name="line-385"></a><span>
</span><a name="line-386"></a><span class="hs-keyword">instance</span><span> </span><a href="System.Random.html#Random"><span class="hs-identifier hs-type">Random</span></a><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-387"></a><span>  </span><a name="local-8214565720323804044"><a href="System.Random.html#randomR"><span class="hs-identifier">randomR</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679032774"><a href="#local-6989586621679032774"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><a name="local-6989586621679032775"><a href="#local-6989586621679032775"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679032776"><a href="#local-6989586621679032776"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-388"></a><span>      </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="System.Random.html#randomIvalInteger"><span class="hs-identifier hs-var">randomIvalInteger</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032777"><span class="hs-identifier hs-var">bool2Int</span></a><span> </span><a href="#local-6989586621679032774"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032777"><span class="hs-identifier hs-var">bool2Int</span></a><span> </span><a href="#local-6989586621679032775"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679032776"><span class="hs-identifier hs-var">g</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-389"></a><span>        </span><span class="hs-special">(</span><a name="local-6989586621679033229"><a href="#local-6989586621679033229"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679033230"><a href="#local-6989586621679033230"><span class="hs-identifier">g'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032778"><span class="hs-identifier hs-var">int2Bool</span></a><span> </span><a href="#local-6989586621679033229"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679033230"><span class="hs-identifier hs-var">g'</span></a><span class="hs-special">)</span><span>
</span><a name="line-390"></a><span>       </span><span class="hs-keyword">where</span><span>
</span><a name="line-391"></a><span>         </span><span class="hs-identifier">bool2Int</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Integer</span><span>
</span><a name="line-392"></a><span>         </span><a name="local-6989586621679032777"><a href="#local-6989586621679032777"><span class="hs-identifier">bool2Int</span></a></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-393"></a><span>         </span><span class="hs-identifier">bool2Int</span><span> </span><span class="hs-identifier hs-var">True</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-394"></a><span>
</span><a name="line-395"></a><span>         </span><span class="hs-identifier">int2Bool</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-396"></a><span>         </span><a name="local-6989586621679032778"><a href="#local-6989586621679032778"><span class="hs-identifier">int2Bool</span></a></a><span> </span><span class="hs-number">0</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-397"></a><span>         </span><span class="hs-identifier">int2Bool</span><span> </span><span class="hs-identifier">_</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-398"></a><span>
</span><a name="line-399"></a><span>  </span><a name="local-8214565720323804045"><a href="System.Random.html#random"><span class="hs-identifier">random</span></a></a><span> </span><a name="local-6989586621679033231"><a href="#local-6989586621679033231"><span class="hs-identifier">g</span></a></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomR"><span class="hs-identifier hs-var">randomR</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">minBound</span><span class="hs-special">,</span><span class="hs-identifier hs-var">maxBound</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679033231"><span class="hs-identifier hs-var">g</span></a><span>
</span><a name="line-400"></a><span>
</span><a name="line-401"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">randomRFloating</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-402"></a><span class="hs-identifier">randomRFloating</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Fractional</span><span> </span><a href="#local-6989586621679034362"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679034362"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679034362"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="System.Random.html#Random"><span class="hs-identifier hs-type">Random</span></a><span> </span><a href="#local-6989586621679034362"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="System.Random.html#RandomGen"><span class="hs-identifier hs-type">RandomGen</span></a><span> </span><a href="#local-6989586621679034363"><span class="hs-identifier hs-type">g</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679034362"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679034362"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679034363"><span class="hs-identifier hs-type">g</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679034362"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679034363"><span class="hs-identifier hs-type">g</span></a><span class="hs-special">)</span><span>
</span><a name="line-403"></a><a name="randomRFloating"><a href="System.Random.html#randomRFloating"><span class="hs-identifier">randomRFloating</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679039535"><a href="#local-6989586621679039535"><span class="hs-identifier">l</span></a></a><span class="hs-special">,</span><a name="local-6989586621679039536"><a href="#local-6989586621679039536"><span class="hs-identifier">h</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679039537"><a href="#local-6989586621679039537"><span class="hs-identifier">g</span></a></a><span>
</span><a name="line-404"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679039535"><span class="hs-identifier hs-var">l</span></a><span class="hs-operator hs-var">&gt;</span><a href="#local-6989586621679039536"><span class="hs-identifier hs-var">h</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomRFloating"><span class="hs-identifier hs-var">randomRFloating</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679039536"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">,</span><a href="#local-6989586621679039535"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679039537"><span class="hs-identifier hs-var">g</span></a><span>
</span><a name="line-405"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679039538"><a href="#local-6989586621679039538"><span class="hs-identifier">coef</span></a></a><span class="hs-special">,</span><a name="local-6989586621679039539"><a href="#local-6989586621679039539"><span class="hs-identifier">g'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#random"><span class="hs-identifier hs-var">random</span></a><span> </span><a href="#local-6989586621679039537"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-406"></a><span>                  </span><span class="hs-special">(</span><span class="hs-number">2.0</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><span class="hs-number">0.5</span><span class="hs-operator hs-var">*</span><a href="#local-6989586621679039535"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679039538"><span class="hs-identifier hs-var">coef</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><span class="hs-number">0.5</span><span class="hs-operator hs-var">*</span><a href="#local-6989586621679039536"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">0.5</span><span class="hs-operator hs-var">*</span><a href="#local-6989586621679039535"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679039539"><span class="hs-identifier hs-var">g'</span></a><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- avoid overflow</span><span>
</span><a name="line-407"></a><span>
</span><a name="line-408"></a><span class="hs-keyword">instance</span><span> </span><a href="System.Random.html#Random"><span class="hs-identifier hs-type">Random</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-409"></a><span>  </span><a name="local-8214565720323804044"><a href="System.Random.html#randomR"><span class="hs-identifier">randomR</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomRFloating"><span class="hs-identifier hs-var">randomRFloating</span></a><span>
</span><a name="line-410"></a><span>  </span><a name="local-8214565720323804045"><a href="System.Random.html#random"><span class="hs-identifier">random</span></a></a><span> </span><a name="local-6989586621679032769"><a href="#local-6989586621679032769"><span class="hs-identifier">rng</span></a></a><span>     </span><span class="hs-glyph">=</span><span>
</span><a name="line-411"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="System.Random.html#random"><span class="hs-identifier hs-var">random</span></a><span> </span><a href="#local-6989586621679032769"><span class="hs-identifier hs-var">rng</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-412"></a><span>      </span><span class="hs-special">(</span><a name="local-6989586621679032772"><a href="#local-6989586621679032772"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><a name="local-6989586621679032773"><a href="#local-6989586621679032773"><span class="hs-identifier">rng'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-413"></a><span>          </span><span class="hs-comment">-- We use 53 bits of randomness corresponding to the 53 bit significand:</span><span>
</span><a name="line-414"></a><span>          </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032771"><span class="hs-identifier hs-var">mask53</span></a><span> </span><span class="hs-operator hs-var">.&amp;.</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032772"><span class="hs-identifier hs-var">x</span></a><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Int64</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span>
</span><a name="line-415"></a><span>           </span><span class="hs-operator hs-var">/</span><span>  </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621679032770"><span class="hs-identifier hs-var">twoto53</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032773"><span class="hs-identifier hs-var">rng'</span></a><span class="hs-special">)</span><span>
</span><a name="line-416"></a><span>   </span><span class="hs-keyword">where</span><span>
</span><a name="line-417"></a><span>    </span><a name="local-6989586621679032770"><a href="#local-6989586621679032770"><span class="hs-identifier">twoto53</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-number">2</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Int64</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">^</span><span> </span><span class="hs-special">(</span><span class="hs-number">53</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Int64</span><span class="hs-special">)</span><span>
</span><a name="line-418"></a><span>    </span><a name="local-6989586621679032771"><a href="#local-6989586621679032771"><span class="hs-identifier">mask53</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679032770"><span class="hs-identifier hs-var">twoto53</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-419"></a><span>
</span><a name="line-420"></a><span class="hs-keyword">instance</span><span> </span><a href="System.Random.html#Random"><span class="hs-identifier hs-type">Random</span></a><span> </span><span class="hs-identifier hs-type">Float</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-421"></a><span>  </span><a name="local-8214565720323804044"><a href="System.Random.html#randomR"><span class="hs-identifier">randomR</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomRFloating"><span class="hs-identifier hs-var">randomRFloating</span></a><span>
</span><a name="line-422"></a><span>  </span><a name="local-8214565720323804045"><a href="System.Random.html#random"><span class="hs-identifier">random</span></a></a><span> </span><a name="local-6989586621679032685"><a href="#local-6989586621679032685"><span class="hs-identifier">rng</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-423"></a><span>    </span><span class="hs-comment">-- TODO: Faster to just use 'next' IF it generates enough bits of randomness.   </span><span>
</span><a name="line-424"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="System.Random.html#random"><span class="hs-identifier hs-var">random</span></a><span> </span><a href="#local-6989586621679032685"><span class="hs-identifier hs-var">rng</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-425"></a><span>      </span><span class="hs-special">(</span><a name="local-6989586621679032767"><a href="#local-6989586621679032767"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><a name="local-6989586621679032768"><a href="#local-6989586621679032768"><span class="hs-identifier">rng'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-426"></a><span>          </span><span class="hs-comment">-- We use 24 bits of randomness corresponding to the 24 bit significand:</span><span>
</span><a name="line-427"></a><span>          </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032686"><span class="hs-identifier hs-var">mask24</span></a><span> </span><span class="hs-operator hs-var">.&amp;.</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032767"><span class="hs-identifier hs-var">x</span></a><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Int32</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Float</span><span class="hs-special">)</span><span>
</span><a name="line-428"></a><span>           </span><span class="hs-operator hs-var">/</span><span>  </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621679032687"><span class="hs-identifier hs-var">twoto24</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032768"><span class="hs-identifier hs-var">rng'</span></a><span class="hs-special">)</span><span>
</span><a name="line-429"></a><span>         </span><span class="hs-comment">-- Note, encodeFloat is another option, but I'm not seeing slightly</span><span>
</span><a name="line-430"></a><span>         </span><span class="hs-comment">--  worse performance with the following [2011.06.25]:</span><span>
</span><a name="line-431"></a><span class="hs-comment">--         (encodeFloat rand (-24), rng')</span><span>
</span><a name="line-432"></a><span>   </span><span class="hs-keyword">where</span><span>
</span><a name="line-433"></a><span>     </span><a name="local-6989586621679032686"><a href="#local-6989586621679032686"><span class="hs-identifier">mask24</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679032687"><span class="hs-identifier hs-var">twoto24</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-434"></a><span>     </span><a name="local-6989586621679032687"><a href="#local-6989586621679032687"><span class="hs-identifier">twoto24</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-number">2</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Int32</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">^</span><span> </span><span class="hs-special">(</span><span class="hs-number">24</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Int32</span><span class="hs-special">)</span><span>
</span><a name="line-435"></a><span>
</span><a name="line-436"></a><span class="hs-comment">-- CFloat/CDouble are basically the same as a Float/Double:</span><span>
</span><a name="line-437"></a><span class="hs-keyword">instance</span><span> </span><a href="System.Random.html#Random"><span class="hs-identifier hs-type">Random</span></a><span> </span><span class="hs-identifier hs-type">CFloat</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-438"></a><span>  </span><a name="local-8214565720323804044"><a href="System.Random.html#randomR"><span class="hs-identifier">randomR</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomRFloating"><span class="hs-identifier hs-var">randomRFloating</span></a><span>
</span><a name="line-439"></a><span>  </span><a name="local-8214565720323804045"><a href="System.Random.html#random"><span class="hs-identifier">random</span></a></a><span> </span><a name="local-6989586621679032174"><a href="#local-6989586621679032174"><span class="hs-identifier">rng</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="System.Random.html#random"><span class="hs-identifier hs-var">random</span></a><span> </span><a href="#local-6989586621679032174"><span class="hs-identifier hs-var">rng</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-440"></a><span>                 </span><span class="hs-special">(</span><a name="local-6989586621679032175"><a href="#local-6989586621679032175"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><a name="local-6989586621679032176"><a href="#local-6989586621679032176"><span class="hs-identifier">rng'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">realToFrac</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032175"><span class="hs-identifier hs-var">x</span></a><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Float</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032176"><span class="hs-identifier hs-var">rng'</span></a><span class="hs-special">)</span><span>
</span><a name="line-441"></a><span>
</span><a name="line-442"></a><span class="hs-keyword">instance</span><span> </span><a href="System.Random.html#Random"><span class="hs-identifier hs-type">Random</span></a><span> </span><span class="hs-identifier hs-type">CDouble</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-443"></a><span>  </span><a name="local-8214565720323804044"><a href="System.Random.html#randomR"><span class="hs-identifier">randomR</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomRFloating"><span class="hs-identifier hs-var">randomRFloating</span></a><span>
</span><a name="line-444"></a><span>  </span><span class="hs-comment">-- A MYSTERY:</span><span>
</span><a name="line-445"></a><span>  </span><span class="hs-comment">-- Presently, this is showing better performance than the Double instance:</span><span>
</span><a name="line-446"></a><span>  </span><span class="hs-comment">-- (And yet, if the Double instance uses randomFrac then its performance is much worse!)</span><span>
</span><a name="line-447"></a><span>  </span><a name="local-8214565720323804045"><a href="System.Random.html#random"><span class="hs-identifier">random</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomFrac"><span class="hs-identifier hs-var">randomFrac</span></a><span>
</span><a name="line-448"></a><span>  </span><span class="hs-comment">-- random rng = case random rng of </span><span>
</span><a name="line-449"></a><span>  </span><span class="hs-comment">-- 	         (x,rng') -&gt; (realToFrac (x::Double), rng')</span><span>
</span><a name="line-450"></a><span>
</span><a name="line-451"></a><span class="hs-identifier">mkStdRNG</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="System.Random.html#StdGen"><span class="hs-identifier hs-type">StdGen</span></a><span>
</span><a name="line-452"></a><a name="mkStdRNG"><a href="System.Random.html#mkStdRNG"><span class="hs-identifier">mkStdRNG</span></a></a><span> </span><a name="local-6989586621679039540"><a href="#local-6989586621679039540"><span class="hs-identifier">o</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-453"></a><span>    </span><a name="local-6989586621679039541"><a href="#local-6989586621679039541"><span class="hs-identifier">ct</span></a></a><span>          </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getCPUTime</span><span>
</span><a name="line-454"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621679039542"><a href="#local-6989586621679039542"><span class="hs-identifier">sec</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679039543"><a href="#local-6989586621679039543"><span class="hs-identifier">psec</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="System.Random.html#getTime"><span class="hs-identifier hs-var">getTime</span></a><span>
</span><a name="line-455"></a><span>    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="System.Random.html#createStdGen"><span class="hs-identifier hs-var">createStdGen</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679039542"><span class="hs-identifier hs-var">sec</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-number">12345</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679039543"><span class="hs-identifier hs-var">psec</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679039541"><span class="hs-identifier hs-var">ct</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679039540"><span class="hs-identifier hs-var">o</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-456"></a><span>
</span><a name="line-457"></a><span class="hs-identifier">randomBounded</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="System.Random.html#RandomGen"><span class="hs-identifier hs-type">RandomGen</span></a><span> </span><a href="#local-6989586621679034360"><span class="hs-identifier hs-type">g</span></a><span class="hs-special">,</span><span> </span><a href="System.Random.html#Random"><span class="hs-identifier hs-type">Random</span></a><span> </span><a href="#local-6989586621679034361"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Bounded</span><span> </span><a href="#local-6989586621679034361"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679034360"><span class="hs-identifier hs-type">g</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679034361"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679034360"><span class="hs-identifier hs-type">g</span></a><span class="hs-special">)</span><span>
</span><a name="line-458"></a><a name="randomBounded"><a href="System.Random.html#randomBounded"><span class="hs-identifier">randomBounded</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomR"><span class="hs-identifier hs-var">randomR</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">minBound</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">maxBound</span><span class="hs-special">)</span><span>
</span><a name="line-459"></a><span>
</span><a name="line-460"></a><span class="hs-comment">-- The two integer functions below take an [inclusive,inclusive] range.</span><span>
</span><a name="line-461"></a><span class="hs-identifier">randomIvalIntegral</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="System.Random.html#RandomGen"><span class="hs-identifier hs-type">RandomGen</span></a><span> </span><a href="#local-6989586621679034358"><span class="hs-identifier hs-type">g</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Integral</span><span> </span><a href="#local-6989586621679034359"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679034359"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679034359"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679034358"><span class="hs-identifier hs-type">g</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679034359"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679034358"><span class="hs-identifier hs-type">g</span></a><span class="hs-special">)</span><span>
</span><a name="line-462"></a><a name="randomIvalIntegral"><a href="System.Random.html#randomIvalIntegral"><span class="hs-identifier">randomIvalIntegral</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679039544"><a href="#local-6989586621679039544"><span class="hs-identifier">l</span></a></a><span class="hs-special">,</span><a name="local-6989586621679039545"><a href="#local-6989586621679039545"><span class="hs-identifier">h</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomIvalInteger"><span class="hs-identifier hs-var">randomIvalInteger</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">toInteger</span><span> </span><a href="#local-6989586621679039544"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">toInteger</span><span> </span><a href="#local-6989586621679039545"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span>
</span><a name="line-463"></a><span>
</span><a name="line-464"></a><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="hs-pragma">randomIvalInteger</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Num</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">=&gt;</span><span>
</span><a name="line-465"></a><span>    </span><span class="hs-pragma">(</span><span class="hs-pragma">Integer</span><span class="hs-pragma">,</span><span> </span><span class="hs-pragma">Integer</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">StdGen</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">a</span><span class="hs-pragma">,</span><span> </span><span class="hs-pragma">StdGen</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-466"></a><span>
</span><a name="line-467"></a><span class="hs-identifier">randomIvalInteger</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="System.Random.html#RandomGen"><span class="hs-identifier hs-type">RandomGen</span></a><span> </span><a href="#local-6989586621679034355"><span class="hs-identifier hs-type">g</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679034356"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Integer</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Integer</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679034355"><span class="hs-identifier hs-type">g</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679034356"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679034355"><span class="hs-identifier hs-type">g</span></a><span class="hs-special">)</span><span>
</span><a name="line-468"></a><a name="randomIvalInteger"><a href="System.Random.html#randomIvalInteger"><span class="hs-identifier">randomIvalInteger</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679039546"><a href="#local-6989586621679039546"><span class="hs-identifier">l</span></a></a><span class="hs-special">,</span><a name="local-6989586621679039547"><a href="#local-6989586621679039547"><span class="hs-identifier">h</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679039548"><a href="#local-6989586621679039548"><span class="hs-identifier">rng</span></a></a><span>
</span><a name="line-469"></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679039546"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><a href="#local-6989586621679039547"><span class="hs-identifier hs-var">h</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomIvalInteger"><span class="hs-identifier hs-var">randomIvalInteger</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679039547"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">,</span><a href="#local-6989586621679039546"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679039548"><span class="hs-identifier hs-var">rng</span></a><span>
</span><a name="line-470"></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679039555"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-number">1</span><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679039548"><span class="hs-identifier hs-var">rng</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679039562"><a href="#local-6989586621679039562"><span class="hs-identifier">v</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679039563"><a href="#local-6989586621679039563"><span class="hs-identifier">rng'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromInteger</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679039546"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679039562"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">mod</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679039553"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679039563"><span class="hs-identifier hs-var">rng'</span></a><span class="hs-special">)</span><span>
</span><a name="line-471"></a><span>     </span><span class="hs-keyword">where</span><span>
</span><a name="line-472"></a><span>       </span><span class="hs-special">(</span><a name="local-6989586621679039549"><a href="#local-6989586621679039549"><span class="hs-identifier">genlo</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679039550"><a href="#local-6989586621679039550"><span class="hs-identifier">genhi</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#genRange"><span class="hs-identifier hs-var">genRange</span></a><span> </span><a href="#local-6989586621679039548"><span class="hs-identifier hs-var">rng</span></a><span>
</span><a name="line-473"></a><span>       </span><a name="local-6989586621679039551"><a href="#local-6989586621679039551"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621679039550"><span class="hs-identifier hs-var">genhi</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621679039549"><span class="hs-identifier hs-var">genlo</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-474"></a><span>
</span><a name="line-475"></a><span>       </span><span class="hs-comment">-- Probabilities of the most likely and least likely result</span><span>
</span><a name="line-476"></a><span>       </span><span class="hs-comment">-- will differ at most by a factor of (1 +- 1/q).  Assuming the RandomGen</span><span>
</span><a name="line-477"></a><span>       </span><span class="hs-comment">-- is uniform, of course</span><span>
</span><a name="line-478"></a><span>
</span><a name="line-479"></a><span>       </span><span class="hs-comment">-- On average, log q / log b more random values will be generated</span><span>
</span><a name="line-480"></a><span>       </span><span class="hs-comment">-- than the minimum</span><span>
</span><a name="line-481"></a><span>       </span><a name="local-6989586621679039552"><a href="#local-6989586621679039552"><span class="hs-identifier">q</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1000</span><span>
</span><a name="line-482"></a><span>       </span><a name="local-6989586621679039553"><a href="#local-6989586621679039553"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679039547"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679039546"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-483"></a><span>       </span><a name="local-6989586621679039554"><a href="#local-6989586621679039554"><span class="hs-identifier">magtgt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679039553"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679039552"><span class="hs-identifier hs-var">q</span></a><span>
</span><a name="line-484"></a><span>
</span><a name="line-485"></a><span>       </span><span class="hs-comment">-- generate random values until we exceed the target magnitude </span><span>
</span><a name="line-486"></a><span>       </span><a name="local-6989586621679039555"><a href="#local-6989586621679039555"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679039556"><a href="#local-6989586621679039556"><span class="hs-identifier">mag</span></a></a><span> </span><a name="local-6989586621679039557"><a href="#local-6989586621679039557"><span class="hs-identifier">v</span></a></a><span> </span><a name="local-6989586621679039558"><a href="#local-6989586621679039558"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679039556"><span class="hs-identifier hs-var">mag</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><a href="#local-6989586621679039554"><span class="hs-identifier hs-var">magtgt</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679039557"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679039558"><span class="hs-identifier hs-var">g</span></a><span class="hs-special">)</span><span>
</span><a name="line-487"></a><span>                 </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679039561"><span class="hs-identifier hs-var">v'</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">seq</span><span class="hs-special">`</span><a href="#local-6989586621679039555"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679039556"><span class="hs-identifier hs-var">mag</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679039551"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679039561"><span class="hs-identifier hs-var">v'</span></a><span> </span><a href="#local-6989586621679039560"><span class="hs-identifier hs-var">g'</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-488"></a><span>                        </span><span class="hs-special">(</span><a name="local-6989586621679039559"><a href="#local-6989586621679039559"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><a name="local-6989586621679039560"><a href="#local-6989586621679039560"><span class="hs-identifier">g'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#next"><span class="hs-identifier hs-var">next</span></a><span> </span><a href="#local-6989586621679039558"><span class="hs-identifier hs-var">g</span></a><span>
</span><a name="line-489"></a><span>                        </span><a name="local-6989586621679039561"><a href="#local-6989586621679039561"><span class="hs-identifier">v'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679039557"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679039551"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621679039559"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621679039549"><span class="hs-identifier hs-var">genlo</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-490"></a><span>
</span><a name="line-491"></a><span>
</span><a name="line-492"></a><span class="hs-comment">-- The continuous functions on the other hand take an [inclusive,exclusive) range.</span><span>
</span><a name="line-493"></a><span class="hs-identifier">randomFrac</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="System.Random.html#RandomGen"><span class="hs-identifier hs-type">RandomGen</span></a><span> </span><a href="#local-6989586621679034353"><span class="hs-identifier hs-type">g</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Fractional</span><span> </span><a href="#local-6989586621679034354"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679034353"><span class="hs-identifier hs-type">g</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679034354"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679034353"><span class="hs-identifier hs-type">g</span></a><span class="hs-special">)</span><span>
</span><a name="line-494"></a><a name="randomFrac"><a href="System.Random.html#randomFrac"><span class="hs-identifier">randomFrac</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomIvalDouble"><span class="hs-identifier hs-var">randomIvalDouble</span></a><span> </span><span class="hs-special">(</span><span class="hs-number">0</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Double</span><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">realToFrac</span><span>
</span><a name="line-495"></a><span>
</span><a name="line-496"></a><span class="hs-identifier">randomIvalDouble</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="System.Random.html#RandomGen"><span class="hs-identifier hs-type">RandomGen</span></a><span> </span><a href="#local-6989586621679034351"><span class="hs-identifier hs-type">g</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Fractional</span><span> </span><a href="#local-6989586621679034352"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Double</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679034352"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679034351"><span class="hs-identifier hs-type">g</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679034352"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679034351"><span class="hs-identifier hs-type">g</span></a><span class="hs-special">)</span><span>
</span><a name="line-497"></a><a name="randomIvalDouble"><a href="System.Random.html#randomIvalDouble"><span class="hs-identifier">randomIvalDouble</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679039564"><a href="#local-6989586621679039564"><span class="hs-identifier">l</span></a></a><span class="hs-special">,</span><a name="local-6989586621679039565"><a href="#local-6989586621679039565"><span class="hs-identifier">h</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679039566"><a href="#local-6989586621679039566"><span class="hs-identifier">fromDouble</span></a></a><span> </span><a name="local-6989586621679039567"><a href="#local-6989586621679039567"><span class="hs-identifier">rng</span></a></a><span>
</span><a name="line-498"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679039564"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><a href="#local-6989586621679039565"><span class="hs-identifier hs-var">h</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#randomIvalDouble"><span class="hs-identifier hs-var">randomIvalDouble</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679039565"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">,</span><a href="#local-6989586621679039564"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679039566"><span class="hs-identifier hs-var">fromDouble</span></a><span> </span><a href="#local-6989586621679039567"><span class="hs-identifier hs-var">rng</span></a><span>
</span><a name="line-499"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-500"></a><span>       </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="System.Random.html#randomIvalInteger"><span class="hs-identifier hs-var">randomIvalInteger</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">toInteger</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">minBound</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Int32</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">toInteger</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">maxBound</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Int32</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679039567"><span class="hs-identifier hs-var">rng</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-501"></a><span>         </span><span class="hs-special">(</span><a name="local-6989586621679039568"><a href="#local-6989586621679039568"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679039569"><a href="#local-6989586621679039569"><span class="hs-identifier">rng'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-502"></a><span>            </span><span class="hs-keyword">let</span><span>
</span><a name="line-503"></a><span>             </span><a name="local-6989586621679039570"><a href="#local-6989586621679039570"><span class="hs-identifier">scaled_x</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-504"></a><span>                </span><a href="#local-6989586621679039566"><span class="hs-identifier hs-var">fromDouble</span></a><span> </span><span class="hs-special">(</span><span class="hs-number">0.5</span><span class="hs-operator hs-var">*</span><a href="#local-6989586621679039564"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">0.5</span><span class="hs-operator hs-var">*</span><a href="#local-6989586621679039565"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">+</span><span>                   </span><span class="hs-comment">-- previously (l+h)/2, overflowed</span><span>
</span><a name="line-505"></a><span>                </span><a href="#local-6989586621679039566"><span class="hs-identifier hs-var">fromDouble</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-number">0.5</span><span class="hs-operator hs-var">*</span><a href="#local-6989586621679039565"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">0.5</span><span class="hs-operator hs-var">*</span><a href="#local-6989586621679039564"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">/</span><span> </span><span class="hs-special">(</span><span class="hs-number">0.5</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-identifier hs-var">realToFrac</span><span> </span><a href="System.Random.html#int32Count"><span class="hs-identifier hs-var">int32Count</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">*</span><span>  </span><span class="hs-comment">-- avoid overflow</span><span>
</span><a name="line-506"></a><span>                </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679039568"><span class="hs-identifier hs-var">x</span></a><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Int32</span><span class="hs-special">)</span><span>
</span><a name="line-507"></a><span>            </span><span class="hs-keyword">in</span><span>
</span><a name="line-508"></a><span>            </span><span class="hs-special">(</span><a href="#local-6989586621679039570"><span class="hs-identifier hs-var">scaled_x</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679039569"><span class="hs-identifier hs-var">rng'</span></a><span class="hs-special">)</span><span>
</span><a name="line-509"></a><span>
</span><a name="line-510"></a><span class="hs-identifier">int32Count</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Integer</span><span>
</span><a name="line-511"></a><a name="int32Count"><a href="System.Random.html#int32Count"><span class="hs-identifier">int32Count</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">toInteger</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">maxBound</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Int32</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier hs-var">toInteger</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">minBound</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Int32</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">1</span><span>  </span><span class="hs-comment">-- GHC ticket #3982</span><span>
</span><a name="line-512"></a><span>
</span><a name="line-513"></a><span class="hs-identifier">stdRange</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span>
</span><a name="line-514"></a><a name="stdRange"><a href="System.Random.html#stdRange"><span class="hs-identifier">stdRange</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-number">1</span><span class="hs-special">,</span><span> </span><span class="hs-number">2147483562</span><span class="hs-special">)</span><span>
</span><a name="line-515"></a><span>
</span><a name="line-516"></a><span class="hs-identifier">stdNext</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.Random.html#StdGen"><span class="hs-identifier hs-type">StdGen</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">,</span><span> </span><a href="System.Random.html#StdGen"><span class="hs-identifier hs-type">StdGen</span></a><span class="hs-special">)</span><span>
</span><a name="line-517"></a><span class="hs-comment">-- Returns values in the range stdRange</span><span>
</span><a name="line-518"></a><a name="stdNext"><a href="System.Random.html#stdNext"><span class="hs-identifier">stdNext</span></a></a><span> </span><span class="hs-special">(</span><a href="System.Random.html#StdGen"><span class="hs-identifier hs-var">StdGen</span></a><span> </span><a name="local-6989586621679039571"><a href="#local-6989586621679039571"><span class="hs-identifier">s1</span></a></a><span> </span><a name="local-6989586621679039572"><a href="#local-6989586621679039572"><span class="hs-identifier">s2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621679039573"><span class="hs-identifier hs-var">z'</span></a><span class="hs-special">,</span><span> </span><a href="System.Random.html#StdGen"><span class="hs-identifier hs-var">StdGen</span></a><span> </span><a href="#local-6989586621679039577"><span class="hs-identifier hs-var">s1''</span></a><span> </span><a href="#local-6989586621679039580"><span class="hs-identifier hs-var">s2''</span></a><span class="hs-special">)</span><span>
</span><a name="line-519"></a><span>        </span><span class="hs-keyword">where</span><span>   </span><a name="local-6989586621679039573"><a href="#local-6989586621679039573"><span class="hs-identifier">z'</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679039574"><span class="hs-identifier hs-var">z</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679039574"><span class="hs-identifier hs-var">z</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">2147483562</span><span> </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679039574"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-520"></a><span>                </span><a name="local-6989586621679039574"><a href="#local-6989586621679039574"><span class="hs-identifier">z</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679039577"><span class="hs-identifier hs-var">s1''</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679039580"><span class="hs-identifier hs-var">s2''</span></a><span>
</span><a name="line-521"></a><span>
</span><a name="line-522"></a><span>                </span><a name="local-6989586621679039575"><a href="#local-6989586621679039575"><span class="hs-identifier">k</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679039571"><span class="hs-identifier hs-var">s1</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">quot</span><span class="hs-special">`</span><span> </span><span class="hs-number">53668</span><span>
</span><a name="line-523"></a><span>                </span><a name="local-6989586621679039576"><a href="#local-6989586621679039576"><span class="hs-identifier">s1'</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">40014</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679039571"><span class="hs-identifier hs-var">s1</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679039575"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-number">53668</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679039575"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-number">12211</span><span>
</span><a name="line-524"></a><span>                </span><a name="local-6989586621679039577"><a href="#local-6989586621679039577"><span class="hs-identifier">s1''</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679039576"><span class="hs-identifier hs-var">s1'</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679039576"><span class="hs-identifier hs-var">s1'</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">2147483563</span><span> </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679039576"><span class="hs-identifier hs-var">s1'</span></a><span>
</span><a name="line-525"></a><span>
</span><a name="line-526"></a><span>                </span><a name="local-6989586621679039578"><a href="#local-6989586621679039578"><span class="hs-identifier">k'</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679039572"><span class="hs-identifier hs-var">s2</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">quot</span><span class="hs-special">`</span><span> </span><span class="hs-number">52774</span><span>
</span><a name="line-527"></a><span>                </span><a name="local-6989586621679039579"><a href="#local-6989586621679039579"><span class="hs-identifier">s2'</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">40692</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679039572"><span class="hs-identifier hs-var">s2</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679039578"><span class="hs-identifier hs-var">k'</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-number">52774</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679039578"><span class="hs-identifier hs-var">k'</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-number">3791</span><span>
</span><a name="line-528"></a><span>                </span><a name="local-6989586621679039580"><a href="#local-6989586621679039580"><span class="hs-identifier">s2''</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679039579"><span class="hs-identifier hs-var">s2'</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679039579"><span class="hs-identifier hs-var">s2'</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">2147483399</span><span> </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679039579"><span class="hs-identifier hs-var">s2'</span></a><span>
</span><a name="line-529"></a><span>
</span><a name="line-530"></a><span class="hs-identifier">stdSplit</span><span>            </span><span class="hs-glyph">::</span><span> </span><a href="System.Random.html#StdGen"><span class="hs-identifier hs-type">StdGen</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="System.Random.html#StdGen"><span class="hs-identifier hs-type">StdGen</span></a><span class="hs-special">,</span><span> </span><a href="System.Random.html#StdGen"><span class="hs-identifier hs-type">StdGen</span></a><span class="hs-special">)</span><span>
</span><a name="line-531"></a><a name="stdSplit"><a href="System.Random.html#stdSplit"><span class="hs-identifier">stdSplit</span></a></a><span> </span><a name="local-6989586621679039581"><a href="#local-6989586621679039581"><span class="hs-identifier">std</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="System.Random.html#StdGen"><span class="hs-identifier hs-var">StdGen</span></a><span> </span><a name="local-6989586621679039582"><a href="#local-6989586621679039582"><span class="hs-identifier">s1</span></a></a><span> </span><a name="local-6989586621679039583"><a href="#local-6989586621679039583"><span class="hs-identifier">s2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-532"></a><span>                     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679039584"><span class="hs-identifier hs-var">left</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679039585"><span class="hs-identifier hs-var">right</span></a><span class="hs-special">)</span><span>
</span><a name="line-533"></a><span>                       </span><span class="hs-keyword">where</span><span>
</span><a name="line-534"></a><span>                        </span><span class="hs-comment">-- no statistical foundation for this!</span><span>
</span><a name="line-535"></a><span>                        </span><a name="local-6989586621679039584"><a href="#local-6989586621679039584"><span class="hs-identifier">left</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#StdGen"><span class="hs-identifier hs-var">StdGen</span></a><span> </span><a href="#local-6989586621679039586"><span class="hs-identifier hs-var">new_s1</span></a><span> </span><a href="#local-6989586621679039589"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-536"></a><span>                        </span><a name="local-6989586621679039585"><a href="#local-6989586621679039585"><span class="hs-identifier">right</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="System.Random.html#StdGen"><span class="hs-identifier hs-var">StdGen</span></a><span> </span><a href="#local-6989586621679039588"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621679039587"><span class="hs-identifier hs-var">new_s2</span></a><span>
</span><a name="line-537"></a><span>
</span><a name="line-538"></a><span>                        </span><a name="local-6989586621679039586"><a href="#local-6989586621679039586"><span class="hs-identifier">new_s1</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679039582"><span class="hs-identifier hs-var">s1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">2147483562</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-539"></a><span>                               </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679039582"><span class="hs-identifier hs-var">s1</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-540"></a><span>
</span><a name="line-541"></a><span>                        </span><a name="local-6989586621679039587"><a href="#local-6989586621679039587"><span class="hs-identifier">new_s2</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679039583"><span class="hs-identifier hs-var">s2</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">1</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">2147483398</span><span>
</span><a name="line-542"></a><span>                               </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679039583"><span class="hs-identifier hs-var">s2</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-543"></a><span>
</span><a name="line-544"></a><span>                        </span><a href="System.Random.html#StdGen"><span class="hs-identifier hs-var">StdGen</span></a><span> </span><a name="local-6989586621679039588"><a href="#local-6989586621679039588"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679039589"><a href="#local-6989586621679039589"><span class="hs-identifier">t2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><span class="hs-special">(</span><a href="System.Random.html#next"><span class="hs-identifier hs-var">next</span></a><span> </span><a href="#local-6989586621679039581"><span class="hs-identifier hs-var">std</span></a><span class="hs-special">)</span><span>
</span><a name="line-545"></a><span>
</span><a name="line-546"></a><span class="hs-comment">-- The global random number generator</span><span>
</span><a name="line-547"></a><span>
</span><a name="line-548"></a><span class="hs-comment">{- $globalrng #globalrng#

There is a single, implicit, global random number generator of type
'StdGen', held in some global variable maintained by the 'IO' monad. It is
initialised automatically in some system-dependent fashion, for example, by
using the time of day, or Linux's kernel random number generator. To get
deterministic behaviour, use 'setStdGen'.
-}</span><span>
</span><a name="line-556"></a><span>
</span><a name="line-557"></a><span class="hs-comment">-- |Sets the global random number generator.</span><span>
</span><a name="line-558"></a><span class="hs-identifier">setStdGen</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.Random.html#StdGen"><span class="hs-identifier hs-type">StdGen</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-559"></a><a name="setStdGen"><a href="System.Random.html#setStdGen"><span class="hs-identifier">setStdGen</span></a></a><span> </span><a name="local-6989586621679039605"><a href="#local-6989586621679039605"><span class="hs-identifier">sgen</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">writeIORef</span><span> </span><a href="System.Random.html#theStdGen"><span class="hs-identifier hs-var">theStdGen</span></a><span> </span><a href="#local-6989586621679039605"><span class="hs-identifier hs-var">sgen</span></a><span>
</span><a name="line-560"></a><span>
</span><a name="line-561"></a><span class="hs-comment">-- |Gets the global random number generator.</span><span>
</span><a name="line-562"></a><span class="hs-identifier">getStdGen</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="System.Random.html#StdGen"><span class="hs-identifier hs-type">StdGen</span></a><span>
</span><a name="line-563"></a><a name="getStdGen"><a href="System.Random.html#getStdGen"><span class="hs-identifier">getStdGen</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">readIORef</span><span> </span><a href="System.Random.html#theStdGen"><span class="hs-identifier hs-var">theStdGen</span></a><span>
</span><a name="line-564"></a><span>
</span><a name="line-565"></a><span class="hs-identifier">theStdGen</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">IORef</span><span> </span><a href="System.Random.html#StdGen"><span class="hs-identifier hs-type">StdGen</span></a><span>
</span><a name="line-566"></a><a name="theStdGen"><a href="System.Random.html#theStdGen"><span class="hs-identifier">theStdGen</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">unsafePerformIO</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-567"></a><span>   </span><a name="local-6989586621679039625"><a href="#local-6989586621679039625"><span class="hs-identifier">rng</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="System.Random.html#mkStdRNG"><span class="hs-identifier hs-var">mkStdRNG</span></a><span> </span><span class="hs-number">0</span><span>
</span><a name="line-568"></a><span>   </span><span class="hs-identifier hs-var">newIORef</span><span> </span><a href="#local-6989586621679039625"><span class="hs-identifier hs-var">rng</span></a><span>
</span><a name="line-569"></a><span>
</span><a name="line-570"></a><span class="hs-comment">-- |Applies 'split' to the current global random generator,</span><span>
</span><a name="line-571"></a><span class="hs-comment">-- updates it with one of the results, and returns the other.</span><span>
</span><a name="line-572"></a><span class="hs-identifier">newStdGen</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="System.Random.html#StdGen"><span class="hs-identifier hs-type">StdGen</span></a><span>
</span><a name="line-573"></a><a name="newStdGen"><a href="System.Random.html#newStdGen"><span class="hs-identifier">newStdGen</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">atomicModifyIORef'</span><span> </span><a href="System.Random.html#theStdGen"><span class="hs-identifier hs-var">theStdGen</span></a><span> </span><a href="System.Random.html#split"><span class="hs-identifier hs-var">split</span></a><span>
</span><a name="line-574"></a><span>
</span><a name="line-575"></a><span class="hs-comment">{- |Uses the supplied function to get a value from the current global
random generator, and updates the global generator with the new generator
returned by the function. For example, @rollDice@ gets a random integer
between 1 and 6:

&gt;  rollDice :: IO Int
&gt;  rollDice = getStdRandom (randomR (1,6))

-}</span><span>
</span><a name="line-584"></a><span>
</span><a name="line-585"></a><span class="hs-identifier">getStdRandom</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="System.Random.html#StdGen"><span class="hs-identifier hs-type">StdGen</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679034310"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><a href="System.Random.html#StdGen"><span class="hs-identifier hs-type">StdGen</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="#local-6989586621679034310"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-586"></a><a name="getStdRandom"><a href="System.Random.html#getStdRandom"><span class="hs-identifier">getStdRandom</span></a></a><span> </span><a name="local-6989586621679039626"><a href="#local-6989586621679039626"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">atomicModifyIORef'</span><span> </span><a href="System.Random.html#theStdGen"><span class="hs-identifier hs-var">theStdGen</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679039627"><span class="hs-identifier hs-var">swap</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679039626"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-587"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679039627"><a href="#local-6989586621679039627"><span class="hs-identifier">swap</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679039628"><a href="#local-6989586621679039628"><span class="hs-identifier">v</span></a></a><span class="hs-special">,</span><a name="local-6989586621679039629"><a href="#local-6989586621679039629"><span class="hs-identifier">g</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679039629"><span class="hs-identifier hs-var">g</span></a><span class="hs-special">,</span><a href="#local-6989586621679039628"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span>
</span><a name="line-588"></a><span>
</span><a name="line-589"></a><span class="hs-comment">{- $references

1. FW #Burton# Burton and RL Page, /Distributed random number generation/,
Journal of Functional Programming, 2(2):203-212, April 1992.

2. SK #Park# Park, and KW Miller, /Random number generators -
good ones are hard to find/, Comm ACM 31(10), Oct 1988, pp1192-1201.

3. DG #Carta# Carta, /Two fast implementations of the minimal standard
random number generator/, Comm ACM, 33(1), Jan 1990, pp87-88.

4. P #Hellekalek# Hellekalek, /Don\'t trust parallel Monte Carlo/,
Department of Mathematics, University of Salzburg,
&lt;http://random.mat.sbg.ac.at/~peter/pads98.ps&gt;, 1998.

5. Pierre #LEcuyer# L'Ecuyer, /Efficient and portable combined random
number generators/, Comm ACM, 31(6), Jun 1988, pp742-749.

The Web site &lt;http://random.mat.sbg.ac.at/&gt; is a great source of information.

-}</span><span>
</span><a name="line-610"></a></pre></body></html>