<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP                   #-}</span><span>
</span><a name="line-2"></a><span class="hs-pragma">{-# LANGUAGE ConstraintKinds       #-}</span><span>
</span><a name="line-3"></a><span class="hs-pragma">{-# LANGUAGE DataKinds             #-}</span><span>
</span><a name="line-4"></a><span class="hs-pragma">{-# LANGUAGE KindSignatures        #-}</span><span>
</span><a name="line-5"></a><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><a name="line-6"></a><span class="hs-pragma">{-# LANGUAGE PolyKinds             #-}</span><span>
</span><a name="line-7"></a><span class="hs-pragma">{-# LANGUAGE TypeFamilies          #-}</span><span>
</span><a name="line-8"></a><span class="hs-pragma">{-# LANGUAGE TypeOperators         #-}</span><span>
</span><a name="line-9"></a><span class="hs-pragma">{-# LANGUAGE UndecidableInstances  #-}</span><span>
</span><a name="line-10"></a><span>
</span><a name="line-11"></a><span class="hs-comment">{-|
This module collects utilities for manipulating @servant@ API types. The
functionality in this module is for advanced usage.

The code samples in this module use the following type synonym:

&gt; type SampleAPI = &quot;hello&quot; :&gt; Get '[JSON] Int
&gt;             :&lt;|&gt; &quot;bye&quot; :&gt; Capture &quot;name&quot; String :&gt; Post '[JSON, PlainText] Bool

-}</span><span>
</span><a name="line-21"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Servant.API.TypeLevel</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-22"></a><span>    </span><span class="hs-comment">-- $setup</span><span>
</span><a name="line-23"></a><span>    </span><span class="hs-comment">-- * API predicates</span><span>
</span><a name="line-24"></a><span>    </span><a href="Servant.API.TypeLevel.html#Endpoints"><span class="hs-identifier hs-type">Endpoints</span></a><span class="hs-special">,</span><span>
</span><a name="line-25"></a><span>    </span><span class="hs-comment">-- ** Lax inclusion</span><span>
</span><a name="line-26"></a><span>    </span><a href="Servant.API.TypeLevel.html#IsElem%27"><span class="hs-identifier hs-type">IsElem'</span></a><span class="hs-special">,</span><span>
</span><a name="line-27"></a><span>    </span><a href="Servant.API.TypeLevel.html#IsElem"><span class="hs-identifier hs-type">IsElem</span></a><span class="hs-special">,</span><span>
</span><a name="line-28"></a><span>    </span><a href="Servant.API.TypeLevel.html#IsSubAPI"><span class="hs-identifier hs-type">IsSubAPI</span></a><span class="hs-special">,</span><span>
</span><a name="line-29"></a><span>    </span><a href="Servant.API.TypeLevel.html#AllIsElem"><span class="hs-identifier hs-type">AllIsElem</span></a><span class="hs-special">,</span><span>
</span><a name="line-30"></a><span>    </span><span class="hs-comment">-- ** Strict inclusion</span><span>
</span><a name="line-31"></a><span>    </span><a href="Servant.API.TypeLevel.html#IsIn"><span class="hs-identifier hs-type">IsIn</span></a><span class="hs-special">,</span><span>
</span><a name="line-32"></a><span>    </span><a href="Servant.API.TypeLevel.html#IsStrictSubAPI"><span class="hs-identifier hs-type">IsStrictSubAPI</span></a><span class="hs-special">,</span><span>
</span><a name="line-33"></a><span>    </span><a href="Servant.API.TypeLevel.html#AllIsIn"><span class="hs-identifier hs-type">AllIsIn</span></a><span class="hs-special">,</span><span>
</span><a name="line-34"></a><span>    </span><span class="hs-comment">-- * Helpers</span><span>
</span><a name="line-35"></a><span>    </span><span class="hs-comment">-- ** Lists</span><span>
</span><a name="line-36"></a><span>    </span><a href="Servant.API.TypeLevel.html#MapSub"><span class="hs-identifier hs-type">MapSub</span></a><span class="hs-special">,</span><span>
</span><a name="line-37"></a><span>    </span><a href="Servant.API.TypeLevel.html#AppendList"><span class="hs-identifier hs-type">AppendList</span></a><span class="hs-special">,</span><span>
</span><a name="line-38"></a><span>    </span><a href="Servant.API.TypeLevel.html#IsSubList"><span class="hs-identifier hs-type">IsSubList</span></a><span class="hs-special">,</span><span>
</span><a name="line-39"></a><span>    </span><a href="Servant.API.TypeLevel.html#Elem"><span class="hs-identifier hs-type">Elem</span></a><span class="hs-special">,</span><span>
</span><a name="line-40"></a><span>    </span><a href="Servant.API.TypeLevel.html#ElemGo"><span class="hs-identifier hs-type">ElemGo</span></a><span class="hs-special">,</span><span>
</span><a name="line-41"></a><span>    </span><span class="hs-comment">-- ** Logic</span><span>
</span><a name="line-42"></a><span>    </span><a href="Servant.API.TypeLevel.html#Or"><span class="hs-identifier hs-type">Or</span></a><span class="hs-special">,</span><span>
</span><a name="line-43"></a><span>    </span><a href="Servant.API.TypeLevel.html#And"><span class="hs-identifier hs-type">And</span></a><span class="hs-special">,</span><span>
</span><a name="line-44"></a><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-45"></a><span>
</span><a name="line-46"></a><span>
</span><a name="line-47"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">GHC.Exts</span><span>
</span><a name="line-48"></a><span>                 </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Constraint</span><span class="hs-special">)</span><span>
</span><a name="line-49"></a><span class="hs-keyword">import</span><span>           </span><a href="Servant.API.Alternative.html"><span class="hs-identifier">Servant.API.Alternative</span></a><span>
</span><a name="line-50"></a><span>                 </span><span class="hs-special">(</span><span class="hs-keyword">type</span><span> </span><span class="hs-special">(</span><a href="Servant.API.Alternative.html#%3A%3C%7C%3E"><span class="hs-operator hs-type">:&lt;|&gt;</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-51"></a><span class="hs-keyword">import</span><span>           </span><a href="Servant.API.Capture.html"><span class="hs-identifier">Servant.API.Capture</span></a><span>
</span><a name="line-52"></a><span>                 </span><span class="hs-special">(</span><a href="Servant.API.Capture.html#Capture"><span class="hs-identifier hs-type">Capture</span></a><span class="hs-special">,</span><span> </span><a href="Servant.API.Capture.html#CaptureAll"><span class="hs-identifier hs-type">CaptureAll</span></a><span class="hs-special">)</span><span>
</span><a name="line-53"></a><span class="hs-keyword">import</span><span>           </span><a href="Servant.API.Header.html"><span class="hs-identifier">Servant.API.Header</span></a><span>
</span><a name="line-54"></a><span>                 </span><span class="hs-special">(</span><a href="Servant.API.Header.html#Header"><span class="hs-identifier hs-type">Header</span></a><span class="hs-special">)</span><span>
</span><a name="line-55"></a><span class="hs-keyword">import</span><span>           </span><a href="Servant.API.QueryParam.html"><span class="hs-identifier">Servant.API.QueryParam</span></a><span>
</span><a name="line-56"></a><span>                 </span><span class="hs-special">(</span><a href="Servant.API.QueryParam.html#QueryFlag"><span class="hs-identifier hs-type">QueryFlag</span></a><span class="hs-special">,</span><span> </span><a href="Servant.API.QueryParam.html#QueryParam"><span class="hs-identifier hs-type">QueryParam</span></a><span class="hs-special">,</span><span> </span><a href="Servant.API.QueryParam.html#QueryParams"><span class="hs-identifier hs-type">QueryParams</span></a><span class="hs-special">)</span><span>
</span><a name="line-57"></a><span class="hs-keyword">import</span><span>           </span><a href="Servant.API.ReqBody.html"><span class="hs-identifier">Servant.API.ReqBody</span></a><span>
</span><a name="line-58"></a><span>                 </span><span class="hs-special">(</span><a href="Servant.API.ReqBody.html#ReqBody"><span class="hs-identifier hs-type">ReqBody</span></a><span class="hs-special">)</span><span>
</span><a name="line-59"></a><span class="hs-keyword">import</span><span>           </span><a href="Servant.API.Sub.html"><span class="hs-identifier">Servant.API.Sub</span></a><span>
</span><a name="line-60"></a><span>                 </span><span class="hs-special">(</span><span class="hs-keyword">type</span><span> </span><span class="hs-special">(</span><a href="Servant.API.Sub.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-61"></a><span class="hs-keyword">import</span><span>           </span><a href="Servant.API.Verbs.html"><span class="hs-identifier">Servant.API.Verbs</span></a><span>
</span><a name="line-62"></a><span>                 </span><span class="hs-special">(</span><a href="Servant.API.Verbs.html#Verb"><span class="hs-identifier hs-type">Verb</span></a><span class="hs-special">)</span><span>
</span><a name="line-63"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">GHC.TypeLits</span><span>
</span><a name="line-64"></a><span>                 </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ErrorMessage</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">TypeError</span><span class="hs-special">)</span><span>
</span><a name="line-65"></a><span>
</span><a name="line-66"></a><span>
</span><a name="line-67"></a><span>
</span><a name="line-68"></a><span class="hs-comment">-- * API predicates</span><span>
</span><a name="line-69"></a><span>
</span><a name="line-70"></a><span class="hs-comment">-- | Flatten API into a list of endpoints.</span><span>
</span><a name="line-71"></a><span class="hs-comment">--</span><span>
</span><a name="line-72"></a><span class="hs-comment">-- &gt;&gt;&gt; Refl :: Endpoints SampleAPI :~: '[&quot;hello&quot; :&gt; Verb 'GET 200 '[JSON] Int, &quot;bye&quot; :&gt; (Capture &quot;name&quot; String :&gt; Verb 'POST 200 '[JSON, PlainText] Bool)]</span><span>
</span><a name="line-73"></a><span class="hs-comment">-- Refl</span><span>
</span><a name="line-74"></a><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><a name="Endpoints"><a href="Servant.API.TypeLevel.html#Endpoints"><span class="hs-identifier">Endpoints</span></a></a><span> </span><a name="local-6989586621679106131"><a href="#local-6989586621679106131"><span class="hs-identifier">api</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-75"></a><span>  </span><span class="hs-identifier">Endpoints</span><span> </span><span class="hs-special">(</span><a href="Servant.API.Alternative.html#%3A%3C%7C%3E"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="Servant.API.Alternative.html#%3A%3C%7C%3E"><span class="hs-operator hs-type">:&lt;|&gt;</span></a><span> </span><a href="#local-6989586621679106133"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Servant.API.TypeLevel.html#AppendList"><span class="hs-identifier hs-type">AppendList</span></a><span> </span><span class="hs-special">(</span><a href="Servant.API.TypeLevel.html#Endpoints"><span class="hs-identifier hs-type">Endpoints</span></a><span> </span><a href="#local-6989586621679106132"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Servant.API.TypeLevel.html#Endpoints"><span class="hs-identifier hs-type">Endpoints</span></a><span> </span><a href="#local-6989586621679106133"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-76"></a><span>  </span><span class="hs-identifier">Endpoints</span><span> </span><span class="hs-special">(</span><a href="Servant.API.Sub.html#%3A%3E"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="Servant.API.Sub.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a><span> </span><a href="#local-6989586621679106135"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Servant.API.TypeLevel.html#MapSub"><span class="hs-identifier hs-type">MapSub</span></a><span> </span><a href="#local-6989586621679106134"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">(</span><a href="Servant.API.TypeLevel.html#Endpoints"><span class="hs-identifier hs-type">Endpoints</span></a><span> </span><a href="#local-6989586621679106135"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-77"></a><span>  </span><span class="hs-identifier">Endpoints</span><span> </span><a href="#local-6989586621679106136"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><a href="#local-6989586621679106136"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-78"></a><span>
</span><a name="line-79"></a><span class="hs-comment">-- ** Lax inclusion</span><span>
</span><a name="line-80"></a><span>
</span><a name="line-81"></a><span class="hs-comment">-- | You may use this type family to tell the type checker that your custom</span><span>
</span><a name="line-82"></a><span class="hs-comment">-- type may be skipped as part of a link. This is useful for things like</span><span>
</span><a name="line-83"></a><span class="hs-comment">-- @'QueryParam'@ that are optional in a URI and do not affect them if they are</span><span>
</span><a name="line-84"></a><span class="hs-comment">-- omitted.</span><span>
</span><a name="line-85"></a><span class="hs-comment">--</span><span>
</span><a name="line-86"></a><span class="hs-comment">-- &gt;&gt;&gt; data CustomThing</span><span>
</span><a name="line-87"></a><span class="hs-comment">-- &gt;&gt;&gt; type instance IsElem' e (CustomThing :&gt; s) = IsElem e s</span><span>
</span><a name="line-88"></a><span class="hs-comment">--</span><span>
</span><a name="line-89"></a><span class="hs-comment">-- Note that @'IsElem'@ is called, which will mutually recurse back to @'IsElem''@</span><span>
</span><a name="line-90"></a><span class="hs-comment">-- if it exhausts all other options again.</span><span>
</span><a name="line-91"></a><span class="hs-comment">--</span><span>
</span><a name="line-92"></a><span class="hs-comment">-- Once you have written a @HasLink@ instance for @CustomThing@ you are ready to go.</span><span>
</span><a name="line-93"></a><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><a name="IsElem%27"><a href="Servant.API.TypeLevel.html#IsElem%27"><span class="hs-identifier">IsElem'</span></a></a><span> </span><a name="local-6989586621679106129"><a href="#local-6989586621679106129"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679106130"><a href="#local-6989586621679106130"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Constraint</span><span>
</span><a name="line-94"></a><span>
</span><a name="line-95"></a><span class="hs-comment">-- | Closed type family, check if @endpoint@ is within @api@.</span><span>
</span><a name="line-96"></a><span class="hs-comment">-- Uses @'IsElem''@ if it exhausts all other options.</span><span>
</span><a name="line-97"></a><span class="hs-comment">--</span><span>
</span><a name="line-98"></a><span class="hs-comment">-- &gt;&gt;&gt; ok (Proxy :: Proxy (IsElem (&quot;hello&quot; :&gt; Get '[JSON] Int) SampleAPI))</span><span>
</span><a name="line-99"></a><span class="hs-comment">-- OK</span><span>
</span><a name="line-100"></a><span class="hs-comment">--</span><span>
</span><a name="line-101"></a><span class="hs-comment">-- &gt;&gt;&gt; ok (Proxy :: Proxy (IsElem (&quot;bye&quot; :&gt; Get '[JSON] Int) SampleAPI))</span><span>
</span><a name="line-102"></a><span class="hs-comment">-- ...</span><span>
</span><a name="line-103"></a><span class="hs-comment">-- ... Could not deduce...</span><span>
</span><a name="line-104"></a><span class="hs-comment">-- ...</span><span>
</span><a name="line-105"></a><span class="hs-comment">--</span><span>
</span><a name="line-106"></a><span class="hs-comment">-- An endpoint is considered within an api even if it is missing combinators</span><span>
</span><a name="line-107"></a><span class="hs-comment">-- that don't affect the URL:</span><span>
</span><a name="line-108"></a><span class="hs-comment">--</span><span>
</span><a name="line-109"></a><span class="hs-comment">-- &gt;&gt;&gt; ok (Proxy :: Proxy (IsElem (Get '[JSON] Int) (Header &quot;h&quot; Bool :&gt; Get '[JSON] Int)))</span><span>
</span><a name="line-110"></a><span class="hs-comment">-- OK</span><span>
</span><a name="line-111"></a><span class="hs-comment">--</span><span>
</span><a name="line-112"></a><span class="hs-comment">-- &gt;&gt;&gt; ok (Proxy :: Proxy (IsElem (Get '[JSON] Int) (ReqBody '[JSON] Bool :&gt; Get '[JSON] Int)))</span><span>
</span><a name="line-113"></a><span class="hs-comment">-- OK</span><span>
</span><a name="line-114"></a><span class="hs-comment">--</span><span>
</span><a name="line-115"></a><span class="hs-comment">-- *N.B.:* @IsElem a b@ can be seen as capturing the notion of whether the URL</span><span>
</span><a name="line-116"></a><span class="hs-comment">-- represented by @a@ would match the URL represented by @b@, *not* whether a</span><span>
</span><a name="line-117"></a><span class="hs-comment">-- request represented by @a@ matches the endpoints serving @b@ (for the</span><span>
</span><a name="line-118"></a><span class="hs-comment">-- latter, use 'IsIn').</span><span>
</span><a name="line-119"></a><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><a name="IsElem"><a href="Servant.API.TypeLevel.html#IsElem"><span class="hs-identifier">IsElem</span></a></a><span> </span><a name="local-6989586621679106084"><a href="#local-6989586621679106084"><span class="hs-identifier">endpoint</span></a></a><span> </span><a name="local-6989586621679106085"><a href="#local-6989586621679106085"><span class="hs-identifier">api</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Constraint</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-120"></a><span>  </span><span class="hs-identifier">IsElem</span><span> </span><a href="#local-6989586621679106086"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">(</span><a href="Servant.API.Alternative.html#%3A%3C%7C%3E"><span class="hs-identifier hs-type">sa</span></a><span> </span><a href="Servant.API.Alternative.html#%3A%3C%7C%3E"><span class="hs-operator hs-type">:&lt;|&gt;</span></a><span> </span><a href="#local-6989586621679106088"><span class="hs-identifier hs-type">sb</span></a><span class="hs-special">)</span><span>                   </span><span class="hs-glyph">=</span><span> </span><a href="Servant.API.TypeLevel.html#Or"><span class="hs-identifier hs-type">Or</span></a><span> </span><span class="hs-special">(</span><a href="Servant.API.TypeLevel.html#IsElem"><span class="hs-identifier hs-type">IsElem</span></a><span> </span><a href="#local-6989586621679106086"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-6989586621679106087"><span class="hs-identifier hs-type">sa</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Servant.API.TypeLevel.html#IsElem"><span class="hs-identifier hs-type">IsElem</span></a><span> </span><a href="#local-6989586621679106086"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-6989586621679106088"><span class="hs-identifier hs-type">sb</span></a><span class="hs-special">)</span><span>
</span><a name="line-121"></a><span>  </span><span class="hs-identifier">IsElem</span><span> </span><span class="hs-special">(</span><a href="Servant.API.Sub.html#%3A%3E"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="Servant.API.Sub.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a><span> </span><a href="#local-6989586621679106090"><span class="hs-identifier hs-type">sa</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Servant.API.Sub.html#%3A%3E"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="Servant.API.Sub.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a><span> </span><a href="#local-6989586621679106091"><span class="hs-identifier hs-type">sb</span></a><span class="hs-special">)</span><span>              </span><span class="hs-glyph">=</span><span> </span><a href="Servant.API.TypeLevel.html#IsElem"><span class="hs-identifier hs-type">IsElem</span></a><span> </span><a href="#local-6989586621679106090"><span class="hs-identifier hs-type">sa</span></a><span> </span><a href="#local-6989586621679106091"><span class="hs-identifier hs-type">sb</span></a><span>
</span><a name="line-122"></a><span>  </span><span class="hs-identifier">IsElem</span><span> </span><a href="#local-6989586621679106092"><span class="hs-identifier hs-type">sa</span></a><span> </span><span class="hs-special">(</span><a href="Servant.API.Sub.html#%3A%3E"><span class="hs-identifier hs-type">Header</span></a><span> </span><a href="#local-6989586621679106093"><span class="hs-identifier hs-type">sym</span></a><span> </span><a href="#local-6989586621679106094"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-operator">:&gt;</span><span> </span><a href="#local-6989586621679106095"><span class="hs-identifier hs-type">sb</span></a><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><a href="Servant.API.TypeLevel.html#IsElem"><span class="hs-identifier hs-type">IsElem</span></a><span> </span><a href="#local-6989586621679106092"><span class="hs-identifier hs-type">sa</span></a><span> </span><a href="#local-6989586621679106095"><span class="hs-identifier hs-type">sb</span></a><span>
</span><a name="line-123"></a><span>  </span><span class="hs-identifier">IsElem</span><span> </span><a href="#local-6989586621679106096"><span class="hs-identifier hs-type">sa</span></a><span> </span><span class="hs-special">(</span><a href="Servant.API.Sub.html#%3A%3E"><span class="hs-identifier hs-type">ReqBody</span></a><span> </span><a href="#local-6989586621679106097"><span class="hs-identifier hs-type">y</span></a><span> </span><a href="#local-6989586621679106098"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-operator">:&gt;</span><span> </span><a href="#local-6989586621679106099"><span class="hs-identifier hs-type">sb</span></a><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><a href="Servant.API.TypeLevel.html#IsElem"><span class="hs-identifier hs-type">IsElem</span></a><span> </span><a href="#local-6989586621679106096"><span class="hs-identifier hs-type">sa</span></a><span> </span><a href="#local-6989586621679106099"><span class="hs-identifier hs-type">sb</span></a><span>
</span><a name="line-124"></a><span>  </span><span class="hs-identifier">IsElem</span><span> </span><span class="hs-special">(</span><a href="Servant.API.Sub.html#%3A%3E"><span class="hs-identifier hs-type">CaptureAll</span></a><span> </span><a href="#local-6989586621679106100"><span class="hs-identifier hs-type">z</span></a><span> </span><a href="#local-6989586621679106101"><span class="hs-identifier hs-type">y</span></a><span> </span><span class="hs-operator">:&gt;</span><span> </span><a href="#local-6989586621679106102"><span class="hs-identifier hs-type">sa</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Servant.API.Sub.html#%3A%3E"><span class="hs-identifier hs-type">CaptureAll</span></a><span> </span><a href="#local-6989586621679106103"><span class="hs-identifier hs-type">x</span></a><span> </span><a href="#local-6989586621679106101"><span class="hs-identifier hs-type">y</span></a><span> </span><span class="hs-operator">:&gt;</span><span> </span><a href="#local-6989586621679106104"><span class="hs-identifier hs-type">sb</span></a><span class="hs-special">)</span><span>
</span><a name="line-125"></a><span>                                          </span><span class="hs-glyph">=</span><span> </span><a href="Servant.API.TypeLevel.html#IsElem"><span class="hs-identifier hs-type">IsElem</span></a><span> </span><a href="#local-6989586621679106102"><span class="hs-identifier hs-type">sa</span></a><span> </span><a href="#local-6989586621679106104"><span class="hs-identifier hs-type">sb</span></a><span>
</span><a name="line-126"></a><span>  </span><span class="hs-identifier">IsElem</span><span> </span><span class="hs-special">(</span><a href="Servant.API.Sub.html#%3A%3E"><span class="hs-identifier hs-type">Capture</span></a><span> </span><a href="#local-6989586621679106105"><span class="hs-identifier hs-type">z</span></a><span> </span><a href="#local-6989586621679106106"><span class="hs-identifier hs-type">y</span></a><span> </span><span class="hs-operator">:&gt;</span><span> </span><a href="#local-6989586621679106107"><span class="hs-identifier hs-type">sa</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Servant.API.Sub.html#%3A%3E"><span class="hs-identifier hs-type">Capture</span></a><span> </span><a href="#local-6989586621679106108"><span class="hs-identifier hs-type">x</span></a><span> </span><a href="#local-6989586621679106106"><span class="hs-identifier hs-type">y</span></a><span> </span><span class="hs-operator">:&gt;</span><span> </span><a href="#local-6989586621679106109"><span class="hs-identifier hs-type">sb</span></a><span class="hs-special">)</span><span>
</span><a name="line-127"></a><span>                                          </span><span class="hs-glyph">=</span><span> </span><a href="Servant.API.TypeLevel.html#IsElem"><span class="hs-identifier hs-type">IsElem</span></a><span> </span><a href="#local-6989586621679106107"><span class="hs-identifier hs-type">sa</span></a><span> </span><a href="#local-6989586621679106109"><span class="hs-identifier hs-type">sb</span></a><span>
</span><a name="line-128"></a><span>  </span><span class="hs-identifier">IsElem</span><span> </span><a href="#local-6989586621679106110"><span class="hs-identifier hs-type">sa</span></a><span> </span><span class="hs-special">(</span><a href="Servant.API.Sub.html#%3A%3E"><span class="hs-identifier hs-type">QueryParam</span></a><span> </span><a href="#local-6989586621679106111"><span class="hs-identifier hs-type">x</span></a><span> </span><a href="#local-6989586621679106112"><span class="hs-identifier hs-type">y</span></a><span> </span><span class="hs-operator">:&gt;</span><span> </span><a href="#local-6989586621679106113"><span class="hs-identifier hs-type">sb</span></a><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="Servant.API.TypeLevel.html#IsElem"><span class="hs-identifier hs-type">IsElem</span></a><span> </span><a href="#local-6989586621679106110"><span class="hs-identifier hs-type">sa</span></a><span> </span><a href="#local-6989586621679106113"><span class="hs-identifier hs-type">sb</span></a><span>
</span><a name="line-129"></a><span>  </span><span class="hs-identifier">IsElem</span><span> </span><a href="#local-6989586621679106114"><span class="hs-identifier hs-type">sa</span></a><span> </span><span class="hs-special">(</span><a href="Servant.API.Sub.html#%3A%3E"><span class="hs-identifier hs-type">QueryParams</span></a><span> </span><a href="#local-6989586621679106115"><span class="hs-identifier hs-type">x</span></a><span> </span><a href="#local-6989586621679106116"><span class="hs-identifier hs-type">y</span></a><span> </span><span class="hs-operator">:&gt;</span><span> </span><a href="#local-6989586621679106117"><span class="hs-identifier hs-type">sb</span></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="Servant.API.TypeLevel.html#IsElem"><span class="hs-identifier hs-type">IsElem</span></a><span> </span><a href="#local-6989586621679106114"><span class="hs-identifier hs-type">sa</span></a><span> </span><a href="#local-6989586621679106117"><span class="hs-identifier hs-type">sb</span></a><span>
</span><a name="line-130"></a><span>  </span><span class="hs-identifier">IsElem</span><span> </span><a href="#local-6989586621679106118"><span class="hs-identifier hs-type">sa</span></a><span> </span><span class="hs-special">(</span><a href="Servant.API.Sub.html#%3A%3E"><span class="hs-identifier hs-type">QueryFlag</span></a><span> </span><a href="#local-6989586621679106119"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-operator">:&gt;</span><span> </span><a href="#local-6989586621679106120"><span class="hs-identifier hs-type">sb</span></a><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><a href="Servant.API.TypeLevel.html#IsElem"><span class="hs-identifier hs-type">IsElem</span></a><span> </span><a href="#local-6989586621679106118"><span class="hs-identifier hs-type">sa</span></a><span> </span><a href="#local-6989586621679106120"><span class="hs-identifier hs-type">sb</span></a><span>
</span><a name="line-131"></a><span>  </span><span class="hs-identifier">IsElem</span><span> </span><span class="hs-special">(</span><a href="Servant.API.Verbs.html#Verb"><span class="hs-identifier hs-type">Verb</span></a><span> </span><a href="#local-6989586621679106121"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679106122"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679106123"><span class="hs-identifier hs-type">ct</span></a><span> </span><a href="#local-6989586621679106124"><span class="hs-identifier hs-type">typ</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Servant.API.Verbs.html#Verb"><span class="hs-identifier hs-type">Verb</span></a><span> </span><a href="#local-6989586621679106121"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679106122"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679106125"><span class="hs-identifier hs-type">ct'</span></a><span> </span><a href="#local-6989586621679106124"><span class="hs-identifier hs-type">typ</span></a><span class="hs-special">)</span><span>
</span><a name="line-132"></a><span>                                          </span><span class="hs-glyph">=</span><span> </span><a href="Servant.API.TypeLevel.html#IsSubList"><span class="hs-identifier hs-type">IsSubList</span></a><span> </span><a href="#local-6989586621679106123"><span class="hs-identifier hs-type">ct</span></a><span> </span><a href="#local-6989586621679106125"><span class="hs-identifier hs-type">ct'</span></a><span>
</span><a name="line-133"></a><span>  </span><span class="hs-identifier">IsElem</span><span> </span><a href="#local-6989586621679106126"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-6989586621679106126"><span class="hs-identifier hs-type">e</span></a><span>                              </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-134"></a><span>  </span><span class="hs-identifier">IsElem</span><span> </span><a href="#local-6989586621679106127"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-6989586621679106128"><span class="hs-identifier hs-type">a</span></a><span>                              </span><span class="hs-glyph">=</span><span> </span><a href="Servant.API.TypeLevel.html#IsElem%27"><span class="hs-identifier hs-type">IsElem'</span></a><span> </span><a href="#local-6989586621679106127"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-6989586621679106128"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-135"></a><span>
</span><a name="line-136"></a><span class="hs-comment">-- | Check whether @sub@ is a sub-API of @api@.</span><span>
</span><a name="line-137"></a><span class="hs-comment">--</span><span>
</span><a name="line-138"></a><span class="hs-comment">-- &gt;&gt;&gt; ok (Proxy :: Proxy (IsSubAPI SampleAPI (SampleAPI :&lt;|&gt; Get '[JSON] Int)))</span><span>
</span><a name="line-139"></a><span class="hs-comment">-- OK</span><span>
</span><a name="line-140"></a><span class="hs-comment">--</span><span>
</span><a name="line-141"></a><span class="hs-comment">-- &gt;&gt;&gt; ok (Proxy :: Proxy (IsSubAPI (SampleAPI :&lt;|&gt; Get '[JSON] Int) SampleAPI))</span><span>
</span><a name="line-142"></a><span class="hs-comment">-- ...</span><span>
</span><a name="line-143"></a><span class="hs-comment">-- ... Could not deduce...</span><span>
</span><a name="line-144"></a><span class="hs-comment">-- ...</span><span>
</span><a name="line-145"></a><span class="hs-comment">--</span><span>
</span><a name="line-146"></a><span class="hs-comment">-- This uses @IsElem@ for checking; thus the note there applies here.</span><span>
</span><a name="line-147"></a><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><a name="IsSubAPI"><a href="Servant.API.TypeLevel.html#IsSubAPI"><span class="hs-identifier">IsSubAPI</span></a></a><span> </span><a name="local-6989586621679106080"><a href="#local-6989586621679106080"><span class="hs-identifier">sub</span></a></a><span> </span><a name="local-6989586621679106081"><a href="#local-6989586621679106081"><span class="hs-identifier">api</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Constraint</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-148"></a><span>  </span><span class="hs-identifier">IsSubAPI</span><span> </span><a href="#local-6989586621679106082"><span class="hs-identifier hs-type">sub</span></a><span> </span><a href="#local-6989586621679106083"><span class="hs-identifier hs-type">api</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Servant.API.TypeLevel.html#AllIsElem"><span class="hs-identifier hs-type">AllIsElem</span></a><span> </span><span class="hs-special">(</span><a href="Servant.API.TypeLevel.html#Endpoints"><span class="hs-identifier hs-type">Endpoints</span></a><span> </span><a href="#local-6989586621679106082"><span class="hs-identifier hs-type">sub</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679106083"><span class="hs-identifier hs-type">api</span></a><span>
</span><a name="line-149"></a><span>
</span><a name="line-150"></a><span class="hs-comment">-- | Check that every element of @xs@ is an endpoint of @api@ (using @'IsElem'@).</span><span>
</span><a name="line-151"></a><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><a name="AllIsElem"><a href="Servant.API.TypeLevel.html#AllIsElem"><span class="hs-identifier">AllIsElem</span></a></a><span> </span><a name="local-6989586621679106074"><a href="#local-6989586621679106074"><span class="hs-identifier">xs</span></a></a><span> </span><a name="local-6989586621679106075"><a href="#local-6989586621679106075"><span class="hs-identifier">api</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Constraint</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-152"></a><span>  </span><span class="hs-identifier">AllIsElem</span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679106076"><span class="hs-identifier hs-type">api</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-153"></a><span>  </span><span class="hs-identifier">AllIsElem</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">x</span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679106078"><span class="hs-identifier hs-type">xs</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679106079"><span class="hs-identifier hs-type">api</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Servant.API.TypeLevel.html#IsElem"><span class="hs-identifier hs-type">IsElem</span></a><span> </span><a href="#local-6989586621679106077"><span class="hs-identifier hs-type">x</span></a><span> </span><a href="#local-6989586621679106079"><span class="hs-identifier hs-type">api</span></a><span class="hs-special">,</span><span> </span><a href="Servant.API.TypeLevel.html#AllIsElem"><span class="hs-identifier hs-type">AllIsElem</span></a><span> </span><a href="#local-6989586621679106078"><span class="hs-identifier hs-type">xs</span></a><span> </span><a href="#local-6989586621679106079"><span class="hs-identifier hs-type">api</span></a><span class="hs-special">)</span><span>
</span><a name="line-154"></a><span>
</span><a name="line-155"></a><span class="hs-comment">-- ** Strict inclusion</span><span>
</span><a name="line-156"></a><span>
</span><a name="line-157"></a><span class="hs-comment">-- | Closed type family, check if @endpoint@ is exactly within @api@.</span><span>
</span><a name="line-158"></a><span class="hs-comment">--</span><span>
</span><a name="line-159"></a><span class="hs-comment">-- &gt;&gt;&gt; ok (Proxy :: Proxy (IsIn (&quot;hello&quot; :&gt; Get '[JSON] Int) SampleAPI))</span><span>
</span><a name="line-160"></a><span class="hs-comment">-- OK</span><span>
</span><a name="line-161"></a><span class="hs-comment">--</span><span>
</span><a name="line-162"></a><span class="hs-comment">-- Unlike 'IsElem', this requires an *exact* match.</span><span>
</span><a name="line-163"></a><span class="hs-comment">--</span><span>
</span><a name="line-164"></a><span class="hs-comment">-- &gt;&gt;&gt; ok (Proxy :: Proxy (IsIn (Get '[JSON] Int) (Header &quot;h&quot; Bool :&gt; Get '[JSON] Int)))</span><span>
</span><a name="line-165"></a><span class="hs-comment">-- ...</span><span>
</span><a name="line-166"></a><span class="hs-comment">-- ... Could not deduce...</span><span>
</span><a name="line-167"></a><span class="hs-comment">-- ...</span><span>
</span><a name="line-168"></a><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><a name="IsIn"><a href="Servant.API.TypeLevel.html#IsIn"><span class="hs-identifier">IsIn</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679106065"><a href="#local-6989586621679106065"><span class="hs-identifier">endpoint</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-operator">*</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679106066"><a href="#local-6989586621679106066"><span class="hs-identifier">api</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-operator">*</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Constraint</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-169"></a><span>  </span><span class="hs-identifier">IsIn</span><span> </span><a href="#local-6989586621679106067"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">(</span><a href="Servant.API.Alternative.html#%3A%3C%7C%3E"><span class="hs-identifier hs-type">sa</span></a><span> </span><a href="Servant.API.Alternative.html#%3A%3C%7C%3E"><span class="hs-operator hs-type">:&lt;|&gt;</span></a><span> </span><a href="#local-6989586621679106069"><span class="hs-identifier hs-type">sb</span></a><span class="hs-special">)</span><span>                </span><span class="hs-glyph">=</span><span> </span><a href="Servant.API.TypeLevel.html#Or"><span class="hs-identifier hs-type">Or</span></a><span> </span><span class="hs-special">(</span><a href="Servant.API.TypeLevel.html#IsIn"><span class="hs-identifier hs-type">IsIn</span></a><span> </span><a href="#local-6989586621679106067"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-6989586621679106068"><span class="hs-identifier hs-type">sa</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Servant.API.TypeLevel.html#IsIn"><span class="hs-identifier hs-type">IsIn</span></a><span> </span><a href="#local-6989586621679106067"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-6989586621679106069"><span class="hs-identifier hs-type">sb</span></a><span class="hs-special">)</span><span>
</span><a name="line-170"></a><span>  </span><span class="hs-identifier">IsIn</span><span> </span><span class="hs-special">(</span><a href="Servant.API.Sub.html#%3A%3E"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="Servant.API.Sub.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a><span> </span><a href="#local-6989586621679106071"><span class="hs-identifier hs-type">sa</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Servant.API.Sub.html#%3A%3E"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="Servant.API.Sub.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a><span> </span><a href="#local-6989586621679106072"><span class="hs-identifier hs-type">sb</span></a><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><a href="Servant.API.TypeLevel.html#IsIn"><span class="hs-identifier hs-type">IsIn</span></a><span> </span><a href="#local-6989586621679106071"><span class="hs-identifier hs-type">sa</span></a><span> </span><a href="#local-6989586621679106072"><span class="hs-identifier hs-type">sb</span></a><span>
</span><a name="line-171"></a><span>  </span><span class="hs-identifier">IsIn</span><span> </span><a href="#local-6989586621679106073"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-6989586621679106073"><span class="hs-identifier hs-type">e</span></a><span>                           </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-172"></a><span>
</span><a name="line-173"></a><span class="hs-comment">-- | Check whether @sub@ is a sub API of @api@.</span><span>
</span><a name="line-174"></a><span class="hs-comment">--</span><span>
</span><a name="line-175"></a><span class="hs-comment">-- Like 'IsSubAPI', but uses 'IsIn' rather than 'IsElem'.</span><span>
</span><a name="line-176"></a><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><a name="IsStrictSubAPI"><a href="Servant.API.TypeLevel.html#IsStrictSubAPI"><span class="hs-identifier">IsStrictSubAPI</span></a></a><span> </span><a name="local-6989586621679106061"><a href="#local-6989586621679106061"><span class="hs-identifier">sub</span></a></a><span> </span><a name="local-6989586621679106062"><a href="#local-6989586621679106062"><span class="hs-identifier">api</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Constraint</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-177"></a><span>  </span><span class="hs-identifier">IsStrictSubAPI</span><span> </span><a href="#local-6989586621679106063"><span class="hs-identifier hs-type">sub</span></a><span> </span><a href="#local-6989586621679106064"><span class="hs-identifier hs-type">api</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Servant.API.TypeLevel.html#AllIsIn"><span class="hs-identifier hs-type">AllIsIn</span></a><span> </span><span class="hs-special">(</span><a href="Servant.API.TypeLevel.html#Endpoints"><span class="hs-identifier hs-type">Endpoints</span></a><span> </span><a href="#local-6989586621679106063"><span class="hs-identifier hs-type">sub</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679106064"><span class="hs-identifier hs-type">api</span></a><span>
</span><a name="line-178"></a><span>
</span><a name="line-179"></a><span class="hs-comment">-- | Check that every element of @xs@ is an endpoint of @api@ (using @'IsIn'@).</span><span>
</span><a name="line-180"></a><span class="hs-comment">--</span><span>
</span><a name="line-181"></a><span class="hs-comment">-- ok (Proxy :: Proxy (AllIsIn (Endpoints SampleAPI) SampleAPI))</span><span>
</span><a name="line-182"></a><span class="hs-comment">-- OK</span><span>
</span><a name="line-183"></a><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><a name="AllIsIn"><a href="Servant.API.TypeLevel.html#AllIsIn"><span class="hs-identifier">AllIsIn</span></a></a><span> </span><a name="local-6989586621679106055"><a href="#local-6989586621679106055"><span class="hs-identifier">xs</span></a></a><span> </span><a name="local-6989586621679106056"><a href="#local-6989586621679106056"><span class="hs-identifier">api</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Constraint</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-184"></a><span>  </span><span class="hs-identifier">AllIsIn</span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679106057"><span class="hs-identifier hs-type">api</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-185"></a><span>  </span><span class="hs-identifier">AllIsIn</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">x</span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679106059"><span class="hs-identifier hs-type">xs</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679106060"><span class="hs-identifier hs-type">api</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Servant.API.TypeLevel.html#IsIn"><span class="hs-identifier hs-type">IsIn</span></a><span> </span><a href="#local-6989586621679106058"><span class="hs-identifier hs-type">x</span></a><span> </span><a href="#local-6989586621679106060"><span class="hs-identifier hs-type">api</span></a><span class="hs-special">,</span><span> </span><a href="Servant.API.TypeLevel.html#AllIsIn"><span class="hs-identifier hs-type">AllIsIn</span></a><span> </span><a href="#local-6989586621679106059"><span class="hs-identifier hs-type">xs</span></a><span> </span><a href="#local-6989586621679106060"><span class="hs-identifier hs-type">api</span></a><span class="hs-special">)</span><span>
</span><a name="line-186"></a><span>
</span><a name="line-187"></a><span class="hs-comment">-- * Helpers</span><span>
</span><a name="line-188"></a><span>
</span><a name="line-189"></a><span class="hs-comment">-- ** Lists</span><span>
</span><a name="line-190"></a><span>
</span><a name="line-191"></a><span class="hs-comment">-- | Apply @(e :&gt;)@ to every API in @xs@.</span><span>
</span><a name="line-192"></a><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><a name="MapSub"><a href="Servant.API.TypeLevel.html#MapSub"><span class="hs-identifier">MapSub</span></a></a><span> </span><a name="local-6989586621679106049"><a href="#local-6989586621679106049"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679106050"><a href="#local-6989586621679106050"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-193"></a><span>  </span><span class="hs-identifier">MapSub</span><span> </span><a href="#local-6989586621679106051"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-194"></a><span>  </span><span class="hs-identifier">MapSub</span><span> </span><a href="#local-6989586621679106052"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">x</span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679106054"><span class="hs-identifier hs-type">xs</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Servant.API.Sub.html#%3A%3E"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="Servant.API.Sub.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a><span> </span><a href="#local-6989586621679106053"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><a href="Servant.API.TypeLevel.html#MapSub"><span class="hs-identifier hs-type">MapSub</span></a><span> </span><a href="#local-6989586621679106052"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-6989586621679106054"><span class="hs-identifier hs-type">xs</span></a><span>
</span><a name="line-195"></a><span>
</span><a name="line-196"></a><span class="hs-comment">-- | Append two type-level lists.</span><span>
</span><a name="line-197"></a><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><a name="AppendList"><a href="Servant.API.TypeLevel.html#AppendList"><span class="hs-identifier">AppendList</span></a></a><span> </span><a name="local-6989586621679106043"><a href="#local-6989586621679106043"><span class="hs-identifier">xs</span></a></a><span> </span><a name="local-6989586621679106044"><a href="#local-6989586621679106044"><span class="hs-identifier">ys</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-198"></a><span>  </span><span class="hs-identifier">AppendList</span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span>       </span><a href="#local-6989586621679106045"><span class="hs-identifier hs-type">ys</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679106045"><span class="hs-identifier hs-type">ys</span></a><span>
</span><a name="line-199"></a><span>  </span><span class="hs-identifier">AppendList</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">x</span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679106047"><span class="hs-identifier hs-type">xs</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679106048"><span class="hs-identifier hs-type">ys</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">x</span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><a href="Servant.API.TypeLevel.html#AppendList"><span class="hs-identifier hs-type">AppendList</span></a><span> </span><a href="#local-6989586621679106047"><span class="hs-identifier hs-type">xs</span></a><span> </span><a href="#local-6989586621679106048"><span class="hs-identifier hs-type">ys</span></a><span>
</span><a name="line-200"></a><span>
</span><a name="line-201"></a><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><a name="IsSubList"><a href="Servant.API.TypeLevel.html#IsSubList"><span class="hs-identifier">IsSubList</span></a></a><span> </span><a name="local-6989586621679106037"><a href="#local-6989586621679106037"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679106038"><a href="#local-6989586621679106038"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Constraint</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-202"></a><span>  </span><span class="hs-identifier">IsSubList</span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679106039"><span class="hs-identifier hs-type">b</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-203"></a><span>  </span><span class="hs-identifier">IsSubList</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">x</span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679106041"><span class="hs-identifier hs-type">xs</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679106042"><span class="hs-identifier hs-type">y</span></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Servant.API.TypeLevel.html#And"><span class="hs-identifier hs-type">Elem</span></a><span> </span><a href="#local-6989586621679106040"><span class="hs-identifier hs-type">x</span></a><span> </span><a href="#local-6989586621679106042"><span class="hs-identifier hs-type">y</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier">And</span><span class="hs-special">`</span><span> </span><a href="Servant.API.TypeLevel.html#IsSubList"><span class="hs-identifier hs-type">IsSubList</span></a><span> </span><a href="#local-6989586621679106041"><span class="hs-identifier hs-type">xs</span></a><span> </span><a href="#local-6989586621679106042"><span class="hs-identifier hs-type">y</span></a><span>
</span><a name="line-204"></a><span>
</span><a name="line-205"></a><span class="hs-comment">-- | Check that a value is an element of a list:</span><span>
</span><a name="line-206"></a><span class="hs-comment">--</span><span>
</span><a name="line-207"></a><span class="hs-comment">-- &gt;&gt;&gt; ok (Proxy :: Proxy (Elem Bool '[Int, Bool]))</span><span>
</span><a name="line-208"></a><span class="hs-comment">-- OK</span><span>
</span><a name="line-209"></a><span class="hs-comment">--</span><span>
</span><a name="line-210"></a><span class="hs-comment">-- &gt;&gt;&gt; ok (Proxy :: Proxy (Elem String '[Int, Bool]))</span><span>
</span><a name="line-211"></a><span class="hs-comment">-- ...</span><span>
</span><a name="line-212"></a><span class="hs-comment">-- ... [Char]...'[Int, Bool...</span><span>
</span><a name="line-213"></a><span class="hs-comment">-- ...</span><span>
</span><a name="line-214"></a><span class="hs-keyword">type</span><span> </span><a name="Elem"><a href="Servant.API.TypeLevel.html#Elem"><span class="hs-identifier">Elem</span></a></a><span> </span><a name="local-6989586621679106035"><a href="#local-6989586621679106035"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679106036"><a href="#local-6989586621679106036"><span class="hs-identifier">es</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Servant.API.TypeLevel.html#ElemGo"><span class="hs-identifier hs-type">ElemGo</span></a><span> </span><a href="#local-6989586621679106035"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-6989586621679106036"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679106036"><span class="hs-identifier hs-type">es</span></a><span>
</span><a name="line-215"></a><span>
</span><a name="line-216"></a><span class="hs-comment">-- 'orig' is used to store original list for better error messages</span><span>
</span><a name="line-217"></a><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><a name="ElemGo"><a href="Servant.API.TypeLevel.html#ElemGo"><span class="hs-identifier">ElemGo</span></a></a><span> </span><a name="local-6989586621679106023"><a href="#local-6989586621679106023"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679106024"><a href="#local-6989586621679106024"><span class="hs-identifier">es</span></a></a><span> </span><a name="local-6989586621679106025"><a href="#local-6989586621679106025"><span class="hs-identifier">orig</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Constraint</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-218"></a><span>  </span><span class="hs-identifier">ElemGo</span><span> </span><a href="#local-6989586621679106026"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">x</span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679106027"><span class="hs-identifier hs-type">xs</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679106028"><span class="hs-identifier hs-type">orig</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-219"></a><span>  </span><span class="hs-identifier">ElemGo</span><span> </span><a href="#local-6989586621679106029"><span class="hs-identifier hs-type">y</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">x</span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679106031"><span class="hs-identifier hs-type">xs</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679106032"><span class="hs-identifier hs-type">orig</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Servant.API.TypeLevel.html#ElemGo"><span class="hs-identifier hs-type">ElemGo</span></a><span> </span><a href="#local-6989586621679106029"><span class="hs-identifier hs-type">y</span></a><span> </span><a href="#local-6989586621679106031"><span class="hs-identifier hs-type">xs</span></a><span> </span><a href="#local-6989586621679106032"><span class="hs-identifier hs-type">orig</span></a><span>
</span><a name="line-220"></a><span>  </span><span class="hs-comment">-- Note [Custom Errors]</span><span>
</span><a name="line-221"></a><span>  </span><span class="hs-identifier">ElemGo</span><span> </span><a href="#local-6989586621679106033"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679106034"><span class="hs-identifier hs-type">orig</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">TypeError</span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="hs-identifier hs-type">ShowType</span><span> </span><a href="#local-6989586621679106033"><span class="hs-identifier hs-type">x</span></a><span>
</span><a name="line-222"></a><span>                                 </span><span class="hs-special">'</span><span class="hs-operator">:&lt;&gt;:</span><span> </span><span class="hs-special">'</span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-string">&quot; expected in list &quot;</span><span>
</span><a name="line-223"></a><span>                                 </span><span class="hs-special">'</span><span class="hs-operator">:&lt;&gt;:</span><span> </span><span class="hs-special">'</span><span class="hs-identifier hs-type">ShowType</span><span> </span><a href="#local-6989586621679106034"><span class="hs-identifier hs-type">orig</span></a><span class="hs-special">)</span><span>
</span><a name="line-224"></a><span>
</span><a name="line-225"></a><span class="hs-comment">-- ** Logic</span><span>
</span><a name="line-226"></a><span>
</span><a name="line-227"></a><span class="hs-comment">-- | If either a or b produce an empty constraint, produce an empty constraint.</span><span>
</span><a name="line-228"></a><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><a name="Or"><a href="Servant.API.TypeLevel.html#Or"><span class="hs-identifier">Or</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679106019"><a href="#local-6989586621679106019"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Constraint</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679106020"><a href="#local-6989586621679106020"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Constraint</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Constraint</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-229"></a><span>    </span><span class="hs-comment">-- This works because of:</span><span>
</span><a name="line-230"></a><span>    </span><span class="hs-comment">-- https://ghc.haskell.org/trac/ghc/wiki/NewAxioms/CoincidentOverlap</span><span>
</span><a name="line-231"></a><span>  </span><span class="hs-identifier">Or</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679106021"><span class="hs-identifier hs-type">b</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-232"></a><span>  </span><span class="hs-identifier">Or</span><span> </span><a href="#local-6989586621679106022"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-233"></a><span>
</span><a name="line-234"></a><span class="hs-comment">-- | If both a or b produce an empty constraint, produce an empty constraint.</span><span>
</span><a name="line-235"></a><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><a name="And"><a href="Servant.API.TypeLevel.html#And"><span class="hs-identifier">And</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679106017"><a href="#local-6989586621679106017"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Constraint</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679106018"><a href="#local-6989586621679106018"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Constraint</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Constraint</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-236"></a><span>  </span><span class="hs-identifier">And</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-237"></a><span>
</span><a name="line-238"></a><span class="hs-comment">{- Note [Custom Errors]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
We might try to factor these our more cleanly, but the type synonyms and type
families are not evaluated (see https://ghc.haskell.org/trac/ghc/ticket/12048).
-}</span><span>
</span><a name="line-243"></a><span>
</span><a name="line-244"></a><span>
</span><a name="line-245"></a><span class="hs-comment">-- $setup</span><span>
</span><a name="line-246"></a><span class="hs-comment">--</span><span>
</span><a name="line-247"></a><span class="hs-comment">-- The doctests in this module are run with following preamble:</span><span>
</span><a name="line-248"></a><span class="hs-comment">--</span><span>
</span><a name="line-249"></a><span class="hs-comment">-- &gt;&gt;&gt; :set -XPolyKinds</span><span>
</span><a name="line-250"></a><span class="hs-comment">-- &gt;&gt;&gt; :set -XGADTs</span><span>
</span><a name="line-251"></a><span class="hs-comment">-- &gt;&gt;&gt; import Data.Proxy</span><span>
</span><a name="line-252"></a><span class="hs-comment">-- &gt;&gt;&gt; import Data.Type.Equality</span><span>
</span><a name="line-253"></a><span class="hs-comment">-- &gt;&gt;&gt; import Servant.API</span><span>
</span><a name="line-254"></a><span class="hs-comment">-- &gt;&gt;&gt; data OK ctx where OK :: ctx =&gt; OK ctx</span><span>
</span><a name="line-255"></a><span class="hs-comment">-- &gt;&gt;&gt; instance Show (OK ctx) where show _ = &quot;OK&quot;</span><span>
</span><a name="line-256"></a><span class="hs-comment">-- &gt;&gt;&gt; let ok :: ctx =&gt; Proxy ctx -&gt; OK ctx; ok _ = OK</span><span>
</span><a name="line-257"></a><span class="hs-comment">-- &gt;&gt;&gt; type SampleAPI = &quot;hello&quot; :&gt; Get '[JSON] Int :&lt;|&gt; &quot;bye&quot; :&gt; Capture &quot;name&quot; String :&gt; Post '[JSON, PlainText] Bool</span><span>
</span><a name="line-258"></a><span class="hs-comment">-- &gt;&gt;&gt; let sampleAPI = Proxy :: Proxy SampleAPI</span><span>
</span><a name="line-259"></a></pre></body></html>