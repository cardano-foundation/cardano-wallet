<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE AllowAmbiguousTypes #-}</span><span>
</span><a name="line-2"></a><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><a name="line-3"></a><span class="hs-pragma">{-# LANGUAGE DeriveFunctor #-}</span><span>
</span><a name="line-4"></a><span class="hs-pragma">{-# LANGUAGE DeriveGeneric #-}</span><span>
</span><a name="line-5"></a><span class="hs-pragma">{-# LANGUAGE DerivingStrategies #-}</span><span>
</span><a name="line-6"></a><span class="hs-pragma">{-# LANGUAGE DuplicateRecordFields #-}</span><span>
</span><a name="line-7"></a><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><a name="line-8"></a><span class="hs-pragma">{-# LANGUAGE GeneralizedNewtypeDeriving #-}</span><span>
</span><a name="line-9"></a><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><a name="line-10"></a><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><a name="line-11"></a><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><a name="line-12"></a><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><a name="line-13"></a><span class="hs-pragma">{-# LANGUAGE StandaloneDeriving #-}</span><span>
</span><a name="line-14"></a><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><a name="line-15"></a><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><a name="line-16"></a><span class="hs-pragma">{-# LANGUAGE TypeOperators #-}</span><span>
</span><a name="line-17"></a><span>
</span><a name="line-18"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-19"></a><span class="hs-comment">-- Copyright: &#169; 2018-2019 IOHK</span><span>
</span><a name="line-20"></a><span class="hs-comment">-- License: MIT</span><span>
</span><a name="line-21"></a><span class="hs-comment">--</span><span>
</span><a name="line-22"></a><span class="hs-comment">-- This module contains the core primitive of a Wallet. This is roughly a</span><span>
</span><a name="line-23"></a><span class="hs-comment">-- Haskell translation of the [Formal Specification for a Cardano Wallet](https://github.com/input-output-hk/cardano-wallet/blob/master/specifications/wallet/formal-specification-for-a-cardano-wallet.pdf)</span><span>
</span><a name="line-24"></a><span class="hs-comment">--</span><span>
</span><a name="line-25"></a><span class="hs-comment">-- It doesn't contain any particular business-logic code, but define a few</span><span>
</span><a name="line-26"></a><span class="hs-comment">-- primitive operations on Wallet core types as well.</span><span>
</span><a name="line-27"></a><span>
</span><a name="line-28"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Cardano.Wallet.Primitive.Types</span><span>
</span><a name="line-29"></a><span>    </span><span class="hs-special">(</span><span>
</span><a name="line-30"></a><span>    </span><span class="hs-comment">-- * Block</span><span>
</span><a name="line-31"></a><span>      </span><a href="Cardano.Wallet.Primitive.Types.html#Block"><span class="hs-identifier hs-type">Block</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-32"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#BlockHeader"><span class="hs-identifier hs-type">BlockHeader</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-33"></a><span>
</span><a name="line-34"></a><span>    </span><span class="hs-comment">-- * Tx</span><span>
</span><a name="line-35"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#Tx"><span class="hs-identifier hs-type">Tx</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-36"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#TxId"><span class="hs-identifier hs-type">TxId</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-37"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#TxIn"><span class="hs-identifier hs-type">TxIn</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-38"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#TxOut"><span class="hs-identifier hs-type">TxOut</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-39"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#TxMeta"><span class="hs-identifier hs-type">TxMeta</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-40"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#Direction"><span class="hs-identifier hs-type">Direction</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-41"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#TxStatus"><span class="hs-identifier hs-type">TxStatus</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-42"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#TxWitness"><span class="hs-identifier hs-type">TxWitness</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-43"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#txIns"><span class="hs-identifier hs-var">txIns</span></a><span>
</span><a name="line-44"></a><span>
</span><a name="line-45"></a><span>    </span><span class="hs-comment">-- * Address</span><span>
</span><a name="line-46"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#Address"><span class="hs-identifier hs-type">Address</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-47"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#AddressState"><span class="hs-identifier hs-type">AddressState</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-48"></a><span>
</span><a name="line-49"></a><span>    </span><span class="hs-comment">-- * Coin</span><span>
</span><a name="line-50"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#Coin"><span class="hs-identifier hs-type">Coin</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-51"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#isValidCoin"><span class="hs-identifier hs-var">isValidCoin</span></a><span>
</span><a name="line-52"></a><span>
</span><a name="line-53"></a><span>    </span><span class="hs-comment">-- * UTxO</span><span>
</span><a name="line-54"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#UTxO"><span class="hs-identifier hs-type">UTxO</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-55"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#balance"><span class="hs-identifier hs-var">balance</span></a><span>
</span><a name="line-56"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#balance%27"><span class="hs-identifier hs-var">balance'</span></a><span>
</span><a name="line-57"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#pickRandom"><span class="hs-identifier hs-var">pickRandom</span></a><span>
</span><a name="line-58"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#excluding"><span class="hs-identifier hs-var">excluding</span></a><span>
</span><a name="line-59"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#isSubsetOf"><span class="hs-identifier hs-var">isSubsetOf</span></a><span>
</span><a name="line-60"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#restrictedBy"><span class="hs-identifier hs-var">restrictedBy</span></a><span>
</span><a name="line-61"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#restrictedTo"><span class="hs-identifier hs-var">restrictedTo</span></a><span>
</span><a name="line-62"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#Dom"><span class="hs-identifier hs-type">Dom</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-63"></a><span>
</span><a name="line-64"></a><span>    </span><span class="hs-comment">-- * Slotting</span><span>
</span><a name="line-65"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#SlotId"><span class="hs-identifier hs-type">SlotId</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-66"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#slotRatio"><span class="hs-identifier hs-var">slotRatio</span></a><span>
</span><a name="line-67"></a><span>
</span><a name="line-68"></a><span>    </span><span class="hs-comment">-- * Wallet Metadata</span><span>
</span><a name="line-69"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#WalletMetadata"><span class="hs-identifier hs-type">WalletMetadata</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-70"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#WalletId"><span class="hs-identifier hs-type">WalletId</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-71"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#WalletName"><span class="hs-identifier hs-type">WalletName</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-72"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#walletNameMinLength"><span class="hs-identifier hs-var">walletNameMinLength</span></a><span>
</span><a name="line-73"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#walletNameMaxLength"><span class="hs-identifier hs-var">walletNameMaxLength</span></a><span>
</span><a name="line-74"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#WalletState"><span class="hs-identifier hs-type">WalletState</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-75"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#WalletDelegation"><span class="hs-identifier hs-type">WalletDelegation</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-76"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#WalletPassphraseInfo"><span class="hs-identifier hs-type">WalletPassphraseInfo</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-77"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#WalletBalance"><span class="hs-identifier hs-type">WalletBalance</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-78"></a><span>
</span><a name="line-79"></a><span>    </span><span class="hs-comment">-- * Stake Pools</span><span>
</span><a name="line-80"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#PoolId"><span class="hs-identifier hs-type">PoolId</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-81"></a><span>
</span><a name="line-82"></a><span>    </span><span class="hs-comment">-- * Polymorphic</span><span>
</span><a name="line-83"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#Hash"><span class="hs-identifier hs-type">Hash</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-84"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#ShowFmt"><span class="hs-identifier hs-type">ShowFmt</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-85"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#invariant"><span class="hs-identifier hs-var">invariant</span></a><span>
</span><a name="line-86"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#distance"><span class="hs-identifier hs-var">distance</span></a><span>
</span><a name="line-87"></a><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-88"></a><span>
</span><a name="line-89"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Prelude</span><span>
</span><a name="line-90"></a><span>
</span><a name="line-91"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.DeepSeq</span><span>
</span><a name="line-92"></a><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">NFData</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-93"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Crypto.Hash</span><span>
</span><a name="line-94"></a><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">Blake2b_160</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Digest</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">digestFromByteString</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-95"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Crypto.Number.Generate</span><span>
</span><a name="line-96"></a><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">generateBetween</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-97"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Crypto.Random.Types</span><span>
</span><a name="line-98"></a><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">MonadRandom</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-99"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.ByteArray.Encoding</span><span>
</span><a name="line-100"></a><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">Base</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Base16</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">convertFromBase</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">convertToBase</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-101"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.ByteString</span><span>
</span><a name="line-102"></a><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">ByteString</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-103"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.ByteString.Base58</span><span>
</span><a name="line-104"></a><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">bitcoinAlphabet</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">decodeBase58</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">encodeBase58</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-105"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Map.Strict</span><span>
</span><a name="line-106"></a><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">Map</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-107"></a><span class="hs-keyword">import</span><span> </span><a href="Data.Quantity.html"><span class="hs-identifier">Data.Quantity</span></a><span>
</span><a name="line-108"></a><span>    </span><span class="hs-special">(</span><span> </span><a href="Data.Quantity.html#Percentage"><span class="hs-identifier hs-type">Percentage</span></a><span class="hs-special">,</span><span> </span><a href="Data.Quantity.html#Quantity"><span class="hs-identifier hs-type">Quantity</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-109"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Set</span><span>
</span><a name="line-110"></a><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">Set</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-111"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.String</span><span>
</span><a name="line-112"></a><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">fromString</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-113"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Text</span><span>
</span><a name="line-114"></a><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-115"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Text.Class</span><span>
</span><a name="line-116"></a><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">FromText</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">TextDecodingError</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">ToText</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-117"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Time</span><span>
</span><a name="line-118"></a><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">UTCTime</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-119"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Word</span><span>
</span><a name="line-120"></a><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">Word16</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Word32</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Word64</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-121"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Fmt</span><span>
</span><a name="line-122"></a><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">Buildable</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-123"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">blockListF</span><span>
</span><a name="line-124"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">blockListF'</span><span>
</span><a name="line-125"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">fixedF</span><span>
</span><a name="line-126"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">fmt</span><span>
</span><a name="line-127"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">indentF</span><span>
</span><a name="line-128"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">ordinalF</span><span>
</span><a name="line-129"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">prefixF</span><span>
</span><a name="line-130"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">suffixF</span><span>
</span><a name="line-131"></a><span>    </span><span class="hs-special">)</span><span>
</span><a name="line-132"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GHC.Generics</span><span>
</span><a name="line-133"></a><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">Generic</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-134"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GHC.TypeLits</span><span>
</span><a name="line-135"></a><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">Symbol</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-136"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Numeric.Natural</span><span>
</span><a name="line-137"></a><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">Natural</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-138"></a><span>
</span><a name="line-139"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Char</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Char</span><span>
</span><a name="line-140"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Map.Strict</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Map</span><span>
</span><a name="line-141"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Set</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Set</span><span>
</span><a name="line-142"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Text</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">T</span><span>
</span><a name="line-143"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Text.Encoding</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">T</span><span>
</span><a name="line-144"></a><span>
</span><a name="line-145"></a><span class="hs-comment">{-------------------------------------------------------------------------------
                             Wallet Metadata
-------------------------------------------------------------------------------}</span><span>
</span><a name="line-148"></a><span>
</span><a name="line-149"></a><span class="hs-keyword">data</span><span> </span><a name="WalletMetadata"><a href="Cardano.Wallet.Primitive.Types.html#WalletMetadata"><span class="hs-identifier">WalletMetadata</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="WalletMetadata"><a href="Cardano.Wallet.Primitive.Types.html#WalletMetadata"><span class="hs-identifier">WalletMetadata</span></a></a><span>
</span><a name="line-150"></a><span>    </span><span class="hs-special">{</span><span> </span><a name="%24sel%3Aname%3AWalletMetadata"><a href="Cardano.Wallet.Primitive.Types.html#%24sel%3Aname%3AWalletMetadata"><span class="hs-identifier">name</span></a></a><span>
</span><a name="line-151"></a><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><a href="Cardano.Wallet.Primitive.Types.html#WalletName"><span class="hs-identifier hs-type">WalletName</span></a><span>
</span><a name="line-152"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="%24sel%3ApassphraseInfo%3AWalletMetadata"><a href="Cardano.Wallet.Primitive.Types.html#%24sel%3ApassphraseInfo%3AWalletMetadata"><span class="hs-identifier">passphraseInfo</span></a></a><span>
</span><a name="line-153"></a><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><a href="Cardano.Wallet.Primitive.Types.html#WalletPassphraseInfo"><span class="hs-identifier hs-type">WalletPassphraseInfo</span></a><span>
</span><a name="line-154"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="%24sel%3Astatus%3AWalletMetadata"><a href="Cardano.Wallet.Primitive.Types.html#%24sel%3Astatus%3AWalletMetadata"><span class="hs-identifier">status</span></a></a><span>
</span><a name="line-155"></a><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><a href="Cardano.Wallet.Primitive.Types.html#WalletState"><span class="hs-identifier hs-type">WalletState</span></a><span>
</span><a name="line-156"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="%24sel%3Adelegation%3AWalletMetadata"><a href="Cardano.Wallet.Primitive.Types.html#%24sel%3Adelegation%3AWalletMetadata"><span class="hs-identifier">delegation</span></a></a><span>
</span><a name="line-157"></a><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><a href="Cardano.Wallet.Primitive.Types.html#WalletDelegation"><span class="hs-identifier hs-type">WalletDelegation</span></a><span> </span><a href="Cardano.Wallet.Primitive.Types.html#PoolId"><span class="hs-identifier hs-type">PoolId</span></a><span class="hs-special">)</span><span>
</span><a name="line-158"></a><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">)</span><span>
</span><a name="line-159"></a><span>
</span><a name="line-160"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">NFData</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#WalletMetadata"><span class="hs-identifier hs-type">WalletMetadata</span></a><span>
</span><a name="line-161"></a><span>
</span><a name="line-162"></a><span class="hs-keyword">newtype</span><span> </span><a name="WalletName"><a href="Cardano.Wallet.Primitive.Types.html#WalletName"><span class="hs-identifier">WalletName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="WalletName"><a href="Cardano.Wallet.Primitive.Types.html#WalletName"><span class="hs-identifier">WalletName</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="%24sel%3AgetWalletName%3AWalletName"><a href="Cardano.Wallet.Primitive.Types.html#%24sel%3AgetWalletName%3AWalletName"><span class="hs-identifier">getWalletName</span></a></a><span> </span><span class="hs-glyph">::</span><span>  </span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-163"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-164"></a><span>
</span><a name="line-165"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">NFData</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#WalletName"><span class="hs-identifier hs-type">WalletName</span></a><span>
</span><a name="line-166"></a><span>
</span><a name="line-167"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">FromText</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#WalletName"><span class="hs-identifier hs-type">WalletName</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-168"></a><span>    </span><a name="local-8214565720323796131"><span class="hs-identifier">fromText</span></a><span> </span><a name="local-6989586621679130197"><a href="#local-6989586621679130197"><span class="hs-identifier">t</span></a></a><span>
</span><a name="line-169"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">T.length</span><span> </span><a href="#local-6989586621679130197"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#walletNameMinLength"><span class="hs-identifier hs-var">walletNameMinLength</span></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-170"></a><span>            </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">TextDecodingError</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-171"></a><span>                </span><span class="hs-string">&quot;name is too short: expected at least &quot;</span><span>
</span><a name="line-172"></a><span>                    </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#walletNameMinLength"><span class="hs-identifier hs-var">walletNameMinLength</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; character&quot;</span><span>
</span><a name="line-173"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">T.length</span><span> </span><a href="#local-6989586621679130197"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#walletNameMaxLength"><span class="hs-identifier hs-var">walletNameMaxLength</span></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-174"></a><span>            </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">TextDecodingError</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-175"></a><span>                </span><span class="hs-string">&quot;name is too long: expected at most &quot;</span><span>
</span><a name="line-176"></a><span>                    </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#walletNameMaxLength"><span class="hs-identifier hs-var">walletNameMaxLength</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; characters&quot;</span><span>
</span><a name="line-177"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-178"></a><span>            </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#WalletName"><span class="hs-identifier hs-var">WalletName</span></a><span> </span><a href="#local-6989586621679130197"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-179"></a><span>
</span><a name="line-180"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">ToText</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#WalletName"><span class="hs-identifier hs-type">WalletName</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-181"></a><span>    </span><a name="local-8214565720323796129"><span class="hs-identifier">toText</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">getWalletName</span><span>
</span><a name="line-182"></a><span>
</span><a name="line-183"></a><span class="hs-identifier">walletNameMinLength</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-184"></a><a name="walletNameMinLength"><a href="Cardano.Wallet.Primitive.Types.html#walletNameMinLength"><span class="hs-identifier">walletNameMinLength</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-185"></a><span>
</span><a name="line-186"></a><span class="hs-identifier">walletNameMaxLength</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-187"></a><a name="walletNameMaxLength"><a href="Cardano.Wallet.Primitive.Types.html#walletNameMaxLength"><span class="hs-identifier">walletNameMaxLength</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">255</span><span>
</span><a name="line-188"></a><span>
</span><a name="line-189"></a><span class="hs-keyword">newtype</span><span> </span><a name="WalletId"><a href="Cardano.Wallet.Primitive.Types.html#WalletId"><span class="hs-identifier">WalletId</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="WalletId"><a href="Cardano.Wallet.Primitive.Types.html#WalletId"><span class="hs-identifier">WalletId</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="%24sel%3AgetWalletId%3AWalletId"><a href="Cardano.Wallet.Primitive.Types.html#%24sel%3AgetWalletId%3AWalletId"><span class="hs-identifier">getWalletId</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Digest</span><span> </span><span class="hs-identifier hs-type">Blake2b_160</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-190"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-191"></a><span>
</span><a name="line-192"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">NFData</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#WalletId"><span class="hs-identifier hs-type">WalletId</span></a><span>
</span><a name="line-193"></a><span>
</span><a name="line-194"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">FromText</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#WalletId"><span class="hs-identifier hs-type">WalletId</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-195"></a><span>    </span><a name="local-8214565720323796131"><span class="hs-identifier">fromText</span></a><span> </span><a name="local-6989586621679130193"><a href="#local-6989586621679130193"><span class="hs-identifier">txt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">maybe</span><span>
</span><a name="line-196"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">TextDecodingError</span><span> </span><a href="#local-6989586621679130194"><span class="hs-identifier hs-var">msg</span></a><span class="hs-special">)</span><span>
</span><a name="line-197"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#WalletId"><span class="hs-identifier hs-var">WalletId</span></a><span class="hs-special">)</span><span>
</span><a name="line-198"></a><span>        </span><span class="hs-special">(</span><a href="#local-6989586621679130195"><span class="hs-identifier hs-var">decodeHex</span></a><span> </span><a href="#local-6989586621679130193"><span class="hs-identifier hs-var">txt</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-identifier hs-var">digestFromByteString</span><span> </span><span class="hs-glyph">@</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">@</span><span class="hs-identifier hs-type">ByteString</span><span class="hs-special">)</span><span>
</span><a name="line-199"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-200"></a><span>        </span><a name="local-6989586621679130194"><a href="#local-6989586621679130194"><span class="hs-identifier">msg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;wallet id should be an hex-encoded string of 40 characters&quot;</span><span>
</span><a name="line-201"></a><span>        </span><a name="local-6989586621679130195"><a href="#local-6989586621679130195"><span class="hs-identifier">decodeHex</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-202"></a><span>            </span><span class="hs-identifier hs-var">either</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">const</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">convertFromBase</span><span> </span><span class="hs-identifier hs-var">Base16</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">T.encodeUtf8</span><span>
</span><a name="line-203"></a><span>
</span><a name="line-204"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">ToText</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#WalletId"><span class="hs-identifier hs-type">WalletId</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-205"></a><span>    </span><a name="local-8214565720323796129"><span class="hs-identifier">toText</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">T.decodeUtf8</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">convertToBase</span><span> </span><span class="hs-identifier hs-var">Base16</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">getWalletId</span><span>
</span><a name="line-206"></a><span>
</span><a name="line-207"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Buildable</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#WalletId"><span class="hs-identifier hs-type">WalletId</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-208"></a><span>    </span><a name="local-8214565720323798156"><span class="hs-identifier">build</span></a><span> </span><a name="local-6989586621679130191"><a href="#local-6989586621679130191"><span class="hs-identifier">wid</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">prefixF</span><span> </span><span class="hs-number">8</span><span> </span><a href="#local-6989586621679130192"><span class="hs-identifier hs-var">widF</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;...&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">suffixF</span><span> </span><span class="hs-number">8</span><span> </span><a href="#local-6989586621679130192"><span class="hs-identifier hs-var">widF</span></a><span>
</span><a name="line-209"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-210"></a><span>        </span><a name="local-6989586621679130192"><a href="#local-6989586621679130192"><span class="hs-identifier">widF</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">toText</span><span> </span><a href="#local-6989586621679130191"><span class="hs-identifier hs-var">wid</span></a><span>
</span><a name="line-211"></a><span>
</span><a name="line-212"></a><span class="hs-keyword">data</span><span> </span><a name="WalletState"><a href="Cardano.Wallet.Primitive.Types.html#WalletState"><span class="hs-identifier">WalletState</span></a></a><span>
</span><a name="line-213"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a name="Ready"><a href="Cardano.Wallet.Primitive.Types.html#Ready"><span class="hs-identifier">Ready</span></a></a><span>
</span><a name="line-214"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="Restoring"><a href="Cardano.Wallet.Primitive.Types.html#Restoring"><span class="hs-identifier">Restoring</span></a></a><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><a href="Data.Quantity.html#Quantity"><span class="hs-identifier hs-type">Quantity</span></a><span> </span><span class="hs-string">&quot;percent&quot;</span><span> </span><a href="Data.Quantity.html#Percentage"><span class="hs-identifier hs-type">Percentage</span></a><span class="hs-special">)</span><span>
</span><a name="line-215"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-216"></a><span>
</span><a name="line-217"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">NFData</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#WalletState"><span class="hs-identifier hs-type">WalletState</span></a><span>
</span><a name="line-218"></a><span>
</span><a name="line-219"></a><span class="hs-keyword">data</span><span> </span><a name="WalletDelegation"><a href="Cardano.Wallet.Primitive.Types.html#WalletDelegation"><span class="hs-identifier">WalletDelegation</span></a></a><span> </span><a name="local-6989586621679129712"><a href="#local-6989586621679129712"><span class="hs-identifier">poolId</span></a></a><span>
</span><a name="line-220"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a name="NotDelegating"><a href="Cardano.Wallet.Primitive.Types.html#NotDelegating"><span class="hs-identifier">NotDelegating</span></a></a><span>
</span><a name="line-221"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="Delegating"><a href="Cardano.Wallet.Primitive.Types.html#Delegating"><span class="hs-identifier">Delegating</span></a></a><span> </span><span class="hs-glyph">!</span><a href="#local-6989586621679129712"><span class="hs-identifier hs-type">poolId</span></a><span>
</span><a name="line-222"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-223"></a><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Functor</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#WalletDelegation"><span class="hs-identifier hs-type">WalletDelegation</span></a><span>
</span><a name="line-224"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">NFData</span><span> </span><a href="#local-6989586621679130190"><span class="hs-identifier hs-type">poolId</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">NFData</span><span> </span><span class="hs-special">(</span><a href="Cardano.Wallet.Primitive.Types.html#WalletDelegation"><span class="hs-identifier hs-type">WalletDelegation</span></a><span> </span><a href="#local-6989586621679130190"><span class="hs-identifier hs-type">poolId</span></a><span class="hs-special">)</span><span>
</span><a name="line-225"></a><span>
</span><a name="line-226"></a><span class="hs-keyword">newtype</span><span> </span><a name="WalletPassphraseInfo"><a href="Cardano.Wallet.Primitive.Types.html#WalletPassphraseInfo"><span class="hs-identifier">WalletPassphraseInfo</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="WalletPassphraseInfo"><a href="Cardano.Wallet.Primitive.Types.html#WalletPassphraseInfo"><span class="hs-identifier">WalletPassphraseInfo</span></a></a><span>
</span><a name="line-227"></a><span>    </span><span class="hs-special">{</span><span> </span><a name="%24sel%3AlastUpdatedAt%3AWalletPassphraseInfo"><a href="Cardano.Wallet.Primitive.Types.html#%24sel%3AlastUpdatedAt%3AWalletPassphraseInfo"><span class="hs-identifier">lastUpdatedAt</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">UTCTime</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-228"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-229"></a><span>
</span><a name="line-230"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">NFData</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#WalletPassphraseInfo"><span class="hs-identifier hs-type">WalletPassphraseInfo</span></a><span>
</span><a name="line-231"></a><span>
</span><a name="line-232"></a><span class="hs-keyword">data</span><span> </span><a name="WalletBalance"><a href="Cardano.Wallet.Primitive.Types.html#WalletBalance"><span class="hs-identifier">WalletBalance</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="WalletBalance"><a href="Cardano.Wallet.Primitive.Types.html#WalletBalance"><span class="hs-identifier">WalletBalance</span></a></a><span>
</span><a name="line-233"></a><span>    </span><span class="hs-special">{</span><span> </span><a name="%24sel%3Aavailable%3AWalletBalance"><a href="Cardano.Wallet.Primitive.Types.html#%24sel%3Aavailable%3AWalletBalance"><span class="hs-identifier">available</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><a href="Data.Quantity.html#Quantity"><span class="hs-identifier hs-type">Quantity</span></a><span> </span><span class="hs-string">&quot;lovelace&quot;</span><span> </span><span class="hs-identifier hs-type">Natural</span><span class="hs-special">)</span><span>
</span><a name="line-234"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="%24sel%3Atotal%3AWalletBalance"><a href="Cardano.Wallet.Primitive.Types.html#%24sel%3Atotal%3AWalletBalance"><span class="hs-identifier">total</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><a href="Data.Quantity.html#Quantity"><span class="hs-identifier hs-type">Quantity</span></a><span> </span><span class="hs-string">&quot;lovelace&quot;</span><span> </span><span class="hs-identifier hs-type">Natural</span><span class="hs-special">)</span><span>
</span><a name="line-235"></a><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-236"></a><span>
</span><a name="line-237"></a><span class="hs-comment">{-------------------------------------------------------------------------------
                                  Stake Pools
-------------------------------------------------------------------------------}</span><span>
</span><a name="line-240"></a><span>
</span><a name="line-241"></a><span class="hs-comment">-- | Represent stake pool identifier. Note that the internal representation is</span><span>
</span><a name="line-242"></a><span class="hs-comment">-- left open currently, until we figure out a better type for those.</span><span>
</span><a name="line-243"></a><span class="hs-keyword">newtype</span><span> </span><a name="PoolId"><a href="Cardano.Wallet.Primitive.Types.html#PoolId"><span class="hs-identifier">PoolId</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="PoolId"><a href="Cardano.Wallet.Primitive.Types.html#PoolId"><span class="hs-identifier">PoolId</span></a></a><span>
</span><a name="line-244"></a><span>    </span><span class="hs-special">{</span><span> </span><a name="%24sel%3AgetPoolId%3APoolId"><a href="Cardano.Wallet.Primitive.Types.html#%24sel%3AgetPoolId%3APoolId"><span class="hs-identifier">getPoolId</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-245"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-246"></a><span>
</span><a name="line-247"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">NFData</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#PoolId"><span class="hs-identifier hs-type">PoolId</span></a><span>
</span><a name="line-248"></a><span>
</span><a name="line-249"></a><span class="hs-comment">{-------------------------------------------------------------------------------
                                    Block
-------------------------------------------------------------------------------}</span><span>
</span><a name="line-252"></a><span>
</span><a name="line-253"></a><span class="hs-keyword">data</span><span> </span><a name="Block"><a href="Cardano.Wallet.Primitive.Types.html#Block"><span class="hs-identifier">Block</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Block"><a href="Cardano.Wallet.Primitive.Types.html#Block"><span class="hs-identifier">Block</span></a></a><span>
</span><a name="line-254"></a><span>    </span><span class="hs-special">{</span><span> </span><a name="%24sel%3Aheader%3ABlock"><a href="Cardano.Wallet.Primitive.Types.html#%24sel%3Aheader%3ABlock"><span class="hs-identifier">header</span></a></a><span>
</span><a name="line-255"></a><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><a href="Cardano.Wallet.Primitive.Types.html#BlockHeader"><span class="hs-identifier hs-type">BlockHeader</span></a><span>
</span><a name="line-256"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="%24sel%3Atransactions%3ABlock"><a href="Cardano.Wallet.Primitive.Types.html#%24sel%3Atransactions%3ABlock"><span class="hs-identifier">transactions</span></a></a><span>
</span><a name="line-257"></a><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">[</span><a href="Cardano.Wallet.Primitive.Types.html#Tx"><span class="hs-identifier hs-type">Tx</span></a><span class="hs-special">]</span><span>
</span><a name="line-258"></a><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">)</span><span>
</span><a name="line-259"></a><span>
</span><a name="line-260"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">NFData</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#Block"><span class="hs-identifier hs-type">Block</span></a><span>
</span><a name="line-261"></a><span>
</span><a name="line-262"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Buildable</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#Block"><span class="hs-identifier hs-type">Block</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-263"></a><span>    </span><a name="local-8214565720323798156"><span class="hs-identifier">build</span></a><span> </span><span class="hs-special">(</span><a href="Cardano.Wallet.Primitive.Types.html#Block"><span class="hs-identifier hs-var">Block</span></a><span> </span><a name="local-6989586621679130188"><a href="#local-6989586621679130188"><span class="hs-identifier">h</span></a></a><span> </span><a name="local-6989586621679130189"><a href="#local-6989586621679130189"><span class="hs-identifier">txs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mempty</span><span>
</span><a name="line-264"></a><span>        </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">build</span><span> </span><a href="#local-6989586621679130188"><span class="hs-identifier hs-var">h</span></a><span>
</span><a name="line-265"></a><span>        </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;\n&quot;</span><span>
</span><a name="line-266"></a><span>        </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">indentF</span><span> </span><span class="hs-number">4</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">blockListF</span><span> </span><a href="#local-6989586621679130189"><span class="hs-identifier hs-var">txs</span></a><span class="hs-special">)</span><span>
</span><a name="line-267"></a><span>
</span><a name="line-268"></a><span>
</span><a name="line-269"></a><span class="hs-keyword">data</span><span> </span><a name="BlockHeader"><a href="Cardano.Wallet.Primitive.Types.html#BlockHeader"><span class="hs-identifier">BlockHeader</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="BlockHeader"><a href="Cardano.Wallet.Primitive.Types.html#BlockHeader"><span class="hs-identifier">BlockHeader</span></a></a><span>
</span><a name="line-270"></a><span>    </span><span class="hs-special">{</span><span> </span><a name="%24sel%3AslotId%3ABlockHeader"><a href="Cardano.Wallet.Primitive.Types.html#%24sel%3AslotId%3ABlockHeader"><span class="hs-identifier">slotId</span></a></a><span>
</span><a name="line-271"></a><span>        </span><span class="hs-glyph">::</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#SlotId"><span class="hs-identifier hs-type">SlotId</span></a><span>
</span><a name="line-272"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="%24sel%3AprevBlockHash%3ABlockHeader"><a href="Cardano.Wallet.Primitive.Types.html#%24sel%3AprevBlockHash%3ABlockHeader"><span class="hs-identifier">prevBlockHash</span></a></a><span>
</span><a name="line-273"></a><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><a href="Cardano.Wallet.Primitive.Types.html#Hash"><span class="hs-identifier hs-type">Hash</span></a><span> </span><span class="hs-string">&quot;BlockHeader&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-274"></a><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">)</span><span>
</span><a name="line-275"></a><span>
</span><a name="line-276"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">NFData</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#BlockHeader"><span class="hs-identifier hs-type">BlockHeader</span></a><span>
</span><a name="line-277"></a><span>
</span><a name="line-278"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Buildable</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#BlockHeader"><span class="hs-identifier hs-type">BlockHeader</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-279"></a><span>    </span><a name="local-8214565720323798156"><span class="hs-identifier">build</span></a><span> </span><span class="hs-special">(</span><a href="Cardano.Wallet.Primitive.Types.html#BlockHeader"><span class="hs-identifier hs-var">BlockHeader</span></a><span> </span><a name="local-6989586621679130185"><a href="#local-6989586621679130185"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679130186"><a href="#local-6989586621679130186"><span class="hs-identifier">prev</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mempty</span><span>
</span><a name="line-280"></a><span>        </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">prefixF</span><span> </span><span class="hs-number">8</span><span> </span><a href="#local-6989586621679130187"><span class="hs-identifier hs-var">prevF</span></a><span>
</span><a name="line-281"></a><span>        </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;...&quot;</span><span>
</span><a name="line-282"></a><span>        </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">suffixF</span><span> </span><span class="hs-number">8</span><span> </span><a href="#local-6989586621679130187"><span class="hs-identifier hs-var">prevF</span></a><span>
</span><a name="line-283"></a><span>        </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; (&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">build</span><span> </span><a href="#local-6989586621679130185"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;)&quot;</span><span>
</span><a name="line-284"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-285"></a><span>        </span><a name="local-6989586621679130187"><a href="#local-6989586621679130187"><span class="hs-identifier">prevF</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">build</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">T.decodeUtf8</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">convertToBase</span><span> </span><span class="hs-identifier hs-var">Base16</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">getHash</span><span> </span><a href="#local-6989586621679130186"><span class="hs-identifier hs-var">prev</span></a><span>
</span><a name="line-286"></a><span>
</span><a name="line-287"></a><span class="hs-comment">{-------------------------------------------------------------------------------
                                      Tx
-------------------------------------------------------------------------------}</span><span>
</span><a name="line-290"></a><span>
</span><a name="line-291"></a><span class="hs-keyword">data</span><span> </span><a name="Tx"><a href="Cardano.Wallet.Primitive.Types.html#Tx"><span class="hs-identifier">Tx</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Tx"><a href="Cardano.Wallet.Primitive.Types.html#Tx"><span class="hs-identifier">Tx</span></a></a><span>
</span><a name="line-292"></a><span>    </span><span class="hs-special">{</span><span> </span><a name="%24sel%3Ainputs%3ATx"><a href="Cardano.Wallet.Primitive.Types.html#%24sel%3Ainputs%3ATx"><span class="hs-identifier">inputs</span></a></a><span>
</span><a name="line-293"></a><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">[</span><a href="Cardano.Wallet.Primitive.Types.html#TxIn"><span class="hs-identifier hs-type">TxIn</span></a><span class="hs-special">]</span><span>
</span><a name="line-294"></a><span>        </span><span class="hs-comment">-- ^ Order of inputs matters in the transaction representation. The</span><span>
</span><a name="line-295"></a><span>        </span><span class="hs-comment">-- transaction id is computed from the binary representation of a tx,</span><span>
</span><a name="line-296"></a><span>        </span><span class="hs-comment">-- for which inputs are serialized in a specific order.</span><span>
</span><a name="line-297"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="%24sel%3Aoutputs%3ATx"><a href="Cardano.Wallet.Primitive.Types.html#%24sel%3Aoutputs%3ATx"><span class="hs-identifier">outputs</span></a></a><span>
</span><a name="line-298"></a><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">[</span><a href="Cardano.Wallet.Primitive.Types.html#TxOut"><span class="hs-identifier hs-type">TxOut</span></a><span class="hs-special">]</span><span>
</span><a name="line-299"></a><span>        </span><span class="hs-comment">-- ^ Order of outputs matter in the transaction representations. Outputs</span><span>
</span><a name="line-300"></a><span>        </span><span class="hs-comment">-- are used as inputs for next transactions which refer to them using</span><span>
</span><a name="line-301"></a><span>        </span><span class="hs-comment">-- their indexes. It matters also for serialization.</span><span>
</span><a name="line-302"></a><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">)</span><span>
</span><a name="line-303"></a><span>
</span><a name="line-304"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">NFData</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#Tx"><span class="hs-identifier hs-type">Tx</span></a><span>
</span><a name="line-305"></a><span>
</span><a name="line-306"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Buildable</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#Tx"><span class="hs-identifier hs-type">Tx</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-307"></a><span>    </span><a name="local-8214565720323798156"><span class="hs-identifier">build</span></a><span> </span><span class="hs-special">(</span><a href="Cardano.Wallet.Primitive.Types.html#Tx"><span class="hs-identifier hs-var">Tx</span></a><span> </span><a name="local-6989586621679130183"><a href="#local-6989586621679130183"><span class="hs-identifier">ins</span></a></a><span> </span><a name="local-6989586621679130184"><a href="#local-6989586621679130184"><span class="hs-identifier">outs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mempty</span><span>
</span><a name="line-308"></a><span>        </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">blockListF'</span><span> </span><span class="hs-string">&quot;~&gt;&quot;</span><span> </span><span class="hs-identifier hs-var">build</span><span> </span><a href="#local-6989586621679130183"><span class="hs-identifier hs-var">ins</span></a><span>
</span><a name="line-309"></a><span>        </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">blockListF'</span><span> </span><span class="hs-string">&quot;&lt;~&quot;</span><span> </span><span class="hs-identifier hs-var">build</span><span> </span><a href="#local-6989586621679130184"><span class="hs-identifier hs-var">outs</span></a><span>
</span><a name="line-310"></a><span>
</span><a name="line-311"></a><span class="hs-comment">-- | An abstraction for computing transaction id. The 'target' is an open-type</span><span>
</span><a name="line-312"></a><span class="hs-comment">-- that can be used to discriminate on. For instance:</span><span>
</span><a name="line-313"></a><span class="hs-comment">--</span><span>
</span><a name="line-314"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-315"></a><span class="hs-comment">-- instance TxId HttpBridge where</span><span>
</span><a name="line-316"></a><span class="hs-comment">--   txId _ = {- ... -}</span><span>
</span><a name="line-317"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-318"></a><span class="hs-comment">--</span><span>
</span><a name="line-319"></a><span class="hs-comment">-- Note that `txId` is ambiguous and requires therefore a type application.</span><span>
</span><a name="line-320"></a><span class="hs-comment">-- Likely, a corresponding target would be found in scope (requires however</span><span>
</span><a name="line-321"></a><span class="hs-comment">-- ScopedTypeVariables).</span><span>
</span><a name="line-322"></a><span class="hs-comment">--</span><span>
</span><a name="line-323"></a><span class="hs-comment">-- For example, assuming there's a type 'target' in scope, one can simply do:</span><span>
</span><a name="line-324"></a><span class="hs-comment">--</span><span>
</span><a name="line-325"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-326"></a><span class="hs-comment">-- txId @target tx</span><span>
</span><a name="line-327"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-328"></a><span class="hs-keyword">class</span><span> </span><a name="TxId"><a href="Cardano.Wallet.Primitive.Types.html#TxId"><span class="hs-identifier">TxId</span></a></a><span> </span><a name="local-6989586621679129711"><a href="#local-6989586621679129711"><span class="hs-identifier">target</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-329"></a><span>    </span><a name="txId"><a href="Cardano.Wallet.Primitive.Types.html#txId"><span class="hs-identifier">txId</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#Tx"><span class="hs-identifier hs-type">Tx</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#Hash"><span class="hs-identifier hs-type">Hash</span></a><span> </span><span class="hs-string">&quot;Tx&quot;</span><span>
</span><a name="line-330"></a><span>
</span><a name="line-331"></a><span class="hs-identifier">txIns</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Set</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#Tx"><span class="hs-identifier hs-type">Tx</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Set</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#TxIn"><span class="hs-identifier hs-type">TxIn</span></a><span>
</span><a name="line-332"></a><a name="txIns"><a href="Cardano.Wallet.Primitive.Types.html#txIns"><span class="hs-identifier">txIns</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-333"></a><span>    </span><span class="hs-identifier hs-var">foldMap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Set.fromList</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">inputs</span><span class="hs-special">)</span><span>
</span><a name="line-334"></a><span>
</span><a name="line-335"></a><span class="hs-keyword">data</span><span> </span><a name="TxIn"><a href="Cardano.Wallet.Primitive.Types.html#TxIn"><span class="hs-identifier">TxIn</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="TxIn"><a href="Cardano.Wallet.Primitive.Types.html#TxIn"><span class="hs-identifier">TxIn</span></a></a><span>
</span><a name="line-336"></a><span>    </span><span class="hs-special">{</span><span> </span><a name="%24sel%3AinputId%3ATxIn"><a href="Cardano.Wallet.Primitive.Types.html#%24sel%3AinputId%3ATxIn"><span class="hs-identifier">inputId</span></a></a><span>
</span><a name="line-337"></a><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><a href="Cardano.Wallet.Primitive.Types.html#Hash"><span class="hs-identifier hs-type">Hash</span></a><span> </span><span class="hs-string">&quot;Tx&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-338"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="%24sel%3AinputIx%3ATxIn"><a href="Cardano.Wallet.Primitive.Types.html#%24sel%3AinputIx%3ATxIn"><span class="hs-identifier">inputIx</span></a></a><span>
</span><a name="line-339"></a><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier hs-type">Word32</span><span>
</span><a name="line-340"></a><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">)</span><span>
</span><a name="line-341"></a><span>
</span><a name="line-342"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">NFData</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#TxIn"><span class="hs-identifier hs-type">TxIn</span></a><span>
</span><a name="line-343"></a><span>
</span><a name="line-344"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Buildable</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#TxIn"><span class="hs-identifier hs-type">TxIn</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-345"></a><span>    </span><a name="local-8214565720323798156"><span class="hs-identifier">build</span></a><span> </span><a name="local-6989586621679130182"><a href="#local-6989586621679130182"><span class="hs-identifier">txin</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mempty</span><span>
</span><a name="line-346"></a><span>        </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">ordinalF</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">inputIx</span><span> </span><a href="#local-6989586621679130182"><span class="hs-identifier hs-var">txin</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-347"></a><span>        </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; &quot;</span><span>
</span><a name="line-348"></a><span>        </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">build</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">inputId</span><span> </span><a href="#local-6989586621679130182"><span class="hs-identifier hs-var">txin</span></a><span class="hs-special">)</span><span>
</span><a name="line-349"></a><span>
</span><a name="line-350"></a><span class="hs-keyword">data</span><span> </span><a name="TxOut"><a href="Cardano.Wallet.Primitive.Types.html#TxOut"><span class="hs-identifier">TxOut</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="TxOut"><a href="Cardano.Wallet.Primitive.Types.html#TxOut"><span class="hs-identifier">TxOut</span></a></a><span>
</span><a name="line-351"></a><span>    </span><span class="hs-special">{</span><span> </span><a name="%24sel%3Aaddress%3ATxOut"><a href="Cardano.Wallet.Primitive.Types.html#%24sel%3Aaddress%3ATxOut"><span class="hs-identifier">address</span></a></a><span>
</span><a name="line-352"></a><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><a href="Cardano.Wallet.Primitive.Types.html#Address"><span class="hs-identifier hs-type">Address</span></a><span>
</span><a name="line-353"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="%24sel%3Acoin%3ATxOut"><a href="Cardano.Wallet.Primitive.Types.html#%24sel%3Acoin%3ATxOut"><span class="hs-identifier">coin</span></a></a><span>
</span><a name="line-354"></a><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><a href="Cardano.Wallet.Primitive.Types.html#Coin"><span class="hs-identifier hs-type">Coin</span></a><span>
</span><a name="line-355"></a><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">)</span><span>
</span><a name="line-356"></a><span>
</span><a name="line-357"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">NFData</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#TxOut"><span class="hs-identifier hs-type">TxOut</span></a><span>
</span><a name="line-358"></a><span>
</span><a name="line-359"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Buildable</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#TxOut"><span class="hs-identifier hs-type">TxOut</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-360"></a><span>    </span><a name="local-8214565720323798156"><span class="hs-identifier">build</span></a><span> </span><a name="local-6989586621679130180"><a href="#local-6989586621679130180"><span class="hs-identifier">txout</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mempty</span><span>
</span><a name="line-361"></a><span>        </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">build</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">coin</span><span> </span><a href="#local-6989586621679130180"><span class="hs-identifier hs-var">txout</span></a><span class="hs-special">)</span><span>
</span><a name="line-362"></a><span>        </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; @ &quot;</span><span>
</span><a name="line-363"></a><span>        </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">prefixF</span><span> </span><span class="hs-number">8</span><span> </span><a href="#local-6989586621679130181"><span class="hs-identifier hs-var">addrF</span></a><span>
</span><a name="line-364"></a><span>        </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;...&quot;</span><span>
</span><a name="line-365"></a><span>        </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">suffixF</span><span> </span><span class="hs-number">8</span><span> </span><a href="#local-6989586621679130181"><span class="hs-identifier hs-var">addrF</span></a><span>
</span><a name="line-366"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-367"></a><span>        </span><a name="local-6989586621679130181"><a href="#local-6989586621679130181"><span class="hs-identifier">addrF</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">build</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">address</span><span> </span><a href="#local-6989586621679130180"><span class="hs-identifier hs-var">txout</span></a><span>
</span><a name="line-368"></a><span>
</span><a name="line-369"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Buildable</span><span> </span><span class="hs-special">(</span><a href="Cardano.Wallet.Primitive.Types.html#TxIn"><span class="hs-identifier hs-type">TxIn</span></a><span class="hs-special">,</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#TxOut"><span class="hs-identifier hs-type">TxOut</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-370"></a><span>    </span><a name="local-8214565720323798156"><span class="hs-identifier">build</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679130178"><a href="#local-6989586621679130178"><span class="hs-identifier">txin</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679130179"><a href="#local-6989586621679130179"><span class="hs-identifier">txout</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">build</span><span> </span><a href="#local-6989586621679130178"><span class="hs-identifier hs-var">txin</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; ==&gt; &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">build</span><span> </span><a href="#local-6989586621679130179"><span class="hs-identifier hs-var">txout</span></a><span>
</span><a name="line-371"></a><span>
</span><a name="line-372"></a><span class="hs-keyword">data</span><span> </span><a name="TxMeta"><a href="Cardano.Wallet.Primitive.Types.html#TxMeta"><span class="hs-identifier">TxMeta</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="TxMeta"><a href="Cardano.Wallet.Primitive.Types.html#TxMeta"><span class="hs-identifier">TxMeta</span></a></a><span>
</span><a name="line-373"></a><span>    </span><span class="hs-special">{</span><span> </span><a name="%24sel%3Astatus%3ATxMeta"><a href="Cardano.Wallet.Primitive.Types.html#%24sel%3Astatus%3ATxMeta"><span class="hs-identifier">status</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><a href="Cardano.Wallet.Primitive.Types.html#TxStatus"><span class="hs-identifier hs-type">TxStatus</span></a><span>
</span><a name="line-374"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="%24sel%3Adirection%3ATxMeta"><a href="Cardano.Wallet.Primitive.Types.html#%24sel%3Adirection%3ATxMeta"><span class="hs-identifier">direction</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><a href="Cardano.Wallet.Primitive.Types.html#Direction"><span class="hs-identifier hs-type">Direction</span></a><span>
</span><a name="line-375"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="%24sel%3AslotId%3ATxMeta"><a href="Cardano.Wallet.Primitive.Types.html#%24sel%3AslotId%3ATxMeta"><span class="hs-identifier">slotId</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><a href="Cardano.Wallet.Primitive.Types.html#SlotId"><span class="hs-identifier hs-type">SlotId</span></a><span>
</span><a name="line-376"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="%24sel%3Aamount%3ATxMeta"><a href="Cardano.Wallet.Primitive.Types.html#%24sel%3Aamount%3ATxMeta"><span class="hs-identifier">amount</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><a href="Data.Quantity.html#Quantity"><span class="hs-identifier hs-type">Quantity</span></a><span> </span><span class="hs-string">&quot;lovelace&quot;</span><span> </span><span class="hs-identifier hs-type">Natural</span><span class="hs-special">)</span><span>
</span><a name="line-377"></a><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">)</span><span>
</span><a name="line-378"></a><span>
</span><a name="line-379"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">NFData</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#TxMeta"><span class="hs-identifier hs-type">TxMeta</span></a><span>
</span><a name="line-380"></a><span>
</span><a name="line-381"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Buildable</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#TxMeta"><span class="hs-identifier hs-type">TxMeta</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-382"></a><span>    </span><a name="local-8214565720323798156"><span class="hs-identifier">build</span></a><span> </span><span class="hs-special">(</span><a href="Cardano.Wallet.Primitive.Types.html#TxMeta"><span class="hs-identifier hs-var">TxMeta</span></a><span> </span><a name="local-6989586621679130095"><a href="#local-6989586621679130095"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679130096"><a href="#local-6989586621679130096"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-6989586621679130097"><a href="#local-6989586621679130097"><span class="hs-identifier">sl</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Quantity.html#Quantity"><span class="hs-identifier hs-var">Quantity</span></a><span> </span><a name="local-6989586621679130098"><a href="#local-6989586621679130098"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mempty</span><span>
</span><a name="line-383"></a><span>        </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679130096"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-keyword">of</span><span class="hs-special">;</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#Incoming"><span class="hs-identifier hs-var">Incoming</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;+&quot;</span><span class="hs-special">;</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#Outgoing"><span class="hs-identifier hs-var">Outgoing</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;-&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-384"></a><span>        </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">fixedF</span><span> </span><span class="hs-glyph">@</span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-number">6</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621679130098"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">/</span><span> </span><span class="hs-number">1e6</span><span class="hs-special">)</span><span>
</span><a name="line-385"></a><span>        </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">build</span><span> </span><a href="#local-6989586621679130095"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-386"></a><span>        </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; since &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">build</span><span> </span><a href="#local-6989586621679130097"><span class="hs-identifier hs-var">sl</span></a><span>
</span><a name="line-387"></a><span>
</span><a name="line-388"></a><span class="hs-keyword">data</span><span> </span><a name="TxStatus"><a href="Cardano.Wallet.Primitive.Types.html#TxStatus"><span class="hs-identifier">TxStatus</span></a></a><span>
</span><a name="line-389"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a name="Pending"><a href="Cardano.Wallet.Primitive.Types.html#Pending"><span class="hs-identifier">Pending</span></a></a><span>
</span><a name="line-390"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="InLedger"><a href="Cardano.Wallet.Primitive.Types.html#InLedger"><span class="hs-identifier">InLedger</span></a></a><span>
</span><a name="line-391"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="Invalidated"><a href="Cardano.Wallet.Primitive.Types.html#Invalidated"><span class="hs-identifier">Invalidated</span></a></a><span>
</span><a name="line-392"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">)</span><span>
</span><a name="line-393"></a><span>
</span><a name="line-394"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">NFData</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#TxStatus"><span class="hs-identifier hs-type">TxStatus</span></a><span>
</span><a name="line-395"></a><span>
</span><a name="line-396"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Buildable</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#TxStatus"><span class="hs-identifier hs-type">TxStatus</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-397"></a><span>    </span><a name="local-8214565720323798156"><span class="hs-identifier">build</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><a name="line-398"></a><span>        </span><a href="Cardano.Wallet.Primitive.Types.html#Pending"><span class="hs-identifier hs-var">Pending</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;pending&quot;</span><span>
</span><a name="line-399"></a><span>        </span><a href="Cardano.Wallet.Primitive.Types.html#InLedger"><span class="hs-identifier hs-var">InLedger</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;in ledger&quot;</span><span>
</span><a name="line-400"></a><span>        </span><a href="Cardano.Wallet.Primitive.Types.html#Invalidated"><span class="hs-identifier hs-var">Invalidated</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;invalidated&quot;</span><span>
</span><a name="line-401"></a><span>
</span><a name="line-402"></a><span class="hs-comment">-- | The flow of funds in to or out of a wallet.</span><span>
</span><a name="line-403"></a><span class="hs-keyword">data</span><span> </span><a name="Direction"><a href="Cardano.Wallet.Primitive.Types.html#Direction"><span class="hs-identifier">Direction</span></a></a><span>
</span><a name="line-404"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a name="Outgoing"><a href="Cardano.Wallet.Primitive.Types.html#Outgoing"><span class="hs-identifier">Outgoing</span></a></a><span> </span><span class="hs-comment">-- ^ Funds exit the wallet.</span><span>
</span><a name="line-405"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="Incoming"><a href="Cardano.Wallet.Primitive.Types.html#Incoming"><span class="hs-identifier">Incoming</span></a></a><span> </span><span class="hs-comment">-- ^ Funds enter the wallet.</span><span>
</span><a name="line-406"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">)</span><span>
</span><a name="line-407"></a><span>
</span><a name="line-408"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">NFData</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#Direction"><span class="hs-identifier hs-type">Direction</span></a><span>
</span><a name="line-409"></a><span>
</span><a name="line-410"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Buildable</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#Direction"><span class="hs-identifier hs-type">Direction</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-411"></a><span>    </span><a name="local-8214565720323798156"><span class="hs-identifier">build</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><a name="line-412"></a><span>        </span><a href="Cardano.Wallet.Primitive.Types.html#Outgoing"><span class="hs-identifier hs-var">Outgoing</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;outgoing&quot;</span><span>
</span><a name="line-413"></a><span>        </span><a href="Cardano.Wallet.Primitive.Types.html#Incoming"><span class="hs-identifier hs-var">Incoming</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;incoming&quot;</span><span>
</span><a name="line-414"></a><span>
</span><a name="line-415"></a><span class="hs-keyword">data</span><span> </span><a name="TxWitness"><a href="Cardano.Wallet.Primitive.Types.html#TxWitness"><span class="hs-identifier">TxWitness</span></a></a><span>
</span><a name="line-416"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a name="PublicKeyWitness"><a href="Cardano.Wallet.Primitive.Types.html#PublicKeyWitness"><span class="hs-identifier">PublicKeyWitness</span></a></a><span> </span><span class="hs-identifier hs-type">ByteString</span><span> </span><span class="hs-special">(</span><a href="Cardano.Wallet.Primitive.Types.html#Hash"><span class="hs-identifier hs-type">Hash</span></a><span> </span><span class="hs-string">&quot;signature&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-417"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="ScriptWitness"><a href="Cardano.Wallet.Primitive.Types.html#ScriptWitness"><span class="hs-identifier">ScriptWitness</span></a></a><span> </span><span class="hs-identifier hs-type">ByteString</span><span>
</span><a name="line-418"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="RedeemWitness"><a href="Cardano.Wallet.Primitive.Types.html#RedeemWitness"><span class="hs-identifier">RedeemWitness</span></a></a><span> </span><span class="hs-identifier hs-type">ByteString</span><span>
</span><a name="line-419"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-420"></a><span>
</span><a name="line-421"></a><span class="hs-comment">{-------------------------------------------------------------------------------
                                    Address
-------------------------------------------------------------------------------}</span><span>
</span><a name="line-424"></a><span>
</span><a name="line-425"></a><span class="hs-comment">-- | Representation of Cardano addresses. Addresses are basically a</span><span>
</span><a name="line-426"></a><span class="hs-comment">-- human-friendly representation of public keys. Historically in Cardano, there</span><span>
</span><a name="line-427"></a><span class="hs-comment">-- exists different sort of addresses, and new one are to come. So far, we can</span><span>
</span><a name="line-428"></a><span class="hs-comment">-- distinguish between three types of addresses:</span><span>
</span><a name="line-429"></a><span class="hs-comment">--</span><span>
</span><a name="line-430"></a><span class="hs-comment">-- - Byron Random addresses, which holds a payload with derivation path details</span><span>
</span><a name="line-431"></a><span class="hs-comment">-- - Byron Sequential addresses, also known as Icarus'style addresses</span><span>
</span><a name="line-432"></a><span class="hs-comment">-- - Shelley base addresses, see also [implementation-decisions/address](https://github.com/input-output-hk/implementation-decisions/blob/master/text/0001-address.md)</span><span>
</span><a name="line-433"></a><span class="hs-comment">--</span><span>
</span><a name="line-434"></a><span class="hs-comment">-- For more details, see [About Address Derivation](https://github.com/input-output-hk/cardano-wallet/wiki/About-Address-Derivation)</span><span>
</span><a name="line-435"></a><span class="hs-keyword">newtype</span><span> </span><a name="Address"><a href="Cardano.Wallet.Primitive.Types.html#Address"><span class="hs-identifier">Address</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Address"><a href="Cardano.Wallet.Primitive.Types.html#Address"><span class="hs-identifier">Address</span></a></a><span>
</span><a name="line-436"></a><span>    </span><span class="hs-special">{</span><span> </span><a name="%24sel%3AgetAddress%3AAddress"><a href="Cardano.Wallet.Primitive.Types.html#%24sel%3AgetAddress%3AAddress"><span class="hs-identifier">getAddress</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ByteString</span><span>
</span><a name="line-437"></a><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">)</span><span>
</span><a name="line-438"></a><span>
</span><a name="line-439"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">NFData</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#Address"><span class="hs-identifier hs-type">Address</span></a><span>
</span><a name="line-440"></a><span>
</span><a name="line-441"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Buildable</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#Address"><span class="hs-identifier hs-type">Address</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-442"></a><span>    </span><a name="local-8214565720323798156"><span class="hs-identifier">build</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">build</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">toText</span><span>
</span><a name="line-443"></a><span>
</span><a name="line-444"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">FromText</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#Address"><span class="hs-identifier hs-type">Address</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-445"></a><span>    </span><a name="local-8214565720323796131"><span class="hs-identifier">fromText</span></a><span> </span><a name="local-6989586621679130070"><a href="#local-6989586621679130070"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">maybe</span><span>
</span><a name="line-446"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">TextDecodingError</span><span> </span><a href="#local-6989586621679130071"><span class="hs-identifier hs-var">err</span></a><span class="hs-special">)</span><span>
</span><a name="line-447"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#Address"><span class="hs-identifier hs-var">Address</span></a><span class="hs-special">)</span><span>
</span><a name="line-448"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier hs-var">decodeBase58</span><span> </span><span class="hs-identifier hs-var">bitcoinAlphabet</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">T.encodeUtf8</span><span> </span><a href="#local-6989586621679130070"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-449"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-450"></a><span>        </span><a name="local-6989586621679130071"><a href="#local-6989586621679130071"><span class="hs-identifier">err</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Unable to decode Address: expected Base58 encoding&quot;</span><span>
</span><a name="line-451"></a><span>
</span><a name="line-452"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">ToText</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#Address"><span class="hs-identifier hs-type">Address</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-453"></a><span>    </span><a name="local-8214565720323796129"><span class="hs-identifier">toText</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">T.decodeUtf8</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">encodeBase58</span><span> </span><span class="hs-identifier hs-var">bitcoinAlphabet</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">getAddress</span><span>
</span><a name="line-454"></a><span>
</span><a name="line-455"></a><span class="hs-keyword">data</span><span> </span><a name="AddressState"><a href="Cardano.Wallet.Primitive.Types.html#AddressState"><span class="hs-identifier">AddressState</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Used"><a href="Cardano.Wallet.Primitive.Types.html#Used"><span class="hs-identifier">Used</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Unused"><a href="Cardano.Wallet.Primitive.Types.html#Unused"><span class="hs-identifier">Unused</span></a></a><span>
</span><a name="line-456"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-457"></a><span>
</span><a name="line-458"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">FromText</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#AddressState"><span class="hs-identifier hs-type">AddressState</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-459"></a><span>    </span><a name="local-8214565720323796131"><span class="hs-identifier">fromText</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><a name="line-460"></a><span>        </span><span class="hs-string">&quot;used&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-461"></a><span>            </span><span class="hs-identifier hs-var">Right</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#Used"><span class="hs-identifier hs-var">Used</span></a><span>
</span><a name="line-462"></a><span>        </span><span class="hs-string">&quot;unused&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-463"></a><span>            </span><span class="hs-identifier hs-var">Right</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#Unused"><span class="hs-identifier hs-var">Unused</span></a><span>
</span><a name="line-464"></a><span>        </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-465"></a><span>            </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">TextDecodingError</span><span> </span><span class="hs-string">&quot;Unable to decode address state: \
            \it's neither \&quot;used\&quot; nor \&quot;unused\&quot;&quot;</span><span>
</span><a name="line-467"></a><span>
</span><a name="line-468"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">ToText</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#AddressState"><span class="hs-identifier hs-type">AddressState</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-469"></a><span>    </span><a name="local-8214565720323796129"><span class="hs-identifier">toText</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679129731"><a href="#local-6989586621679129731"><span class="hs-identifier">h</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679129732"><a href="#local-6989586621679129732"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Char.toLower</span><span> </span><a href="#local-6989586621679129731"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679129732"><span class="hs-identifier hs-var">q</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">show</span><span>
</span><a name="line-470"></a><span>
</span><a name="line-471"></a><span class="hs-comment">{-------------------------------------------------------------------------------
                                     Coin
-------------------------------------------------------------------------------}</span><span>
</span><a name="line-474"></a><span>
</span><a name="line-475"></a><span class="hs-comment">-- | Coins are stored as Lovelace (reminder: 1 Lovelace = 1e6 ADA)</span><span>
</span><a name="line-476"></a><span class="hs-keyword">newtype</span><span> </span><a name="Coin"><a href="Cardano.Wallet.Primitive.Types.html#Coin"><span class="hs-identifier">Coin</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Coin"><a href="Cardano.Wallet.Primitive.Types.html#Coin"><span class="hs-identifier">Coin</span></a></a><span>
</span><a name="line-477"></a><span>    </span><span class="hs-special">{</span><span> </span><a name="%24sel%3AgetCoin%3ACoin"><a href="Cardano.Wallet.Primitive.Types.html#%24sel%3AgetCoin%3ACoin"><span class="hs-identifier">getCoin</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Word64</span><span>
</span><a name="line-478"></a><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">stock</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">)</span><span>
</span><a name="line-479"></a><span>
</span><a name="line-480"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">NFData</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#Coin"><span class="hs-identifier hs-type">Coin</span></a><span>
</span><a name="line-481"></a><span>
</span><a name="line-482"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Bounded</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#Coin"><span class="hs-identifier hs-type">Coin</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-483"></a><span>    </span><a name="local-8214565720323790309"><span class="hs-identifier">minBound</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#Coin"><span class="hs-identifier hs-var">Coin</span></a><span> </span><span class="hs-number">0</span><span>
</span><a name="line-484"></a><span>    </span><a name="local-8214565720323790308"><span class="hs-identifier">maxBound</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#Coin"><span class="hs-identifier hs-var">Coin</span></a><span> </span><span class="hs-number">45000000000000000</span><span>
</span><a name="line-485"></a><span>
</span><a name="line-486"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Buildable</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#Coin"><span class="hs-identifier hs-type">Coin</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-487"></a><span>    </span><a name="local-8214565720323798156"><span class="hs-identifier">build</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">build</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">getCoin</span><span>
</span><a name="line-488"></a><span>
</span><a name="line-489"></a><span class="hs-identifier">isValidCoin</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#Coin"><span class="hs-identifier hs-type">Coin</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-490"></a><a name="isValidCoin"><a href="Cardano.Wallet.Primitive.Types.html#isValidCoin"><span class="hs-identifier">isValidCoin</span></a></a><span> </span><a name="local-6989586621679130201"><a href="#local-6989586621679130201"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679130201"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-identifier hs-var">minBound</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679130201"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-identifier hs-var">maxBound</span><span>
</span><a name="line-491"></a><span>
</span><a name="line-492"></a><span>
</span><a name="line-493"></a><span class="hs-comment">{-------------------------------------------------------------------------------
                                    UTxO
-------------------------------------------------------------------------------}</span><span>
</span><a name="line-496"></a><span>
</span><a name="line-497"></a><span class="hs-keyword">newtype</span><span> </span><a name="UTxO"><a href="Cardano.Wallet.Primitive.Types.html#UTxO"><span class="hs-identifier">UTxO</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="UTxO"><a href="Cardano.Wallet.Primitive.Types.html#UTxO"><span class="hs-identifier">UTxO</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="%24sel%3AgetUTxO%3AUTxO"><a href="Cardano.Wallet.Primitive.Types.html#%24sel%3AgetUTxO%3AUTxO"><span class="hs-identifier">getUTxO</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Map</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#TxIn"><span class="hs-identifier hs-type">TxIn</span></a><span> </span><a href="Cardano.Wallet.Primitive.Types.html#TxOut"><span class="hs-identifier hs-type">TxOut</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-498"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">stock</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">)</span><span>
</span><a name="line-499"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">newtype</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Semigroup</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Monoid</span><span class="hs-special">)</span><span>
</span><a name="line-500"></a><span>
</span><a name="line-501"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">NFData</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#UTxO"><span class="hs-identifier hs-type">UTxO</span></a><span>
</span><a name="line-502"></a><span>
</span><a name="line-503"></a><span class="hs-keyword">instance</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#Dom"><span class="hs-identifier hs-type">Dom</span></a><span> </span><a href="Cardano.Wallet.Primitive.Types.html#UTxO"><span class="hs-identifier hs-type">UTxO</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-504"></a><span>    </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">DomElem</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#UTxO"><span class="hs-identifier hs-type">UTxO</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#TxIn"><span class="hs-identifier hs-type">TxIn</span></a><span>
</span><a name="line-505"></a><span>    </span><a name="local-8214565720323904521"><a href="Cardano.Wallet.Primitive.Types.html#dom"><span class="hs-identifier">dom</span></a></a><span> </span><span class="hs-special">(</span><a href="Cardano.Wallet.Primitive.Types.html#UTxO"><span class="hs-identifier hs-var">UTxO</span></a><span> </span><a name="local-6989586621679129730"><a href="#local-6989586621679129730"><span class="hs-identifier">utxo</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Map.keysSet</span><span> </span><a href="#local-6989586621679129730"><span class="hs-identifier hs-var">utxo</span></a><span>
</span><a name="line-506"></a><span>
</span><a name="line-507"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Buildable</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#UTxO"><span class="hs-identifier hs-type">UTxO</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-508"></a><span>    </span><a name="local-8214565720323798156"><span class="hs-identifier">build</span></a><span> </span><span class="hs-special">(</span><a href="Cardano.Wallet.Primitive.Types.html#UTxO"><span class="hs-identifier hs-var">UTxO</span></a><span> </span><a name="local-6989586621679129726"><a href="#local-6989586621679129726"><span class="hs-identifier">utxo</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-509"></a><span>        </span><span class="hs-identifier hs-var">blockListF'</span><span> </span><span class="hs-string">&quot;-&quot;</span><span> </span><a href="#local-6989586621679129727"><span class="hs-identifier hs-var">utxoF</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Map.toList</span><span> </span><a href="#local-6989586621679129726"><span class="hs-identifier hs-var">utxo</span></a><span class="hs-special">)</span><span>
</span><a name="line-510"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-511"></a><span>        </span><a name="local-6989586621679129727"><a href="#local-6989586621679129727"><span class="hs-identifier">utxoF</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679129728"><a href="#local-6989586621679129728"><span class="hs-identifier">inp</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679129729"><a href="#local-6989586621679129729"><span class="hs-identifier">out</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">build</span><span> </span><a href="#local-6989586621679129728"><span class="hs-identifier hs-var">inp</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; =&gt; &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">build</span><span> </span><a href="#local-6989586621679129729"><span class="hs-identifier hs-var">out</span></a><span>
</span><a name="line-512"></a><span>
</span><a name="line-513"></a><span class="hs-comment">-- | Pick a random element from a UTxO, returns 'Nothing' if the UTxO is empty.</span><span>
</span><a name="line-514"></a><span class="hs-comment">-- Otherwise, returns the selected entry and, the UTxO minus the selected one.</span><span>
</span><a name="line-515"></a><span class="hs-identifier">pickRandom</span><span>
</span><a name="line-516"></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">MonadRandom</span><span> </span><a href="#local-6989586621679130200"><span class="hs-identifier hs-type">m</span></a><span>
</span><a name="line-517"></a><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#UTxO"><span class="hs-identifier hs-type">UTxO</span></a><span>
</span><a name="line-518"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679130200"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="Cardano.Wallet.Primitive.Types.html#TxIn"><span class="hs-identifier hs-type">TxIn</span></a><span class="hs-special">,</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#TxOut"><span class="hs-identifier hs-type">TxOut</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#UTxO"><span class="hs-identifier hs-type">UTxO</span></a><span class="hs-special">)</span><span>
</span><a name="line-519"></a><a name="pickRandom"><a href="Cardano.Wallet.Primitive.Types.html#pickRandom"><span class="hs-identifier">pickRandom</span></a></a><span> </span><span class="hs-special">(</span><a href="Cardano.Wallet.Primitive.Types.html#UTxO"><span class="hs-identifier hs-var">UTxO</span></a><span> </span><a name="local-6989586621679130202"><a href="#local-6989586621679130202"><span class="hs-identifier">utxo</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-520"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Map.null</span><span> </span><a href="#local-6989586621679130202"><span class="hs-identifier hs-var">utxo</span></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-521"></a><span>        </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">,</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#UTxO"><span class="hs-identifier hs-var">UTxO</span></a><span> </span><a href="#local-6989586621679130202"><span class="hs-identifier hs-var">utxo</span></a><span class="hs-special">)</span><span>
</span><a name="line-522"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-523"></a><span>        </span><a name="local-6989586621679130203"><a href="#local-6989586621679130203"><span class="hs-identifier">ix</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">fromEnum</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">generateBetween</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">toEnum</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Map.size</span><span> </span><a href="#local-6989586621679130202"><span class="hs-identifier hs-var">utxo</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-524"></a><span>        </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Map.elemAt</span><span> </span><a href="#local-6989586621679130203"><span class="hs-identifier hs-var">ix</span></a><span> </span><a href="#local-6989586621679130202"><span class="hs-identifier hs-var">utxo</span></a><span class="hs-special">,</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#UTxO"><span class="hs-identifier hs-var">UTxO</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Map.deleteAt</span><span> </span><a href="#local-6989586621679130203"><span class="hs-identifier hs-var">ix</span></a><span> </span><a href="#local-6989586621679130202"><span class="hs-identifier hs-var">utxo</span></a><span class="hs-special">)</span><span>
</span><a name="line-525"></a><span>
</span><a name="line-526"></a><span class="hs-comment">-- | Compute the balance of a UTxO</span><span>
</span><a name="line-527"></a><span class="hs-identifier">balance</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#UTxO"><span class="hs-identifier hs-type">UTxO</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Natural</span><span>
</span><a name="line-528"></a><a name="balance"><a href="Cardano.Wallet.Primitive.Types.html#balance"><span class="hs-identifier">balance</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-529"></a><span>    </span><span class="hs-identifier hs-var">Map.foldl'</span><span> </span><a href="#local-6989586621679130204"><span class="hs-identifier hs-var">fn</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">getUTxO</span><span>
</span><a name="line-530"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-531"></a><span>    </span><span class="hs-identifier">fn</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Natural</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#TxOut"><span class="hs-identifier hs-type">TxOut</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Natural</span><span>
</span><a name="line-532"></a><span>    </span><a name="local-6989586621679130204"><a href="#local-6989586621679130204"><span class="hs-identifier">fn</span></a></a><span> </span><a name="local-6989586621679130205"><a href="#local-6989586621679130205"><span class="hs-identifier">tot</span></a></a><span> </span><a name="local-6989586621679130206"><a href="#local-6989586621679130206"><span class="hs-identifier">out</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679130205"><span class="hs-identifier hs-var">tot</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">getCoin</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">coin</span><span> </span><a href="#local-6989586621679130206"><span class="hs-identifier hs-var">out</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-533"></a><span>
</span><a name="line-534"></a><span class="hs-comment">-- | Compute the balance of a unwrapped UTxO</span><span>
</span><a name="line-535"></a><span class="hs-identifier">balance'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Cardano.Wallet.Primitive.Types.html#TxIn"><span class="hs-identifier hs-type">TxIn</span></a><span class="hs-special">,</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#TxOut"><span class="hs-identifier hs-type">TxOut</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Word64</span><span>
</span><a name="line-536"></a><a name="balance%27"><a href="Cardano.Wallet.Primitive.Types.html#balance%27"><span class="hs-identifier">balance'</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-537"></a><span>    </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#balance"><span class="hs-identifier hs-var">balance</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#UTxO"><span class="hs-identifier hs-var">UTxO</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">Map.fromList</span><span>
</span><a name="line-538"></a><span>
</span><a name="line-539"></a><span class="hs-comment">-- | ins&#8938; u</span><span>
</span><a name="line-540"></a><span class="hs-identifier">excluding</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#UTxO"><span class="hs-identifier hs-type">UTxO</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Set</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#TxIn"><span class="hs-identifier hs-type">TxIn</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><a href="Cardano.Wallet.Primitive.Types.html#UTxO"><span class="hs-identifier hs-type">UTxO</span></a><span>
</span><a name="line-541"></a><a name="excluding"><a href="Cardano.Wallet.Primitive.Types.html#excluding"><span class="hs-identifier">excluding</span></a></a><span> </span><span class="hs-special">(</span><a href="Cardano.Wallet.Primitive.Types.html#UTxO"><span class="hs-identifier hs-var">UTxO</span></a><span> </span><a name="local-6989586621679130314"><a href="#local-6989586621679130314"><span class="hs-identifier">utxo</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-542"></a><span>    </span><a href="Cardano.Wallet.Primitive.Types.html#UTxO"><span class="hs-identifier hs-var">UTxO</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">Map.withoutKeys</span><span> </span><a href="#local-6989586621679130314"><span class="hs-identifier hs-var">utxo</span></a><span>
</span><a name="line-543"></a><span>
</span><a name="line-544"></a><span class="hs-comment">-- | a &#8838; b</span><span>
</span><a name="line-545"></a><span class="hs-identifier">isSubsetOf</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#UTxO"><span class="hs-identifier hs-type">UTxO</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#UTxO"><span class="hs-identifier hs-type">UTxO</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-546"></a><a name="isSubsetOf"><a href="Cardano.Wallet.Primitive.Types.html#isSubsetOf"><span class="hs-identifier">isSubsetOf</span></a></a><span> </span><span class="hs-special">(</span><a href="Cardano.Wallet.Primitive.Types.html#UTxO"><span class="hs-identifier hs-var">UTxO</span></a><span> </span><a name="local-6989586621679130315"><a href="#local-6989586621679130315"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Cardano.Wallet.Primitive.Types.html#UTxO"><span class="hs-identifier hs-var">UTxO</span></a><span> </span><a name="local-6989586621679130316"><a href="#local-6989586621679130316"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-547"></a><span>    </span><a href="#local-6989586621679130315"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">Map.isSubmapOf</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679130316"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-548"></a><span>
</span><a name="line-549"></a><span class="hs-comment">-- | ins&#8882; u</span><span>
</span><a name="line-550"></a><span class="hs-identifier">restrictedBy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#UTxO"><span class="hs-identifier hs-type">UTxO</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Set</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#TxIn"><span class="hs-identifier hs-type">TxIn</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#UTxO"><span class="hs-identifier hs-type">UTxO</span></a><span>
</span><a name="line-551"></a><a name="restrictedBy"><a href="Cardano.Wallet.Primitive.Types.html#restrictedBy"><span class="hs-identifier">restrictedBy</span></a></a><span> </span><span class="hs-special">(</span><a href="Cardano.Wallet.Primitive.Types.html#UTxO"><span class="hs-identifier hs-var">UTxO</span></a><span> </span><a name="local-6989586621679130317"><a href="#local-6989586621679130317"><span class="hs-identifier">utxo</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-552"></a><span>    </span><a href="Cardano.Wallet.Primitive.Types.html#UTxO"><span class="hs-identifier hs-var">UTxO</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">Map.restrictKeys</span><span> </span><a href="#local-6989586621679130317"><span class="hs-identifier hs-var">utxo</span></a><span>
</span><a name="line-553"></a><span>
</span><a name="line-554"></a><span class="hs-comment">-- | u &#8883; outs</span><span>
</span><a name="line-555"></a><span class="hs-identifier">restrictedTo</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#UTxO"><span class="hs-identifier hs-type">UTxO</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Set</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#TxOut"><span class="hs-identifier hs-type">TxOut</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#UTxO"><span class="hs-identifier hs-type">UTxO</span></a><span>
</span><a name="line-556"></a><a name="restrictedTo"><a href="Cardano.Wallet.Primitive.Types.html#restrictedTo"><span class="hs-identifier">restrictedTo</span></a></a><span> </span><span class="hs-special">(</span><a href="Cardano.Wallet.Primitive.Types.html#UTxO"><span class="hs-identifier hs-var">UTxO</span></a><span> </span><a name="local-6989586621679130318"><a href="#local-6989586621679130318"><span class="hs-identifier">utxo</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679130319"><a href="#local-6989586621679130319"><span class="hs-identifier">outs</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-557"></a><span>    </span><a href="Cardano.Wallet.Primitive.Types.html#UTxO"><span class="hs-identifier hs-var">UTxO</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Map.filter</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier hs-var">Set.member</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679130319"><span class="hs-identifier hs-var">outs</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679130318"><span class="hs-identifier hs-var">utxo</span></a><span>
</span><a name="line-558"></a><span>
</span><a name="line-559"></a><span>
</span><a name="line-560"></a><span class="hs-comment">{-------------------------------------------------------------------------------
                                   Slotting

  Note that we do not define any operation to perform slotting arithmetic of any
  kind. Instead of manipulating slots, we do simply look them up from the chain,
  in their corresponding block. This should be probably enough to cover for
  pretty much all our needs.

  If slotting arithmetic has to be introduced, it will require proper thoughts.
-------------------------------------------------------------------------------}</span><span>
</span><a name="line-570"></a><span>
</span><a name="line-571"></a><span class="hs-comment">-- | A slot identifier is the combination of an epoch and slot.</span><span>
</span><a name="line-572"></a><span class="hs-keyword">data</span><span> </span><a name="SlotId"><a href="Cardano.Wallet.Primitive.Types.html#SlotId"><span class="hs-identifier">SlotId</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="SlotId"><a href="Cardano.Wallet.Primitive.Types.html#SlotId"><span class="hs-identifier">SlotId</span></a></a><span>
</span><a name="line-573"></a><span>  </span><span class="hs-special">{</span><span> </span><a name="%24sel%3AepochNumber%3ASlotId"><a href="Cardano.Wallet.Primitive.Types.html#%24sel%3AepochNumber%3ASlotId"><span class="hs-identifier">epochNumber</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier hs-type">Word64</span><span>
</span><a name="line-574"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="%24sel%3AslotNumber%3ASlotId"><a href="Cardano.Wallet.Primitive.Types.html#%24sel%3AslotNumber%3ASlotId"><span class="hs-identifier">slotNumber</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier hs-type">Word16</span><span>
</span><a name="line-575"></a><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">stock</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">)</span><span>
</span><a name="line-576"></a><span>
</span><a name="line-577"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">NFData</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#SlotId"><span class="hs-identifier hs-type">SlotId</span></a><span>
</span><a name="line-578"></a><span>
</span><a name="line-579"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Buildable</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#SlotId"><span class="hs-identifier hs-type">SlotId</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-580"></a><span>    </span><a name="local-8214565720323798156"><span class="hs-identifier">build</span></a><span> </span><span class="hs-special">(</span><a href="Cardano.Wallet.Primitive.Types.html#SlotId"><span class="hs-identifier hs-var">SlotId</span></a><span> </span><a name="local-6989586621679129724"><a href="#local-6989586621679129724"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679129725"><a href="#local-6989586621679129725"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromString</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679129724"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;.&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">fromString</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679129725"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-581"></a><span>
</span><a name="line-582"></a><span class="hs-comment">-- | Compute the approximate ratio / progress between two slots. This is an</span><span>
</span><a name="line-583"></a><span class="hs-comment">-- approximation for a few reasons, one of them being that we hard code the</span><span>
</span><a name="line-584"></a><span class="hs-comment">-- epoch length as a static number whereas it may vary in practice.</span><span>
</span><a name="line-585"></a><span class="hs-identifier">slotRatio</span><span>
</span><a name="line-586"></a><span>    </span><span class="hs-glyph">::</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#SlotId"><span class="hs-identifier hs-type">SlotId</span></a><span>
</span><a name="line-587"></a><span>        </span><span class="hs-comment">-- ^ Numerator</span><span>
</span><a name="line-588"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#SlotId"><span class="hs-identifier hs-type">SlotId</span></a><span>
</span><a name="line-589"></a><span>        </span><span class="hs-comment">-- ^ Denominator</span><span>
</span><a name="line-590"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Quantity.html#Quantity"><span class="hs-identifier hs-type">Quantity</span></a><span> </span><span class="hs-string">&quot;percent&quot;</span><span> </span><a href="Data.Quantity.html#Percentage"><span class="hs-identifier hs-type">Percentage</span></a><span>
</span><a name="line-591"></a><a name="slotRatio"><a href="Cardano.Wallet.Primitive.Types.html#slotRatio"><span class="hs-identifier">slotRatio</span></a></a><span> </span><span class="hs-special">(</span><a href="Cardano.Wallet.Primitive.Types.html#SlotId"><span class="hs-identifier hs-var">SlotId</span></a><span> </span><a name="local-6989586621679130320"><a href="#local-6989586621679130320"><span class="hs-identifier">ep0</span></a></a><span> </span><a name="local-6989586621679130321"><a href="#local-6989586621679130321"><span class="hs-identifier">sl0</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Cardano.Wallet.Primitive.Types.html#SlotId"><span class="hs-identifier hs-var">SlotId</span></a><span> </span><a name="local-6989586621679130322"><a href="#local-6989586621679130322"><span class="hs-identifier">ep1</span></a></a><span> </span><a name="local-6989586621679130323"><a href="#local-6989586621679130323"><span class="hs-identifier">sl1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-592"></a><span>    </span><span class="hs-keyword">let</span><span>
</span><a name="line-593"></a><span>        </span><a name="local-6989586621679130327"><a href="#local-6989586621679130327"><span class="hs-identifier">n0</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679130324"><span class="hs-identifier hs-var">flat</span></a><span> </span><a href="#local-6989586621679130320"><span class="hs-identifier hs-var">ep0</span></a><span> </span><a href="#local-6989586621679130321"><span class="hs-identifier hs-var">sl0</span></a><span>
</span><a name="line-594"></a><span>        </span><a name="local-6989586621679130328"><a href="#local-6989586621679130328"><span class="hs-identifier">n1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679130324"><span class="hs-identifier hs-var">flat</span></a><span> </span><a href="#local-6989586621679130322"><span class="hs-identifier hs-var">ep1</span></a><span> </span><a href="#local-6989586621679130323"><span class="hs-identifier hs-var">sl1</span></a><span>
</span><a name="line-595"></a><span>        </span><a name="local-6989586621679130329"><a href="#local-6989586621679130329"><span class="hs-identifier">tolerance</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">5</span><span>
</span><a name="line-596"></a><span>    </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#distance"><span class="hs-identifier hs-var">distance</span></a><span> </span><a href="#local-6989586621679130327"><span class="hs-identifier hs-var">n0</span></a><span> </span><a href="#local-6989586621679130328"><span class="hs-identifier hs-var">n1</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><a href="#local-6989586621679130329"><span class="hs-identifier hs-var">tolerance</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679130327"><span class="hs-identifier hs-var">n0</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><a href="#local-6989586621679130328"><span class="hs-identifier hs-var">n1</span></a><span> </span><span class="hs-keyword">then</span><span>
</span><a name="line-597"></a><span>        </span><span class="hs-identifier hs-var">maxBound</span><span>
</span><a name="line-598"></a><span>    </span><span class="hs-keyword">else</span><span>
</span><a name="line-599"></a><span>        </span><a href="Data.Quantity.html#Quantity"><span class="hs-identifier hs-var">Quantity</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">toEnum</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><span class="hs-number">100</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679130327"><span class="hs-identifier hs-var">n0</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">div</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679130328"><span class="hs-identifier hs-var">n1</span></a><span>
</span><a name="line-600"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-601"></a><span>    </span><a name="local-6989586621679130324"><a href="#local-6989586621679130324"><span class="hs-identifier">flat</span></a></a><span> </span><a name="local-6989586621679130325"><a href="#local-6989586621679130325"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679130326"><a href="#local-6989586621679130326"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">21600</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679130325"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621679130326"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-602"></a><span>
</span><a name="line-603"></a><span class="hs-comment">{-------------------------------------------------------------------------------
                               Polymorphic Types
-------------------------------------------------------------------------------}</span><span>
</span><a name="line-606"></a><span>
</span><a name="line-607"></a><span class="hs-keyword">class</span><span> </span><a name="Dom"><a href="Cardano.Wallet.Primitive.Types.html#Dom"><span class="hs-identifier">Dom</span></a></a><span> </span><a name="local-6989586621679129710"><a href="#local-6989586621679129710"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-608"></a><span>    </span><span class="hs-keyword">type</span><span> </span><a name="DomElem"><a href="Cardano.Wallet.Primitive.Types.html#DomElem"><span class="hs-identifier">DomElem</span></a></a><span> </span><a name="local-6989586621679129710"><a href="#local-6989586621679129710"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-operator">*</span><span>
</span><a name="line-609"></a><span>    </span><a name="dom"><a href="Cardano.Wallet.Primitive.Types.html#dom"><span class="hs-identifier">dom</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679129710"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Set</span><span> </span><span class="hs-special">(</span><a href="Cardano.Wallet.Primitive.Types.html#DomElem"><span class="hs-identifier hs-type">DomElem</span></a><span> </span><a href="#local-6989586621679129710"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-610"></a><span>
</span><a name="line-611"></a><span class="hs-keyword">newtype</span><span> </span><a name="Hash"><a href="Cardano.Wallet.Primitive.Types.html#Hash"><span class="hs-identifier">Hash</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679129709"><a href="#local-6989586621679129709"><span class="hs-identifier">tag</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Symbol</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="Hash"><a href="Cardano.Wallet.Primitive.Types.html#Hash"><span class="hs-identifier">Hash</span></a></a><span>
</span><a name="line-612"></a><span>    </span><span class="hs-special">{</span><span> </span><a name="%24sel%3AgetHash%3AHash"><a href="Cardano.Wallet.Primitive.Types.html#%24sel%3AgetHash%3AHash"><span class="hs-identifier">getHash</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ByteString</span><span>
</span><a name="line-613"></a><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">)</span><span>
</span><a name="line-614"></a><span>
</span><a name="line-615"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">NFData</span><span> </span><span class="hs-special">(</span><a href="Cardano.Wallet.Primitive.Types.html#Hash"><span class="hs-identifier hs-type">Hash</span></a><span> </span><a href="#local-6989586621679129723"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">)</span><span>
</span><a name="line-616"></a><span>
</span><a name="line-617"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Buildable</span><span> </span><span class="hs-special">(</span><a href="Cardano.Wallet.Primitive.Types.html#Hash"><span class="hs-identifier hs-type">Hash</span></a><span> </span><span class="hs-string">&quot;Tx&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-618"></a><span>    </span><a name="local-8214565720323798156"><span class="hs-identifier">build</span></a><span> </span><a name="local-6989586621679129721"><a href="#local-6989586621679129721"><span class="hs-identifier">h</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mempty</span><span>
</span><a name="line-619"></a><span>        </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">prefixF</span><span> </span><span class="hs-number">8</span><span> </span><a href="#local-6989586621679129722"><span class="hs-identifier hs-var">builder</span></a><span>
</span><a name="line-620"></a><span>        </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;...&quot;</span><span>
</span><a name="line-621"></a><span>        </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">suffixF</span><span> </span><span class="hs-number">8</span><span> </span><a href="#local-6989586621679129722"><span class="hs-identifier hs-var">builder</span></a><span>
</span><a name="line-622"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-623"></a><span>        </span><a name="local-6989586621679129722"><a href="#local-6989586621679129722"><span class="hs-identifier">builder</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">build</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">toText</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679129721"><span class="hs-identifier hs-var">h</span></a><span>
</span><a name="line-624"></a><span>
</span><a name="line-625"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">FromText</span><span> </span><span class="hs-special">(</span><a href="Cardano.Wallet.Primitive.Types.html#Hash"><span class="hs-identifier hs-type">Hash</span></a><span> </span><span class="hs-string">&quot;Tx&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-626"></a><span>    </span><a name="local-8214565720323796131"><span class="hs-identifier">fromText</span></a><span> </span><a name="local-6989586621679129719"><a href="#local-6989586621679129719"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">either</span><span>
</span><a name="line-627"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier hs-var">const</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">TextDecodingError</span><span> </span><a href="#local-6989586621679129720"><span class="hs-identifier hs-var">err</span></a><span class="hs-special">)</span><span>
</span><a name="line-628"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Cardano.Wallet.Primitive.Types.html#Hash"><span class="hs-identifier hs-var">Hash</span></a><span class="hs-special">)</span><span>
</span><a name="line-629"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier hs-var">convertFromBase</span><span> </span><span class="hs-identifier hs-var">Base16</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">T.encodeUtf8</span><span> </span><a href="#local-6989586621679129719"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-630"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-631"></a><span>        </span><a name="local-6989586621679129720"><a href="#local-6989586621679129720"><span class="hs-identifier">err</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Unable to decode (Hash \&quot;Tx\&quot;): \
                    \expected Base16 encoding&quot;</span><span>
</span><a name="line-633"></a><span>
</span><a name="line-634"></a><span>
</span><a name="line-635"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">ToText</span><span> </span><span class="hs-special">(</span><a href="Cardano.Wallet.Primitive.Types.html#Hash"><span class="hs-identifier hs-type">Hash</span></a><span> </span><span class="hs-string">&quot;Tx&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-636"></a><span>    </span><a name="local-8214565720323796129"><span class="hs-identifier">toText</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">T.decodeUtf8</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">convertToBase</span><span> </span><span class="hs-identifier hs-var">Base16</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">getHash</span><span>
</span><a name="line-637"></a><span>
</span><a name="line-638"></a><span class="hs-comment">-- | A polymorphic wrapper type with a custom show instance to display data</span><span>
</span><a name="line-639"></a><span class="hs-comment">-- through 'Buildable' instances.</span><span>
</span><a name="line-640"></a><span class="hs-keyword">newtype</span><span> </span><a name="ShowFmt"><a href="Cardano.Wallet.Primitive.Types.html#ShowFmt"><span class="hs-identifier">ShowFmt</span></a></a><span> </span><a name="local-6989586621679129708"><a href="#local-6989586621679129708"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="ShowFmt"><a href="Cardano.Wallet.Primitive.Types.html#ShowFmt"><span class="hs-identifier">ShowFmt</span></a></a><span> </span><a href="#local-6989586621679129708"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-641"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">)</span><span>
</span><a name="line-642"></a><span>
</span><a name="line-643"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">NFData</span><span> </span><a href="#local-6989586621679129718"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">NFData</span><span> </span><span class="hs-special">(</span><a href="Cardano.Wallet.Primitive.Types.html#ShowFmt"><span class="hs-identifier hs-type">ShowFmt</span></a><span> </span><a href="#local-6989586621679129718"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-644"></a><span>
</span><a name="line-645"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Buildable</span><span> </span><a href="#local-6989586621679129716"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><span class="hs-special">(</span><a href="Cardano.Wallet.Primitive.Types.html#ShowFmt"><span class="hs-identifier hs-type">ShowFmt</span></a><span> </span><a href="#local-6989586621679129716"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-646"></a><span>    </span><a name="local-8214565720323790323"><span class="hs-identifier">show</span></a><span> </span><span class="hs-special">(</span><a href="Cardano.Wallet.Primitive.Types.html#ShowFmt"><span class="hs-identifier hs-var">ShowFmt</span></a><span> </span><a name="local-6989586621679129717"><a href="#local-6989586621679129717"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">build</span><span> </span><a href="#local-6989586621679129717"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-647"></a><span>
</span><a name="line-648"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-pragma">{-# OVERLAPS</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Buildable</span><span> </span><a href="#local-6989586621679129713"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Foldable</span><span> </span><a href="#local-6989586621679129714"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><span class="hs-special">(</span><a href="Cardano.Wallet.Primitive.Types.html#ShowFmt"><span class="hs-identifier hs-type">ShowFmt</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679129714"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-6989586621679129713"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-649"></a><span>    </span><a name="local-8214565720323790323"><span class="hs-identifier">show</span></a><span> </span><span class="hs-special">(</span><a href="Cardano.Wallet.Primitive.Types.html#ShowFmt"><span class="hs-identifier hs-var">ShowFmt</span></a><span> </span><a name="local-6989586621679129715"><a href="#local-6989586621679129715"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">blockListF</span><span> </span><a href="#local-6989586621679129715"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-650"></a><span>
</span><a name="line-651"></a><span class="hs-comment">-- | Check whether an invariants holds or not.</span><span>
</span><a name="line-652"></a><span class="hs-comment">--</span><span>
</span><a name="line-653"></a><span class="hs-comment">-- &gt;&gt;&gt; invariant &quot;not empty&quot; [1,2,3] (not . null)</span><span>
</span><a name="line-654"></a><span class="hs-comment">-- [1, 2, 3]</span><span>
</span><a name="line-655"></a><span class="hs-comment">--</span><span>
</span><a name="line-656"></a><span class="hs-comment">-- &gt;&gt;&gt; invariant &quot;not empty&quot; [] (not . null)</span><span>
</span><a name="line-657"></a><span class="hs-comment">-- *** Exception: not empty</span><span>
</span><a name="line-658"></a><span class="hs-identifier">invariant</span><span>
</span><a name="line-659"></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-comment">-- ^ A title / message to throw in case of violation</span><span>
</span><a name="line-660"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679130199"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-661"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679130199"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span>
</span><a name="line-662"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679130199"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-663"></a><a name="invariant"><a href="Cardano.Wallet.Primitive.Types.html#invariant"><span class="hs-identifier">invariant</span></a></a><span> </span><a name="local-6989586621679130330"><a href="#local-6989586621679130330"><span class="hs-identifier">msg</span></a></a><span> </span><a name="local-6989586621679130331"><a href="#local-6989586621679130331"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679130332"><a href="#local-6989586621679130332"><span class="hs-identifier">predicate</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-664"></a><span>    </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679130332"><span class="hs-identifier hs-var">predicate</span></a><span> </span><a href="#local-6989586621679130331"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679130331"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><a href="#local-6989586621679130330"><span class="hs-identifier hs-var">msg</span></a><span>
</span><a name="line-665"></a><span>
</span><a name="line-666"></a><span class="hs-comment">-- | Compute distance between two numeric values |a - b|</span><span>
</span><a name="line-667"></a><span class="hs-identifier">distance</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679130198"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679130198"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679130198"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679130198"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679130198"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-668"></a><a name="distance"><a href="Cardano.Wallet.Primitive.Types.html#distance"><span class="hs-identifier">distance</span></a></a><span> </span><a name="local-6989586621679130333"><a href="#local-6989586621679130333"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679130334"><a href="#local-6989586621679130334"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-669"></a><span>    </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679130333"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><a href="#local-6989586621679130334"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679130334"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679130333"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679130333"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679130334"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-670"></a></pre></body></html>